<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <title>Attribution Reporting</title>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <link href="https://www.w3.org/StyleSheets/TR/2021/cg-draft" rel="stylesheet">
  <meta content="Bikeshed version 44af0bf3e, updated Fri Jul 29 17:05:16 2022 -0700" name="generator">
  <link href="https://wicg.github.io/attribution-reporting-api" rel="canonical">
<style>/* style-autolinks */

.css.css, .property.property, .descriptor.descriptor {
    color: var(--a-normal-text);
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}</style>
<style>/* style-colors */

/* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
:root {
    color-scheme: light dark;

    --text: black;
    --bg: white;

    --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

    --logo-bg: #1a5e9a;
    --logo-active-bg: #c00;
    --logo-text: white;

    --tocnav-normal-text: #707070;
    --tocnav-normal-bg: var(--bg);
    --tocnav-hover-text: var(--tocnav-normal-text);
    --tocnav-hover-bg: #f8f8f8;
    --tocnav-active-text: #c00;
    --tocnav-active-bg: var(--tocnav-normal-bg);

    --tocsidebar-text: var(--text);
    --tocsidebar-bg: #f7f8f9;
    --tocsidebar-shadow: rgba(0,0,0,.1);
    --tocsidebar-heading-text: hsla(203,20%,40%,.7);

    --toclink-text: var(--text);
    --toclink-underline: #3980b5;
    --toclink-visited-text: var(--toclink-text);
    --toclink-visited-underline: #054572;

    --heading-text: #005a9c;

    --hr-text: var(--text);

    --algo-border: #def;

    --del-text: red;
    --del-bg: transparent;
    --ins-text: #080;
    --ins-bg: transparent;

    --a-normal-text: #034575;
    --a-normal-underline: #bbb;
    --a-visited-text: var(--a-normal-text);
    --a-visited-underline: #707070;
    --a-hover-bg: rgba(75%, 75%, 75%, .25);
    --a-active-text: #c00;
    --a-active-underline: #c00;

    --blockquote-border: silver;
    --blockquote-bg: transparent;
    --blockquote-text: currentcolor;

    --issue-border: #e05252;
    --issue-bg: #fbe9e9;
    --issue-text: var(--text);
    --issueheading-text: #831616;

    --example-border: #e0cb52;
    --example-bg: #fcfaee;
    --example-text: var(--text);
    --exampleheading-text: #574b0f;

    --note-border: #52e052;
    --note-bg: #e9fbe9;
    --note-text: var(--text);
    --noteheading-text: hsl(120, 70%, 30%);
    --notesummary-underline: silver;

    --assertion-border: #aaa;
    --assertion-bg: #eee;
    --assertion-text: black;

    --advisement-border: orange;
    --advisement-bg: #fec;
    --advisement-text: var(--text);
    --advisementheading-text: #b35f00;

    --warning-border: red;
    --warning-bg: hsla(40,100%,50%,0.95);
    --warning-text: var(--text);

    --amendment-border: #330099;
    --amendment-bg: #F5F0FF;
    --amendment-text: var(--text);
    --amendmentheading-text: #220066;

    --def-border: #8ccbf2;
    --def-bg: #def;
    --def-text: var(--text);
    --defrow-border: #bbd7e9;

    --datacell-border: silver;

    --indexinfo-text: #707070;

    --indextable-hover-text: black;
    --indextable-hover-bg: #f7f8f9;

    --outdatedspec-bg: rgba(0, 0, 0, .5);
    --outdatedspec-text: black;
    --outdated-bg: maroon;
    --outdated-text: white;
    --outdated-shadow: red;

    --editedrec-bg: darkorange;
}</style>
<style>/* style-counters */

body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}</style>
<style>/* style-dfn-panel */

:root {
    --dfnpanel-bg: #ddd;
    --dfnpanel-text: var(--text);
}
.dfn-panel {
    position: absolute;
    z-index: 35;
    height: auto;
    width: -webkit-fit-content;
    width: fit-content;
    max-width: 300px;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--dfnpanel-bg);
    color: var(--dfnpanel-text);
    border: outset 0.2em;
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: var(--dfnpanel-text); }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0; }
.dfn-panel li { list-style: inside; }
.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: .5em;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
}

.dfn-paneled { cursor: pointer; }
</style>
<style>/* style-issues */

a[href].issue-return {
    float: right;
    float: inline-end;
    color: var(--issueheading-text);
    font-weight: bold;
    text-decoration: none;
}
</style>
<style>/* style-md-lists */

/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}</style>
<style>/* style-selflinks */

:root {
    --selflink-text: white;
    --selflink-bg: gray;
    --selflink-hover-text: black;
}
.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: var(--selflink-bg);
    color: var(--selflink-text);
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: var(--selflink-hover-text);
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }
</style>
<style>/* style-syntax-highlighting */

            pre.idl.highlight {
                background: var(--borderedblock-bg, var(--def-bg));
            }
            
code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }

.highlight:not(.idl) { background: rgba(0, 0, 0, .03); }
c-[a] { color: #990055 } /* Keyword.Declaration */
c-[b] { color: #990055 } /* Keyword.Type */
c-[c] { color: #708090 } /* Comment */
c-[d] { color: #708090 } /* Comment.Multiline */
c-[e] { color: #0077aa } /* Name.Attribute */
c-[f] { color: #669900 } /* Name.Tag */
c-[g] { color: #222222 } /* Name.Variable */
c-[k] { color: #990055 } /* Keyword */
c-[l] { color: #000000 } /* Literal */
c-[m] { color: #000000 } /* Literal.Number */
c-[n] { color: #0077aa } /* Name */
c-[o] { color: #999999 } /* Operator */
c-[p] { color: #999999 } /* Punctuation */
c-[s] { color: #a67f59 } /* Literal.String */
c-[t] { color: #a67f59 } /* Literal.String.Single */
c-[u] { color: #a67f59 } /* Literal.String.Double */
c-[cp] { color: #708090 } /* Comment.Preproc */
c-[c1] { color: #708090 } /* Comment.Single */
c-[cs] { color: #708090 } /* Comment.Special */
c-[kc] { color: #990055 } /* Keyword.Constant */
c-[kn] { color: #990055 } /* Keyword.Namespace */
c-[kp] { color: #990055 } /* Keyword.Pseudo */
c-[kr] { color: #990055 } /* Keyword.Reserved */
c-[ld] { color: #000000 } /* Literal.Date */
c-[nc] { color: #0077aa } /* Name.Class */
c-[no] { color: #0077aa } /* Name.Constant */
c-[nd] { color: #0077aa } /* Name.Decorator */
c-[ni] { color: #0077aa } /* Name.Entity */
c-[ne] { color: #0077aa } /* Name.Exception */
c-[nf] { color: #0077aa } /* Name.Function */
c-[nl] { color: #0077aa } /* Name.Label */
c-[nn] { color: #0077aa } /* Name.Namespace */
c-[py] { color: #0077aa } /* Name.Property */
c-[ow] { color: #999999 } /* Operator.Word */
c-[mb] { color: #000000 } /* Literal.Number.Bin */
c-[mf] { color: #000000 } /* Literal.Number.Float */
c-[mh] { color: #000000 } /* Literal.Number.Hex */
c-[mi] { color: #000000 } /* Literal.Number.Integer */
c-[mo] { color: #000000 } /* Literal.Number.Oct */
c-[sb] { color: #a67f59 } /* Literal.String.Backtick */
c-[sc] { color: #a67f59 } /* Literal.String.Char */
c-[sd] { color: #a67f59 } /* Literal.String.Doc */
c-[se] { color: #a67f59 } /* Literal.String.Escape */
c-[sh] { color: #a67f59 } /* Literal.String.Heredoc */
c-[si] { color: #a67f59 } /* Literal.String.Interpol */
c-[sx] { color: #a67f59 } /* Literal.String.Other */
c-[sr] { color: #a67f59 } /* Literal.String.Regex */
c-[ss] { color: #a67f59 } /* Literal.String.Symbol */
c-[vc] { color: #0077aa } /* Name.Variable.Class */
c-[vg] { color: #0077aa } /* Name.Variable.Global */
c-[vi] { color: #0077aa } /* Name.Variable.Instance */
c-[il] { color: #000000 } /* Literal.Number.Integer.Long */
</style>
<style>/* style-var-click-highlighting */

    var { cursor: pointer; }
    var.selected0 { background-color: #F4D200; box-shadow: 0 0 0 2px #F4D200; }
    var.selected1 { background-color: #FF87A2; box-shadow: 0 0 0 2px #FF87A2; }
    var.selected2 { background-color: #96E885; box-shadow: 0 0 0 2px #96E885; }
    var.selected3 { background-color: #3EEED2; box-shadow: 0 0 0 2px #3EEED2; }
    var.selected4 { background-color: #EACFB6; box-shadow: 0 0 0 2px #EACFB6; }
    var.selected5 { background-color: #82DDFF; box-shadow: 0 0 0 2px #82DDFF; }
    var.selected6 { background-color: #FFBCF2; box-shadow: 0 0 0 2px #FFBCF2; }
    </style>
<style>/* style-darkmode */

@media (prefers-color-scheme: dark) {
    :root {
        --text: #ddd;
        --bg: black;

        --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

        --logo-bg: #1a5e9a;
        --logo-active-bg: #c00;
        --logo-text: white;

        --tocnav-normal-text: #999;
        --tocnav-normal-bg: var(--bg);
        --tocnav-hover-text: var(--tocnav-normal-text);
        --tocnav-hover-bg: #080808;
        --tocnav-active-text: #f44;
        --tocnav-active-bg: var(--tocnav-normal-bg);

        --tocsidebar-text: var(--text);
        --tocsidebar-bg: #080808;
        --tocsidebar-shadow: rgba(255,255,255,.1);
        --tocsidebar-heading-text: hsla(203,20%,40%,.7);

        --toclink-text: var(--text);
        --toclink-underline: #6af;
        --toclink-visited-text: var(--toclink-text);
        --toclink-visited-underline: #054572;

        --heading-text: #8af;

        --hr-text: var(--text);

        --algo-border: #456;

        --del-text: #f44;
        --del-bg: transparent;
        --ins-text: #4a4;
        --ins-bg: transparent;

        --a-normal-text: #6af;
        --a-normal-underline: #555;
        --a-visited-text: var(--a-normal-text);
        --a-visited-underline: var(--a-normal-underline);
        --a-hover-bg: rgba(25%, 25%, 25%, .2);
        --a-active-text: #f44;
        --a-active-underline: var(--a-active-text);

        --borderedblock-bg: rgba(255, 255, 255, .05);

        --blockquote-border: silver;
        --blockquote-bg: var(--borderedblock-bg);
        --blockquote-text: currentcolor;

        --issue-border: #e05252;
        --issue-bg: var(--borderedblock-bg);
        --issue-text: var(--text);
        --issueheading-text: hsl(0deg, 70%, 70%);

        --example-border: hsl(50deg, 90%, 60%);
        --example-bg: var(--borderedblock-bg);
        --example-text: var(--text);
        --exampleheading-text: hsl(50deg, 70%, 70%);

        --note-border: hsl(120deg, 100%, 35%);
        --note-bg: var(--borderedblock-bg);
        --note-text: var(--text);
        --noteheading-text: hsl(120, 70%, 70%);
        --notesummary-underline: silver;

        --assertion-border: #444;
        --assertion-bg: var(--borderedblock-bg);
        --assertion-text: var(--text);

        --advisement-border: orange;
        --advisement-bg: #222218;
        --advisement-text: var(--text);
        --advisementheading-text: #f84;

        --warning-border: red;
        --warning-bg: hsla(40,100%,20%,0.95);
        --warning-text: var(--text);

        --amendment-border: #330099;
        --amendment-bg: #080010;
        --amendment-text: var(--text);
        --amendmentheading-text: #cc00ff;

        --def-border: #8ccbf2;
        --def-bg: #080818;
        --def-text: var(--text);
        --defrow-border: #136;

        --datacell-border: silver;

        --indexinfo-text: #aaa;

        --indextable-hover-text: var(--text);
        --indextable-hover-bg: #181818;

        --outdatedspec-bg: rgba(255, 255, 255, .5);
        --outdatedspec-text: black;
        --outdated-bg: maroon;
        --outdated-text: white;
        --outdated-shadow: red;

        --editedrec-bg: darkorange;
    }
    /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
    img { background: white; }
}
@media (prefers-color-scheme: dark) {
    :root {
        --selflink-text: black;
        --selflink-bg: silver;
        --selflink-hover-text: white;
    }
}

@media (prefers-color-scheme: dark) {
    :root {
        --dfnpanel-bg: #222;
        --dfnpanel-text: var(--text);
    }
}
@media (prefers-color-scheme: dark) {
    .highlight:not(.idl) { background: rgba(255, 255, 255, .05); }

    c-[a] { color: #d33682 } /* Keyword.Declaration */
    c-[b] { color: #d33682 } /* Keyword.Type */
    c-[c] { color: #2aa198 } /* Comment */
    c-[d] { color: #2aa198 } /* Comment.Multiline */
    c-[e] { color: #268bd2 } /* Name.Attribute */
    c-[f] { color: #b58900 } /* Name.Tag */
    c-[g] { color: #cb4b16 } /* Name.Variable */
    c-[k] { color: #d33682 } /* Keyword */
    c-[l] { color: #657b83 } /* Literal */
    c-[m] { color: #657b83 } /* Literal.Number */
    c-[n] { color: #268bd2 } /* Name */
    c-[o] { color: #657b83 } /* Operator */
    c-[p] { color: #657b83 } /* Punctuation */
    c-[s] { color: #6c71c4 } /* Literal.String */
    c-[t] { color: #6c71c4 } /* Literal.String.Single */
    c-[u] { color: #6c71c4 } /* Literal.String.Double */
    c-[ch] { color: #2aa198 } /* Comment.Hashbang */
    c-[cp] { color: #2aa198 } /* Comment.Preproc */
    c-[cpf] { color: #2aa198 } /* Comment.PreprocFile */
    c-[c1] { color: #2aa198 } /* Comment.Single */
    c-[cs] { color: #2aa198 } /* Comment.Special */
    c-[kc] { color: #d33682 } /* Keyword.Constant */
    c-[kn] { color: #d33682 } /* Keyword.Namespace */
    c-[kp] { color: #d33682 } /* Keyword.Pseudo */
    c-[kr] { color: #d33682 } /* Keyword.Reserved */
    c-[ld] { color: #657b83 } /* Literal.Date */
    c-[nc] { color: #268bd2 } /* Name.Class */
    c-[no] { color: #268bd2 } /* Name.Constant */
    c-[nd] { color: #268bd2 } /* Name.Decorator */
    c-[ni] { color: #268bd2 } /* Name.Entity */
    c-[ne] { color: #268bd2 } /* Name.Exception */
    c-[nf] { color: #268bd2 } /* Name.Function */
    c-[nl] { color: #268bd2 } /* Name.Label */
    c-[nn] { color: #268bd2 } /* Name.Namespace */
    c-[py] { color: #268bd2 } /* Name.Property */
    c-[ow] { color: #657b83 } /* Operator.Word */
    c-[mb] { color: #657b83 } /* Literal.Number.Bin */
    c-[mf] { color: #657b83 } /* Literal.Number.Float */
    c-[mh] { color: #657b83 } /* Literal.Number.Hex */
    c-[mi] { color: #657b83 } /* Literal.Number.Integer */
    c-[mo] { color: #657b83 } /* Literal.Number.Oct */
    c-[sa] { color: #6c71c4 } /* Literal.String.Affix */
    c-[sb] { color: #6c71c4 } /* Literal.String.Backtick */
    c-[sc] { color: #6c71c4 } /* Literal.String.Char */
    c-[dl] { color: #6c71c4 } /* Literal.String.Delimiter */
    c-[sd] { color: #6c71c4 } /* Literal.String.Doc */
    c-[se] { color: #6c71c4 } /* Literal.String.Escape */
    c-[sh] { color: #6c71c4 } /* Literal.String.Heredoc */
    c-[si] { color: #6c71c4 } /* Literal.String.Interpol */
    c-[sx] { color: #6c71c4 } /* Literal.String.Other */
    c-[sr] { color: #6c71c4 } /* Literal.String.Regex */
    c-[ss] { color: #6c71c4 } /* Literal.String.Symbol */
    c-[fm] { color: #268bd2 } /* Name.Function.Magic */
    c-[vc] { color: #cb4b16 } /* Name.Variable.Class */
    c-[vg] { color: #cb4b16 } /* Name.Variable.Global */
    c-[vi] { color: #cb4b16 } /* Name.Variable.Instance */
    c-[vm] { color: #cb4b16 } /* Name.Variable.Magic */
    c-[il] { color: #657b83 } /* Literal.Number.Integer.Long */
}
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72"> </a> </p>
   <h1 class="p-name no-ref" id="title">Attribution Reporting</h1>
   <p id="w3c-state"><a href="https://www.w3.org/standards/types#CG-DRAFT">Draft Community Group Report</a>, <time class="dt-updated" datetime="2022-10-06">6 October 2022</time></p>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="https://wicg.github.io/attribution-reporting-api">https://wicg.github.io/attribution-reporting-api</a>
     <dt>Issue Tracking:
     <dd><a href="https://github.com/WICG/attribution-reporting-api/issues/">GitHub</a>
     <dd><a href="#issues-index">Inline In Spec</a>
     <dt class="editor">Editors:
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:csharrison@chromium.org">Charlie Harrison</a> (<a class="p-org org" href="https://google.com">Google Inc.</a>)
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:johnidel@chromium.org">John Delaney</a> (<a class="p-org org" href="https://google.com">Google Inc.</a>)
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:apaseltiner@chromium.org">Andrew Paseltiner</a> (<a class="p-org org" href="https://google.com">Google Inc.</a>)
    </dl>
   </div>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 2022 the Contributors to the Attribution Reporting Specification, published by the <a href="https://www.w3.org/community/wicg/">Web Platform Incubator Community Group</a> under the <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a>.
A human-readable <a href="http://www.w3.org/community/about/agreements/cla-deed/">summary</a> is available. </p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>An API to report that an event may have been caused by another cross-site event. These reports are designed to transfer little enough data between sites that the sites can’t use them to track individual users.</p>
  </div>
  <div data-fill-with="at-risk"></div>
  <h2 class="no-num no-toc no-ref heading settled" id="status"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p> This specification was published by the <a href="https://www.w3.org/community/wicg/">Web Platform Incubator Community Group</a>.
  It is not a W3C Standard nor is it on the W3C Standards Track.

  Please note that under the <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a> there is a limited opt-out and other conditions apply.

  Learn more about <a href="http://www.w3.org/community/">W3C Community and Business Groups</a>. </p>
   <p></p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li>
     <a href="#intro"><span class="secno">1</span> <span class="content">Introduction</span></a>
     <ol class="toc">
      <li><a href="#overview"><span class="secno">1.1</span> <span class="content">Overview</span></a>
     </ol>
    <li>
     <a href="#html-monkeypatches"><span class="secno">2</span> <span class="content">HTML monkeypatches</span></a>
     <ol class="toc">
      <li><a href="#monkeypatch-attributionsrc"><span class="secno">2.1</span> <span class="content">API for elements</span></a>
      <li>
       <a href="#monkeypatch-navigation"><span class="secno">2.2</span> <span class="content">Navigation</span></a>
       <ol class="toc">
        <li><a href="#monkeypatch-navigation-params"><span class="secno">2.2.1</span> <span class="content">Navigation Params</span></a>
        <li><a href="#monkeypatch-navigate-algorithm"><span class="secno">2.2.2</span> <span class="content">Navigate algorithm</span></a>
        <li><a href="#monkeypatch-navigate-fetch"><span class="secno">2.2.3</span> <span class="content">Process a navigate fetch</span></a>
        <li><a href="#monkeypatch-document-creation"><span class="secno">2.2.4</span> <span class="content">Document creation</span></a>
       </ol>
      <li><a href="#monkeypatch-following-hyperlink"><span class="secno">2.3</span> <span class="content">Follow the hyperlink</span></a>
      <li><a href="#monkeypatch-window-open"><span class="secno">2.4</span> <span class="content">Window open steps</span></a>
     </ol>
    <li><a href="#fetch-monkeypatches"><span class="secno">3</span> <span class="content">Fetch monkeypatches</span></a>
    <li><a href="#permission-policy-integration"><span class="secno">4</span> <span class="content">Permissions Policy integration</span></a>
    <li>
     <a href="#structures"><span class="secno">5</span> <span class="content">Structures</span></a>
     <ol class="toc">
      <li><a href="#trigger-state"><span class="secno">5.1</span> <span class="content">Trigger state</span></a>
      <li><a href="#randomized-source-response"><span class="secno">5.2</span> <span class="content">Randomized source response</span></a>
      <li><a href="#attribution-filtering"><span class="secno">5.3</span> <span class="content">Attribution filtering</span></a>
      <li><a href="#source-type"><span class="secno">5.4</span> <span class="content">Source type</span></a>
      <li><a href="#attribution-source"><span class="secno">5.5</span> <span class="content">Attribution source</span></a>
      <li><a href="#aggregatable-trigger-data"><span class="secno">5.6</span> <span class="content">Aggregatable trigger data</span></a>
      <li><a href="#event-level-trigger-configuration"><span class="secno">5.7</span> <span class="content">Event-level trigger configuration</span></a>
      <li><a href="#attribution-trigger"><span class="secno">5.8</span> <span class="content">Attribution trigger</span></a>
      <li><a href="#event-level-report"><span class="secno">5.9</span> <span class="content">Event-level report</span></a>
      <li><a href="#aggregatable-contribution"><span class="secno">5.10</span> <span class="content">Aggregatable contribution</span></a>
      <li><a href="#attribution-rate-limit-record"><span class="secno">5.11</span> <span class="content">Attribution rate-limit record</span></a>
     </ol>
    <li><a href="#storage"><span class="secno">6</span> <span class="content">Storage</span></a>
    <li><a href="#vendor-specific-values"><span class="secno">7</span> <span class="content">Vendor-Specific Values</span></a>
    <li>
     <a href="#general-algorithms"><span class="secno">8</span> <span class="content">General Algorithms</span></a>
     <ol class="toc">
      <li><a href="#parsing-filter-data"><span class="secno">8.1</span> <span class="content">Parsing filter data</span></a>
      <li><a href="#debug-keys"><span class="secno">8.2</span> <span class="content">Debug keys</span></a>
      <li><a href="#obtaining-randomized-response"><span class="secno">8.3</span> <span class="content">Obtaining a randomized response</span></a>
      <li><a href="#parsing-aggregation-key-piece"><span class="secno">8.4</span> <span class="content">Parsing aggregation key piece</span></a>
     </ol>
    <li>
     <a href="#source-algorithms"><span class="secno">9</span> <span class="content">Source Algorithms</span></a>
     <ol class="toc">
      <li><a href="#obtaining-attribution-source-expiry-time"><span class="secno">9.1</span> <span class="content">Obtaining an attribution source’s expiry time</span></a>
      <li><a href="#obtaining-attribution-source-site"><span class="secno">9.2</span> <span class="content">Obtaining an attribution source’s source site</span></a>
      <li><a href="#parsing-attribution-destination"><span class="secno">9.3</span> <span class="content">Parsing an attribution destination</span></a>
      <li><a href="#obtaining-randomized-source-response"><span class="secno">9.4</span> <span class="content">Obtaining a randomized source response</span></a>
      <li><a href="#obtaining-attribution-source-anchor"><span class="secno">9.5</span> <span class="content">Obtaining an attribution source from an <code>a</code> element</span></a>
      <li><a href="#obtaining-attribution-source-window-features"><span class="secno">9.6</span> <span class="content">Obtaining an attribution source from window features</span></a>
      <li><a href="#parsing-source-registration"><span class="secno">9.7</span> <span class="content">Parsing source-registration JSON</span></a>
      <li><a href="#check-pending-destination-limit"><span class="secno">9.8</span> <span class="content">Checking pending destination limit</span></a>
      <li><a href="#processing-an-attribution-source"><span class="secno">9.9</span> <span class="content">Processing an attribution source</span></a>
     </ol>
    <li>
     <a href="#trigger-algorithms"><span class="secno">10</span> <span class="content">Triggering Algorithms</span></a>
     <ol class="toc">
      <li><a href="#attribution-trigger-creation"><span class="secno">10.1</span> <span class="content">Creating an attribution trigger</span></a>
      <li><a href="#does-filter-data-match"><span class="secno">10.2</span> <span class="content">Does filter data match</span></a>
      <li><a href="#should-rate-limit-attribution"><span class="secno">10.3</span> <span class="content">Should attribution be blocked by rate limit</span></a>
      <li><a href="#should-block-processing-for-reporting-endpoint-limit"><span class="secno">10.4</span> <span class="content">Should processing be blocked by reporting-endpoint limit</span></a>
      <li><a href="#creating-aggregatable-contributions"><span class="secno">10.5</span> <span class="content">Creating aggregatable contributions</span></a>
      <li><a href="#triggering-attribution"><span class="secno">10.6</span> <span class="content">Triggering attribution</span></a>
      <li><a href="#delivery-time"><span class="secno">10.7</span> <span class="content">Establishing report delivery time</span></a>
      <li><a href="#obtaining-an-event-level-report"><span class="secno">10.8</span> <span class="content">Obtaining an event-level report</span></a>
     </ol>
    <li>
     <a href="#report-delivery"><span class="secno">11</span> <span class="content">Report delivery</span></a>
     <ol class="toc">
      <li><a href="#serialize-integer"><span class="secno">11.1</span> <span class="content">Serialize an integer</span></a>
      <li><a href="#serialize-report-body"><span class="secno">11.2</span> <span class="content">Serialize attribution report body</span></a>
      <li><a href="#get-report-url"><span class="secno">11.3</span> <span class="content">Get report request URL</span></a>
      <li><a href="#create-report-request"><span class="secno">11.4</span> <span class="content">Creating a report request</span></a>
      <li><a href="#issue-report-request"><span class="secno">11.5</span> <span class="content">Issuing a report request</span></a>
      <li><a href="#issue-debug-report-request"><span class="secno">11.6</span> <span class="content">Issuing a debug report request</span></a>
     </ol>
    <li><a href="#security-considerations"><span class="secno">12</span> <span class="content">Security considerations</span></a>
    <li>
     <a href="#privacy-considerations"><span class="secno">13</span> <span class="content">Privacy consideration</span></a>
     <ol class="toc">
      <li><a href="#clearing-attribution-storage"><span class="secno">13.1</span> <span class="content">Clearing attribution storage</span></a>
     </ol>
    <li>
     <a href="#w3c-conformance"><span class="secno"></span> <span class="content">Conformance</span></a>
     <ol class="toc">
      <li><a href="#w3c-conventions"><span class="secno"></span> <span class="content">Document conventions</span></a>
      <li><a href="#w3c-conformant-algorithms"><span class="secno"></span> <span class="content">Conformant Algorithms</span></a>
     </ol>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
    <li><a href="#issues-index"><span class="secno"></span> <span class="content">Issues Index</span></a>
   </ol>
  </nav>
  <main>
   <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#intro"></a></h2>
   <p><em>This section is non-normative</em></p>
   <p>This specification describes how web browsers can provide a mechanism to the
web that supports measuring and attributing conversions (e.g. purchases) to ads
a user interacted with on another site. This mechanism should remove one need
for cross-site identifiers like third-party cookies.</p>
   <h3 class="heading settled" data-level="1.1" id="overview"><span class="secno">1.1. </span><span class="content">Overview</span><a class="self-link" href="#overview"></a></h3>
   <p>Pages/embedded sites are given the ability to register <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-source">attribution sources</a> and <a data-link-type="dfn" href="#attribution-trigger" id="ref-for-attribution-trigger">attribution triggers</a>, which can be linked by the User Agent to generate and
send <a data-link-type="dfn" href="#event-level-report" id="ref-for-event-level-report">event-level reports</a> containing information from both of those events.</p>
   <p>A reporter <code>https://reporter.example</code> embedded on <code>https://source.example</code> is able to
measure whether an iteraction on the page lead to an action on <code>https://destination.example</code> by registering an <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-source①">attribution source</a> with an <a data-link-type="dfn" href="#attribution-source-attribution-destination" id="ref-for-attribution-source-attribution-destination">attribution destination</a> of <code>https://destination.example</code>. Reporters are able to register sources through a variety
of surfaces, but ultimately the reporter is required to provide the User Agent with an
HTTP-response header which allows the source to be eligible for attribution.</p>
   <p>At a later point in time, the reporter, now embedded on <code>https://destination.example</code>,
may register an <a data-link-type="dfn" href="#attribution-trigger" id="ref-for-attribution-trigger①">attribution trigger</a>. Reporters can register triggers by sending an
HTTP-response header containing information about the action/event that occurred. Internally,
the User Agent attempts to match the trigger to previously registered source events based on
where the sources/triggers were registered and configurations provided by the reporter.</p>
   <p>If the User Agent is able to attribute the trigger to a source, it will generate and
send an <a data-link-type="dfn" href="#event-level-report" id="ref-for-event-level-report①">event-level report</a> to the reporter via an HTTP POST request at a later point
in time.</p>
   <h2 class="heading settled" data-level="2" id="html-monkeypatches"><span class="secno">2. </span><span class="content">HTML monkeypatches</span><a class="self-link" href="#html-monkeypatches"></a></h2>
   <h3 class="heading settled" data-level="2.1" id="monkeypatch-attributionsrc"><span class="secno">2.1. </span><span class="content">API for elements</span><a class="self-link" href="#monkeypatch-attributionsrc"></a></h3>
<pre class="idl highlight def"><c- b>interface</c-> <c- b>mixin</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="htmlattributionsrcelementutils"><code><c- g>HTMLAttributionSrcElementUtils</c-></code></dfn> {
    [<a class="idl-code" data-link-type="extended-attribute" href="https://html.spec.whatwg.org/multipage/custom-elements.html#cereactions" id="ref-for-cereactions"><c- g>CEReactions</c-></a>] <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString"><c- b>USVString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="HTMLAttributionSrcElementUtils" data-dfn-type="attribute" data-export data-type="USVString" id="dom-htmlattributionsrcelementutils-attributionsrc"><code><c- g>attributionSrc</c-></code></dfn>;
};

<a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/text-level-semantics.html#htmlanchorelement" id="ref-for-htmlanchorelement"><c- n>HTMLAnchorElement</c-></a> <c- b>includes</c-> <a data-link-type="idl-name" href="#htmlattributionsrcelementutils" id="ref-for-htmlattributionsrcelementutils"><c- n>HTMLAttributionSrcElementUtils</c-></a>;
<a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/embedded-content.html#htmlimageelement" id="ref-for-htmlimageelement"><c- n>HTMLImageElement</c-></a> <c- b>includes</c-> <a data-link-type="idl-name" href="#htmlattributionsrcelementutils" id="ref-for-htmlattributionsrcelementutils①"><c- n>HTMLAttributionSrcElementUtils</c-></a>;
<a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/scripting.html#htmlscriptelement" id="ref-for-htmlscriptelement"><c- n>HTMLScriptElement</c-></a> <c- b>includes</c-> <a data-link-type="idl-name" href="#htmlattributionsrcelementutils" id="ref-for-htmlattributionsrcelementutils②"><c- n>HTMLAttributionSrcElementUtils</c-></a>;
</pre>
   <p>Add the following <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/dom.html#concept-element-attributes" id="ref-for-concept-element-attributes">content attributes</a>:</p>
   <dl>
    <dt data-md><code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-a-element" id="ref-for-the-a-element">a</a></code>
    <dd data-md>
     <p><code>attributionsrc</code> - <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url">URL</a> for attribution registration</p>
    <dt data-md><code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/embedded-content.html#the-img-element" id="ref-for-the-img-element">img</a></code>
    <dd data-md>
     <p><code>attributionsrc</code> - <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url①">URL</a> for attribution registration</p>
    <dt data-md><code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script" id="ref-for-script">script</a></code>
    <dd data-md>
     <p><code>attributionsrc</code> - <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url②">URL</a> for attribution registration</p>
   </dl>
   <p>Add the following content attribute descriptions:</p>
   <dl>
    <dt data-md><code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-a-element" id="ref-for-the-a-element①">a</a></code>
    <dd data-md>
     <p>The <dfn class="dfn-paneled" data-dfn-for="a" data-dfn-type="element-attr" data-export id="element-attrdef-a-attributionsrc"><code>attributionsrc</code></dfn> attribute is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string">string</a> representing the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url③">URL</a> of the resource that will register an <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-source②">attribution source</a> when the <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-a-element" id="ref-for-the-a-element②">a</a></code> is navigated.</p>
    <dt data-md><code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/embedded-content.html#the-img-element" id="ref-for-the-img-element①">img</a></code>
    <dd data-md>
     <p>The <dfn data-dfn-for="img" data-dfn-type="element-attr" data-export id="element-attrdef-img-attributionsrc"><code>attributionsrc</code><a class="self-link" href="#element-attrdef-img-attributionsrc"></a></dfn> attribute is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string①">string</a> representing the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url④">URL</a> of the resource that will register an <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-source③">attribution source</a> or <a data-link-type="dfn" href="#attribution-trigger" id="ref-for-attribution-trigger②">attribution trigger</a> when set.</p>
    <dt data-md><code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script" id="ref-for-script①">script</a></code>
    <dd data-md>
     <p>The <dfn data-dfn-for="script" data-dfn-type="element-attr" data-export id="element-attrdef-script-attributionsrc"><code>attributionsrc</code><a class="self-link" href="#element-attrdef-script-attributionsrc"></a></dfn> attribute is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string②">string</a> representing the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url⑤">URL</a> of the resource that will register an <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-source④">attribution source</a> or <a data-link-type="dfn" href="#attribution-trigger" id="ref-for-attribution-trigger③">attribution trigger</a> when set.</p>
   </dl>
   <p>The IDL attribute <code class="idl"><a data-link-type="idl" href="#dom-htmlattributionsrcelementutils-attributionsrc" id="ref-for-dom-htmlattributionsrcelementutils-attributionsrc">attributionSrc</a></code> must <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/common-dom-interfaces.html#reflect" id="ref-for-reflect">reflect</a> the respective content attribute of the same
name.</p>
   <h3 class="heading settled" data-level="2.2" id="monkeypatch-navigation"><span class="secno">2.2. </span><span class="content">Navigation</span><a class="self-link" href="#monkeypatch-navigation"></a></h3>
   <p>This section ensures that an <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-source⑤">attribution source</a> associated with a navigation
results in a top-level navigation whose final URL is <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#same-site" id="ref-for-same-site">same site</a> with the <a data-link-type="dfn" href="#attribution-source-attribution-destination" id="ref-for-attribution-source-attribution-destination①">attribution destination</a>.</p>
   <h4 class="heading settled" data-level="2.2.1" id="monkeypatch-navigation-params"><span class="secno">2.2.1. </span><span class="content">Navigation Params</span><a class="self-link" href="#monkeypatch-navigation-params"></a></h4>
   <p>A <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params" id="ref-for-navigation-params">navigation params</a> struct has an item:</p>
   <dl>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="navigation params" data-dfn-type="dfn" data-noexport id="navigation-params-attribution-source">attribution source</dfn>
    <dd data-md>
     <p>null or an <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-source⑥">attribution source</a> declared when initiating a navigation</p>
   </dl>
   <h4 class="heading settled" data-level="2.2.2" id="monkeypatch-navigate-algorithm"><span class="secno">2.2.2. </span><span class="content">Navigate algorithm</span><a class="self-link" href="#monkeypatch-navigate-algorithm"></a></h4>
   <p>Modify the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigate" id="ref-for-navigate">navigate</a> algorithm to accept a new optional parameter <var>attributionSource</var> of type <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-source⑦">attribution source</a> defaulting to null.</p>
   <p>In <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigate" id="ref-for-navigate①">navigate</a>, within step</p>
   <blockquote>
    <ol start="19">
     <li data-md>
      <p>This is the step that attempts to obtain resource, if necessary. Jump to the first appropriate substep:
...</p>
    </ol>
   </blockquote>
   <p>in the case where</p>
   <blockquote>
    <p>If resource is a response</p>
   </blockquote>
   <p>modify the substep</p>
   <blockquote>
    <ol start="7">
     <li data-md>
      <p>Let navigationParams be a new navigation params whose request is null, response is resource
...</p>
    </ol>
   </blockquote>
   <p>to set the <a data-link-type="dfn" href="#navigation-params-attribution-source" id="ref-for-navigation-params-attribution-source">attribution source</a> of <var>navigationParams</var> to <var>attributionSource</var>.</p>
   <p>In the case where</p>
   <blockquote>
    <p>If resource is a request whose URL’s scheme is "javascript"</p>
   </blockquote>
   <p>modify the substep</p>
   <blockquote>
    <ol start="4">
     <li data-md>
      <p>Let navigationParams be a new navigation params whose request is resource,
...</p>
    </ol>
   </blockquote>
   <p>to set the <a data-link-type="dfn" href="#navigation-params-attribution-source" id="ref-for-navigation-params-attribution-source①">attribution source</a> of <var>navigationParams</var> to <var>attributionSource</var>.</p>
   <p>In the case where</p>
   <blockquote>
    <p>If resource is a request whose URL’s scheme is a fetch scheme</p>
   </blockquote>
   <p>modify the substep to pass <var>attributionSource</var> to the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#process-a-navigate-fetch" id="ref-for-process-a-navigate-fetch">process a navigate fetch</a> algorithm.</p>
   <p class="note" role="note"><span>Note:</span> The final case, where the request is not a javascript or fetch scheme, does not need to be handled
 as it will not result in the navigation of a top-level browsing context.</p>
   <h4 class="heading settled" data-level="2.2.3" id="monkeypatch-navigate-fetch"><span class="secno">2.2.3. </span><span class="content">Process a navigate fetch</span><a class="self-link" href="#monkeypatch-navigate-fetch"></a></h4>
   <p>Modify the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#process-a-navigate-fetch" id="ref-for-process-a-navigate-fetch①">process a navigate fetch</a> algorithm to accept a new optional parameter <var>attributionSource</var> of type <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-source⑧">attribution source</a> defaulting to null.</p>
   <p>In <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#process-a-navigate-fetch" id="ref-for-process-a-navigate-fetch②">process a navigate fetch</a>, modify the step</p>
   <blockquote>
    <ol start="15">
     <li data-md>
      <p>Otherwise, if locationURL is a URL whose scheme is a fetch scheme, then run process a navigate fetch with a new request
...</p>
    </ol>
   </blockquote>
   <p>to also pass <var>attributionSource</var> into the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#process-a-navigate-fetch" id="ref-for-process-a-navigate-fetch③">process a navigate fetch</a> algorithm.</p>
   <p>Modify the step</p>
   <blockquote>
    <ol start="19">
     <li data-md>
      <p>Let navigationParams be a new navigation params whose request is request, response is response,
...</p>
    </ol>
   </blockquote>
   <p>to set the <a data-link-type="dfn" href="#navigation-params-attribution-source" id="ref-for-navigation-params-attribution-source②">attribution source</a> of <var>navigationParams</var> to <var>attributionSource</var>.</p>
   <h4 class="heading settled" data-level="2.2.4" id="monkeypatch-document-creation"><span class="secno">2.2.4. </span><span class="content">Document creation</span><a class="self-link" href="#monkeypatch-document-creation"></a></h4>
   <p>At the time <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#initialise-the-document-object" id="ref-for-initialise-the-document-object">create and initialize a <code>Document</code> object</a> is invoked, the user agent knows the final URL used for the
navigation and can validate the <a data-link-type="dfn" href="#attribution-source-attribution-destination" id="ref-for-attribution-source-attribution-destination②">attribution destination</a>.</p>
   <p>In <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#initialise-the-document-object" id="ref-for-initialise-the-document-object①">create and initialize a <code>Document</code> object</a>, before</p>
   <blockquote>
    <ol start="2">
     <li data-md>
      <p>Let permissionsPolicy be the result of creating a permissions policy from a response given browsingContext
...</p>
    </ol>
   </blockquote>
   <p>add the following step:</p>
   <ol>
    <li data-md>
     <p>Execute <a data-link-type="dfn" href="#maybe-process-a-navigation-attribution-source" id="ref-for-maybe-process-a-navigation-attribution-source">maybe process a navigation attribution source</a> with <var>navigationParams</var> and <var>browsingContext</var>.</p>
   </ol>
   <h3 class="heading settled" data-level="2.3" id="monkeypatch-following-hyperlink"><span class="secno">2.3. </span><span class="content">Follow the hyperlink</span><a class="self-link" href="#monkeypatch-following-hyperlink"></a></h3>
   <p>Attribution source information declared on the <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-a-element" id="ref-for-the-a-element③">a</a></code> element needs to be passed to the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigate" id="ref-for-navigate②">navigate</a> algorithm.</p>
   <p>In <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/links.html#following-hyperlinks-2" id="ref-for-following-hyperlinks-2">follow the hyperlink</a> after</p>
   <blockquote>
    <ol start="14">
     <li data-md>
      <p>Let historyHandling be "replace" if windowType is not "existing or none"; otherwise, "default".</p>
    </ol>
   </blockquote>
   <p>add the following steps:</p>
   <ol>
    <li data-md>
     <p>Let <var>attributionSource</var> be null.</p>
    <li data-md>
     <p>If <var>subject</var> is an <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-a-element" id="ref-for-the-a-element④">a</a></code> element, set <var>attributionSource</var> to the result of running <a data-link-type="dfn" href="#obtain-an-attribution-source-from-an-anchor" id="ref-for-obtain-an-attribution-source-from-an-anchor">obtain an attribution source from an anchor</a> with <var>subject</var>.</p>
   </ol>
   <p>Modify the step:</p>
   <blockquote>
    <ol start="15">
     <li data-md>
      <p>Queue an element task on the DOM manipulation task source given subject to navigate target to request
...</p>
    </ol>
   </blockquote>
   <p>to call <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigate" id="ref-for-navigate③">navigate</a> with <var>attributionSource</var> set to <var>attributionSource</var>.</p>
   <h3 class="heading settled" data-level="2.4" id="monkeypatch-window-open"><span class="secno">2.4. </span><span class="content">Window open steps</span><a class="self-link" href="#monkeypatch-window-open"></a></h3>
   <p>Attribution source information declared via <code>window.open()</code> needs to be passed to
the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigate" id="ref-for-navigate④">navigate</a> algorithm.</p>
   <p>In <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/window-object.html#window-open-steps" id="ref-for-window-open-steps">window open steps</a> after</p>
   <blockquote>
    <ol start="10">
     <li data-md>
      <p>If <var>target browsing context</var> is null, then return null.</p>
    </ol>
   </blockquote>
   <p>add the following steps:</p>
   <ol>
    <li data-md>
     <p>Let <var>attributionSource</var> be the result of running <a data-link-type="dfn" href="#obtain-an-attribution-source-from-window-features" id="ref-for-obtain-an-attribution-source-from-window-features">obtain an attribution source from window features</a> with <var>tokenizedFeatures</var> and <var>source browsing context</var>.</p>
   </ol>
   <p>Modify the step:</p>
   <blockquote>
    <ol start="3">
     <li data-md>
      <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigate" id="ref-for-navigate⑤">Navigate</a> <var>target browsing context</var> to <var>request</var>, with <var><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#exceptions-enabled" id="ref-for-exceptions-enabled">exceptionsEnabled</a></var> set to true and the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#source-browsing-context" id="ref-for-source-browsing-context">source browsing context</a> set to <var>source browsing context</var>.</p>
    </ol>
   </blockquote>
   <p>to also pass <var>attributionSource</var> into the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigate" id="ref-for-navigate⑥">navigate</a> algorithm.</p>
   <p>Modify the step:</p>
   <blockquote>
    <ol start="5">
     <li data-md>
      <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigate" id="ref-for-navigate⑦">Navigate</a> <var>target browsing context</var> to <var>request</var>, with <var><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#exceptions-enabled" id="ref-for-exceptions-enabled①">exceptionsEnabled</a></var> set to true and the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#source-browsing-context" id="ref-for-source-browsing-context①">source browsing context</a> set to <var>source browsing context</var>.</p>
    </ol>
   </blockquote>
   <p>to also pass <var>attributionSource</var> into the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigate" id="ref-for-navigate⑧">navigate</a> algorithm.</p>
   <h2 class="heading settled" data-level="3" id="fetch-monkeypatches"><span class="secno">3. </span><span class="content">Fetch monkeypatches</span><a class="self-link" href="#fetch-monkeypatches"></a></h2>
   <p class="issue" id="issue-963bda2b"><a class="self-link" href="#issue-963bda2b"></a> Specify monkeypatches for source/trigger registration.</p>
   <h2 class="heading settled" data-level="4" id="permission-policy-integration"><span class="secno">4. </span><span class="content">Permissions Policy integration</span><a class="self-link" href="#permission-policy-integration"></a></h2>
   <p>This specification defines a <a data-link-type="dfn" href="https://w3c.github.io/webappsec-permissions-policy/#policy-controlled-feature" id="ref-for-policy-controlled-feature">policy-controlled feature</a> identified by the string "<code><dfn data-dfn-type="dfn" data-noexport id="attribution-reporting">attribution-reporting<a class="self-link" href="#attribution-reporting"></a></dfn></code>". Its <a data-link-type="dfn" href="https://w3c.github.io/webappsec-permissions-policy/#default-allowlist" id="ref-for-default-allowlist">default allowlist</a> is <code>'self'</code>.</p>
   <p class="note" role="note"><span>Note:</span> In the Chromium implementation the <a data-link-type="dfn" href="https://w3c.github.io/webappsec-permissions-policy/#default-allowlist" id="ref-for-default-allowlist①">default allowlist</a> is temporarily set to <code>*</code> to ease testing.</p>
   <h2 class="heading settled" data-level="5" id="structures"><span class="secno">5. </span><span class="content">Structures</span><a class="self-link" href="#structures"></a></h2>
   <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-level="5.1" data-lt="Trigger state" data-noexport id="trigger-state"><span class="secno">5.1. </span><span class="content">Trigger state</span><a class="self-link" href="#trigger-state" id="ref-for-trigger-state"></a></h3>
   <p>A trigger state is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct" id="ref-for-struct">struct</a> with the following items:</p>
   <dl>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="trigger state" data-dfn-type="dfn" data-noexport id="trigger-state-trigger-data">trigger data</dfn>
    <dd data-md>
     <p>A non-negative 64-bit integer.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="trigger state" data-dfn-type="dfn" data-noexport id="trigger-state-report-window">report window</dfn>
    <dd data-md>
     <p>A non-negative integer.</p>
   </dl>
   <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-level="5.2" data-lt="Randomized source response" data-noexport id="randomized-source-response"><span class="secno">5.2. </span><span class="content">Randomized source response</span><a class="self-link" href="#randomized-source-response" id="ref-for-randomized-source-response"></a></h3>
   <p>A randomized source response is null or a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set">set</a> of <a data-link-type="dfn" href="#trigger-state" id="ref-for-trigger-state④">trigger states</a>.</p>
   <h3 class="heading settled" data-level="5.3" id="attribution-filtering"><span class="secno">5.3. </span><span class="content">Attribution filtering</span><a class="self-link" href="#attribution-filtering"></a></h3>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="filter-value">filter value</dfn> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set①">ordered set</a> of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string③">strings</a>.</p>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="filter-map">filter map</dfn> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map">ordered map</a> whose <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-key" id="ref-for-map-key">keys</a> are <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string④">strings</a> and whose <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-value" id="ref-for-map-value">values</a> are <a data-link-type="dfn" href="#filter-value" id="ref-for-filter-value">filter values</a>.</p>
   <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-level="5.4" data-lt="Source type" data-noexport id="source-type"><span class="secno">5.4. </span><span class="content">Source type</span><a class="self-link" href="#source-type" id="ref-for-source-type"></a></h3>
   <p>A source type is either "<code>navigation</code>" or "<code>event</code>".</p>
   <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-level="5.5" data-lt="Attribution source" data-noexport id="attribution-source"><span class="secno">5.5. </span><span class="content">Attribution source</span><a class="self-link" href="#attribution-source" id="ref-for-attribution-source③⑨"></a></h3>
   <p>An attribution source is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct" id="ref-for-struct①">struct</a> with the following items:</p>
   <dl>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution source" data-dfn-type="dfn" data-noexport id="attribution-source-source-identifier">source identifier</dfn>
    <dd data-md>
     <p>A <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string⑤">string</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution source" data-dfn-type="dfn" data-noexport id="attribution-source-source-origin">source origin</dfn>
    <dd data-md>
     <p>An <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin">origin</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution source" data-dfn-type="dfn" data-noexport id="attribution-source-event-id">event ID</dfn>
    <dd data-md>
     <p>A non-negative 64-bit integer.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution source" data-dfn-type="dfn" data-noexport id="attribution-source-attribution-destination">attribution destination</dfn>
    <dd data-md>
     <p>A <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#site" id="ref-for-site">site</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution source" data-dfn-type="dfn" data-noexport id="attribution-source-reporting-endpoint">reporting endpoint</dfn>
    <dd data-md>
     <p>An <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin①">origin</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution source" data-dfn-type="dfn" data-noexport id="attribution-source-source-type">source type</dfn>
    <dd data-md>
     <p>A <a data-link-type="dfn" href="#source-type" id="ref-for-source-type⑤">source type</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution source" data-dfn-type="dfn" data-noexport id="attribution-source-expiry">expiry</dfn>
    <dd data-md>
     <p>A length of time.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution source" data-dfn-type="dfn" data-noexport id="attribution-source-priority">priority</dfn>
    <dd data-md>
     <p>A 64-bit integer.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution source" data-dfn-type="dfn" data-noexport id="attribution-source-source-time">source time</dfn>
    <dd data-md>
     <p>A point in time.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution source" data-dfn-type="dfn" data-noexport id="attribution-source-number-of-event-level-reports">number of event-level reports</dfn>
    <dd data-md>
     <p>Number of <a data-link-type="dfn" href="#event-level-report" id="ref-for-event-level-report②">event-level reports</a> created for this <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-source⑨">attribution source</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution source" data-dfn-type="dfn" data-noexport id="attribution-source-dedup-keys">dedup keys</dfn>
    <dd data-md>
     <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set②">ordered set</a> of <a data-link-type="dfn" href="#event-level-trigger-configuration-dedup-key" id="ref-for-event-level-trigger-configuration-dedup-key">dedup keys</a> associated with this <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-source①⓪">attribution source</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution source" data-dfn-type="dfn" data-noexport id="attribution-source-randomized-response">randomized response</dfn>
    <dd data-md>
     <p>A <a data-link-type="dfn" href="#randomized-source-response" id="ref-for-randomized-source-response①">randomized source response</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution source" data-dfn-type="dfn" data-noexport id="attribution-source-randomized-trigger-rate">randomized trigger rate</dfn>
    <dd data-md>
     <p>A number between 0 and 1 (both inclusive).</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution source" data-dfn-type="dfn" data-noexport id="attribution-source-filter-data">filter data</dfn>
    <dd data-md>
     <p>A <a data-link-type="dfn" href="#filter-map" id="ref-for-filter-map">filter map</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution source" data-dfn-type="dfn" data-noexport id="attribution-source-debug-key">debug key</dfn>
    <dd data-md>
     <p>Null or a non-negative 64-bit integer.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution source" data-dfn-type="dfn" data-noexport id="attribution-source-aggregation-keys">aggregation keys</dfn>
    <dd data-md>
     <p>An <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map①">ordered map</a> whose <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-key" id="ref-for-map-key①">keys</a> are <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string⑥">strings</a> and whose <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-value" id="ref-for-map-value①">values</a> are
non-negative 128-bit integers.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution source" data-dfn-type="dfn" data-noexport id="attribution-source-aggregatable-expiry">aggregatable expiry</dfn>
    <dd data-md>
     <p>A length of time.</p>
   </dl>
   <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-level="5.6" data-lt="Aggregatable trigger data" data-noexport id="aggregatable-trigger-data"><span class="secno">5.6. </span><span class="content">Aggregatable trigger data</span><a class="self-link" href="#aggregatable-trigger-data" id="ref-for-aggregatable-trigger-data"></a></h3>
   <p>An aggregatable trigger data is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct" id="ref-for-struct②">struct</a> with the following items:</p>
   <dl>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="aggregatable trigger data" data-dfn-type="dfn" data-noexport id="aggregatable-trigger-data-key-piece">key piece</dfn>
    <dd data-md>
     <p>A non-negative 128-bit integer.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="aggregatable trigger data" data-dfn-type="dfn" data-noexport id="aggregatable-trigger-data-source-keys">source keys</dfn>
    <dd data-md>
     <p>An <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set③">ordered set</a> of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string⑦">strings</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="aggregatable trigger data" data-dfn-type="dfn" data-noexport id="aggregatable-trigger-data-filters">filters</dfn>
    <dd data-md>
     <p>A <a data-link-type="dfn" href="#filter-map" id="ref-for-filter-map①">filter map</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="aggregatable trigger data" data-dfn-type="dfn" data-noexport id="aggregatable-trigger-data-negated-filters">negated filters</dfn>
    <dd data-md>
     <p>A <a data-link-type="dfn" href="#filter-map" id="ref-for-filter-map②">filter map</a>.</p>
   </dl>
   <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-level="5.7" data-lt="Event-level trigger configuration" data-noexport id="event-level-trigger-configuration"><span class="secno">5.7. </span><span class="content">Event-level trigger configuration</span><a class="self-link" href="#event-level-trigger-configuration" id="ref-for-event-level-trigger-configuration"></a></h3>
   <p>An event-level trigger configuration is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct" id="ref-for-struct③">struct</a> with the following items:</p>
   <dl>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="event-level trigger configuration" data-dfn-type="dfn" data-noexport id="event-level-trigger-configuration-trigger-data">trigger data</dfn>
    <dd data-md>
     <p>A non-negative 64-bit integer.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="event-level trigger configuration" data-dfn-type="dfn" data-noexport id="event-level-trigger-configuration-dedup-key">dedup key</dfn>
    <dd data-md>
     <p>Null or a non-negative 64-bit integer.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="event-level trigger configuration" data-dfn-type="dfn" data-noexport id="event-level-trigger-configuration-priority">priority</dfn>
    <dd data-md>
     <p>A 64-bit integer.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="event-level trigger configuration" data-dfn-type="dfn" data-noexport id="event-level-trigger-configuration-filters">filters</dfn>
    <dd data-md>
     <p>A <a data-link-type="dfn" href="#filter-map" id="ref-for-filter-map③">filter map</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="event-level trigger configuration" data-dfn-type="dfn" data-noexport id="event-level-trigger-configuration-negated-filters">negated filters</dfn>
    <dd data-md>
     <p>A <a data-link-type="dfn" href="#filter-map" id="ref-for-filter-map④">filter map</a>.</p>
   </dl>
   <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-level="5.8" data-lt="Attribution trigger" data-noexport id="attribution-trigger"><span class="secno">5.8. </span><span class="content">Attribution trigger</span><a class="self-link" href="#attribution-trigger" id="ref-for-attribution-trigger①②"></a></h3>
   <p>An attribution trigger is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct" id="ref-for-struct④">struct</a> with the following items:</p>
   <dl>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution trigger" data-dfn-type="dfn" data-noexport id="attribution-trigger-attribution-destination">attribution destination</dfn>
    <dd data-md>
     <p>A <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#site" id="ref-for-site①">site</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution trigger" data-dfn-type="dfn" data-noexport id="attribution-trigger-trigger-time">trigger time</dfn>
    <dd data-md>
     <p>A point in time.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution trigger" data-dfn-type="dfn" data-noexport id="attribution-trigger-reporting-endpoint">reporting endpoint</dfn>
    <dd data-md>
     <p>An <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin②">origin</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution trigger" data-dfn-type="dfn" data-noexport id="attribution-trigger-filters">filters</dfn>
    <dd data-md>
     <p>A <a data-link-type="dfn" href="#filter-map" id="ref-for-filter-map⑤">filter map</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution trigger" data-dfn-type="dfn" data-noexport id="attribution-trigger-negated-filters">negated filters</dfn>
    <dd data-md>
     <p>A <a data-link-type="dfn" href="#filter-map" id="ref-for-filter-map⑥">filter map</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution trigger" data-dfn-type="dfn" data-noexport id="attribution-trigger-debug-key">debug key</dfn>
    <dd data-md>
     <p>Null or a non-negative 64-bit integer.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution trigger" data-dfn-type="dfn" data-noexport id="attribution-trigger-event-level-trigger-configurations">event-level trigger configurations</dfn>
    <dd data-md>
     <p>A <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set④">set</a> of <a data-link-type="dfn" href="#event-level-trigger-configuration" id="ref-for-event-level-trigger-configuration⑤">event-level trigger configuration</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution trigger" data-dfn-type="dfn" data-noexport id="attribution-trigger-aggregatable-trigger-data">aggregatable trigger data</dfn>
    <dd data-md>
     <p>A <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list">list</a> of <a data-link-type="dfn" href="#aggregatable-trigger-data" id="ref-for-aggregatable-trigger-data③">aggregatable trigger data</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution trigger" data-dfn-type="dfn" data-noexport id="attribution-trigger-aggregatable-values">aggregatable values</dfn>
    <dd data-md>
     <p>An <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map②">ordered map</a> whose <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-key" id="ref-for-map-key②">keys</a> are <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string⑧">strings</a> and whose <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-value" id="ref-for-map-value②">values</a> are non-negative 32-bit integers.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution trigger" data-dfn-type="dfn" data-noexport id="attribution-trigger-aggregatable-dedup-key">aggregatable dedup key</dfn>
    <dd data-md>
     <p>Null or a non-negative 64-bit integer.</p>
   </dl>
   <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-level="5.9" data-lt="Event-level report" data-noexport id="event-level-report"><span class="secno">5.9. </span><span class="content">Event-level report</span><a class="self-link" href="#event-level-report" id="ref-for-event-level-report①⑥"></a></h3>
   <p>An event-level report is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct" id="ref-for-struct⑤">struct</a> with the following items:</p>
   <dl>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="event-level report" data-dfn-type="dfn" data-noexport id="event-level-report-event-id">event ID</dfn>
    <dd data-md>
     <p>A non-negative 64-bit integer.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="event-level report" data-dfn-type="dfn" data-noexport id="event-level-report-source-type">source type</dfn>
    <dd data-md>
     <p>A <a data-link-type="dfn" href="#source-type" id="ref-for-source-type①">source type</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="event-level report" data-dfn-type="dfn" data-noexport id="event-level-report-trigger-data">trigger data</dfn>
    <dd data-md>
     <p>A non-negative 64-bit integer.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="event-level report" data-dfn-type="dfn" data-noexport id="event-level-report-randomized-trigger-rate">randomized trigger rate</dfn>
    <dd data-md>
     <p>A number between 0 and 1 (both inclusive).</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="event-level report" data-dfn-type="dfn" data-noexport id="event-level-report-reporting-endpoint">reporting endpoint</dfn>
    <dd data-md>
     <p>An <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin③">origin</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="event-level report" data-dfn-type="dfn" data-noexport id="event-level-report-attribution-destination">attribution destination</dfn>
    <dd data-md>
     <p>A <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#site" id="ref-for-site②">site</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="event-level report" data-dfn-type="dfn" data-noexport id="event-level-report-report-time">report time</dfn>
    <dd data-md>
     <p>A point in time.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="event-level report" data-dfn-type="dfn" data-noexport id="event-level-report-trigger-priority">trigger priority</dfn>
    <dd data-md>
     <p>A 64-bit integer.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="event-level report" data-dfn-type="dfn" data-noexport id="event-level-report-trigger-time">trigger time</dfn>
    <dd data-md>
     <p>A point in time.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="event-level report" data-dfn-type="dfn" data-noexport id="event-level-report-source-identifier">source identifier</dfn>
    <dd data-md>
     <p>A string.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="event-level report" data-dfn-type="dfn" data-noexport id="event-level-report-delivered">delivered</dfn> (default false)
    <dd data-md>
     <p>A <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#boolean" id="ref-for-boolean">boolean</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="event-level report" data-dfn-type="dfn" data-noexport id="event-level-report-report-id">report ID</dfn>
    <dd data-md>
     <p>A <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string⑨">string</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="event-level report" data-dfn-type="dfn" data-noexport id="event-level-report-source-debug-key">source debug key</dfn>
    <dd data-md>
     <p>Null or a non-negative 64-bit integer.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="event-level report" data-dfn-type="dfn" data-noexport id="event-level-report-trigger-debug-key">trigger debug key</dfn>
    <dd data-md>
     <p>Null or a non-negative 64-bit integer.</p>
   </dl>
   <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-level="5.10" data-lt="Aggregatable contribution" data-noexport id="aggregatable-contribution"><span class="secno">5.10. </span><span class="content">Aggregatable contribution</span><a class="self-link" href="#aggregatable-contribution" id="ref-for-aggregatable-contribution"></a></h3>
   <p>An aggregatable contribution is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct" id="ref-for-struct⑥">struct</a> with the following items:</p>
   <dl>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="aggregatable contribution" data-dfn-type="dfn" data-noexport id="aggregatable-contribution-key">key</dfn>
    <dd data-md>
     <p>A non-negative 128-bit integer.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="aggregatable contribution" data-dfn-type="dfn" data-noexport id="aggregatable-contribution-value">value</dfn>
    <dd data-md>
     <p>A non-negative 32-bit integer.</p>
   </dl>
   <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-level="5.11" data-lt="Attribution rate-limit record" data-noexport id="attribution-rate-limit-record"><span class="secno">5.11. </span><span class="content">Attribution rate-limit record</span><a class="self-link" href="#attribution-rate-limit-record" id="ref-for-attribution-rate-limit-record"></a></h3>
   <p>An attribution rate-limit record is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct" id="ref-for-struct⑦">struct</a> with the following items:</p>
   <dl>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution rate-limit record" data-dfn-type="dfn" data-noexport id="attribution-rate-limit-record-scope">scope</dfn>
    <dd data-md>
     <p>Either "<code>source</code>" or "<code>attribution</code>".</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution rate-limit record" data-dfn-type="dfn" data-noexport id="attribution-rate-limit-record-source-site">source site</dfn>
    <dd data-md>
     <p>A <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#site" id="ref-for-site③">site</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution rate-limit record" data-dfn-type="dfn" data-noexport id="attribution-rate-limit-record-attribution-destination">attribution destination</dfn>
    <dd data-md>
     <p>A <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#site" id="ref-for-site④">site</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution rate-limit record" data-dfn-type="dfn" data-noexport id="attribution-rate-limit-record-reporting-endpoint">reporting endpoint</dfn>
    <dd data-md>
     <p>An <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin④">origin</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution rate-limit record" data-dfn-type="dfn" data-noexport id="attribution-rate-limit-record-time">time</dfn>
    <dd data-md>
     <p>A point in time.</p>
   </dl>
   <h2 class="heading settled" data-level="6" id="storage"><span class="secno">6. </span><span class="content">Storage</span><a class="self-link" href="#storage"></a></h2>
   <p>A user agent holds an <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="attribution-source-cache">attribution source cache</dfn>, which is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set⑤">ordered set</a> of <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-source①①">attribution sources</a>.</p>
   <p>A user agent holds an <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="event-level-report-cache">event-level report cache</dfn>, which is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set⑥">ordered set</a> of <a data-link-type="dfn" href="#event-level-report" id="ref-for-event-level-report③">event-level reports</a>.</p>
   <p>A user agent holds an <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="attribution-rate-limit-cache">attribution rate-limit cache</dfn>, which is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set⑦">ordered set</a> of <a data-link-type="dfn" href="#attribution-rate-limit-record" id="ref-for-attribution-rate-limit-record⑥">attribution rate-limit records</a>.</p>
   <p>The above caches are collectively known as the <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="attribution-caches">attribution caches</dfn>. The <a data-link-type="dfn" href="#attribution-caches" id="ref-for-attribution-caches">attribution caches</a> are
shared among all <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object">environment settings objects</a>.</p>
   <p class="note" role="note"><span>Note:</span> This would ideally use <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-bottle" id="ref-for-storage-bottle">storage bottles</a> to provide access to the attribution caches.
However attribution data is inherently cross-site, and operations on storage would need to span across all storage bottle maps.</p>
   <h2 class="heading settled" data-level="7" id="vendor-specific-values"><span class="secno">7. </span><span class="content">Vendor-Specific Values</span><a class="self-link" href="#vendor-specific-values"></a></h2>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="source-event-id-cardinality">Source event ID cardinality</dfn> is a positive integer that controls the
maximum value that can be used as an <a data-link-type="dfn" href="#attribution-source-event-id" id="ref-for-attribution-source-event-id">event id</a>.</p>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="max-source-expiry">Max source expiry</dfn> is a positive length of time that controls the
maximum value that can be used as an <a data-link-type="dfn" href="#attribution-source-expiry" id="ref-for-attribution-source-expiry">expiry</a>. It must be
greater than or equal to 30 days.</p>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="max-entries-per-filter-map">Max entries per filter map</dfn> is a positive integer that controls the
maximum <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-size" id="ref-for-map-size">size</a> of a <a data-link-type="dfn" href="#filter-map" id="ref-for-filter-map⑦">filter map</a>.</p>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="max-values-per-filter-entry">Max values per filter entry</dfn> is a positive integer that
controls the maximum <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-size" id="ref-for-list-size">size</a> of a <a data-link-type="dfn" href="#filter-map" id="ref-for-filter-map⑧">filter map</a> entry.</p>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="max-aggregation-keys-per-attribution">Max aggregation keys per attribution</dfn> is a positive integer that
controls the maximum <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-size" id="ref-for-map-size①">size</a> of an <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-source①②">attribution source</a>'s <a data-link-type="dfn" href="#attribution-source-aggregation-keys" id="ref-for-attribution-source-aggregation-keys">aggregation keys</a>, the maximum <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-size" id="ref-for-list-size①">size</a> of an <a data-link-type="dfn" href="#aggregatable-trigger-data" id="ref-for-aggregatable-trigger-data①">aggregatable trigger data</a>'s <a data-link-type="dfn" href="#aggregatable-trigger-data-source-keys" id="ref-for-aggregatable-trigger-data-source-keys">source keys</a>,
and the maximum <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-size" id="ref-for-map-size②">size</a> of an <a data-link-type="dfn" href="#attribution-trigger" id="ref-for-attribution-trigger④">attribution trigger</a>'s <a data-link-type="dfn" href="#attribution-trigger-aggregatable-values" id="ref-for-attribution-trigger-aggregatable-values">aggregatable values</a>.</p>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="max-aggregatable-trigger-data-per-trigger">Max aggregatable trigger data per trigger</dfn> is a positive integer that
controls the maximum <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-size" id="ref-for-list-size②">size</a> of an <a data-link-type="dfn" href="#attribution-trigger" id="ref-for-attribution-trigger⑤">attribution trigger</a>'s <a data-link-type="dfn" href="#attribution-trigger-aggregatable-trigger-data" id="ref-for-attribution-trigger-aggregatable-trigger-data">aggregatable trigger data</a>.</p>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="max-pending-sources-per-source-origin">Max pending sources per source origin</dfn> is a positive integer that
controls how many <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-source①③">attribution sources</a> can be in the <a data-link-type="dfn" href="#attribution-source-cache" id="ref-for-attribution-source-cache">attribution source cache</a> per <a data-link-type="dfn" href="#attribution-source-source-origin" id="ref-for-attribution-source-source-origin">source origin</a>.</p>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="navigation-source-trigger-data-cardinality">Navigation-source trigger data cardinality</dfn> is a positive integer
that controls the valid range of <a data-link-type="dfn" href="#event-level-trigger-configuration-trigger-data" id="ref-for-event-level-trigger-configuration-trigger-data">trigger data</a> for triggers that are
attributed to an <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-source①④">attribution source</a> whose <a data-link-type="dfn" href="#attribution-source-source-type" id="ref-for-attribution-source-source-type">source type</a> is "<code>navigation</code>":
0 &lt;= <a data-link-type="dfn" href="#event-level-trigger-configuration-trigger-data" id="ref-for-event-level-trigger-configuration-trigger-data①">trigger data</a> &lt; <a data-link-type="dfn" href="#navigation-source-trigger-data-cardinality" id="ref-for-navigation-source-trigger-data-cardinality">navigation-source trigger data cardinality</a>.</p>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="event-source-trigger-data-cardinality">Event-source trigger data cardinality</dfn> is a positive integer that
controls the valid range of <a data-link-type="dfn" href="#event-level-trigger-configuration-trigger-data" id="ref-for-event-level-trigger-configuration-trigger-data②">trigger data</a> for triggers that are attributed to an <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-source①⑤">attribution source</a> whose <a data-link-type="dfn" href="#attribution-source-source-type" id="ref-for-attribution-source-source-type①">source type</a> is "<code>event</code>":
0 &lt;= <a data-link-type="dfn" href="#event-level-trigger-configuration-trigger-data" id="ref-for-event-level-trigger-configuration-trigger-data③">trigger data</a> &lt; <a data-link-type="dfn" href="#event-source-trigger-data-cardinality" id="ref-for-event-source-trigger-data-cardinality">event-source trigger data cardinality</a>.</p>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="randomized-navigation-source-trigger-rate">Randomized navigation-source trigger rate</dfn> is a double between 0 and
1 (both inclusive) that controls the randomized response probability of an <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-source①⑥">attribution source</a> whose <a data-link-type="dfn" href="#attribution-source-source-type" id="ref-for-attribution-source-source-type②">source type</a> is
"<code>navigation</code>".</p>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="randomized-event-source-trigger-rate">Randomized event-source trigger rate</dfn> is a double between 0 and 1
(both inclusive) that controls the randomized response probability of an <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-source①⑦">attribution source</a> whose <a data-link-type="dfn" href="#attribution-source-source-type" id="ref-for-attribution-source-source-type③">source type</a> is "<code>event</code>".</p>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="max-reports-per-attribution-destination">Max reports per attribution destination</dfn> is a positive integer that
controls how many <a data-link-type="dfn" href="#event-level-report" id="ref-for-event-level-report④">event-level reports</a> can be in the <a data-link-type="dfn" href="#event-level-report-cache" id="ref-for-event-level-report-cache">event-level report cache</a> per <a data-link-type="dfn" href="#event-level-report-attribution-destination" id="ref-for-event-level-report-attribution-destination">attribution destination</a>.</p>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="max-attributions-per-navigation-source">Max attributions per navigation source</dfn> is a positive integer that
controls how many times a single <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-source①⑧">attribution source</a> whose <a data-link-type="dfn" href="#attribution-source-source-type" id="ref-for-attribution-source-source-type④">source type</a> is "<code>navigation</code>" can create an <a data-link-type="dfn" href="#event-level-report" id="ref-for-event-level-report⑤">event-level report</a>.</p>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="max-attributions-per-event-source">Max attributions per event source</dfn> is a positive integer that
controls how many times a single <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-source①⑨">attribution source</a> whose <a data-link-type="dfn" href="#attribution-source-source-type" id="ref-for-attribution-source-source-type⑤">source type</a> is "<code>event</code>" can create an <a data-link-type="dfn" href="#event-level-report" id="ref-for-event-level-report⑥">event-level report</a>.</p>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="max-destinations-covered-by-pending-sources">Max destinations covered by pending sources</dfn> is a positive
integer that controls the maximum number of distinct <a data-link-type="dfn" href="#attribution-source-attribution-destination" id="ref-for-attribution-source-attribution-destination③">attribution destinations</a> for pending <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-source②⓪">attribution sources</a> with a given (<a data-link-type="dfn" href="#attribution-source-source-site" id="ref-for-attribution-source-source-site">source site</a>, <a data-link-type="dfn" href="#attribution-source-reporting-endpoint" id="ref-for-attribution-source-reporting-endpoint">reporting endpoint</a>).</p>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="attribution-rate-limit-window">Attribution rate-limit window</dfn> is a positive length of time that
controls the rate-limiting window for attribution.</p>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="max-source-reporting-endpoints-per-rate-limit-window">Max source reporting endpoints per rate-limit window</dfn> is a positive
integer that controls the maximum number of distinct <a data-link-type="dfn" href="#attribution-source-reporting-endpoint" id="ref-for-attribution-source-reporting-endpoint①">reporting endpoints</a> for a
(<a data-link-type="dfn" href="#attribution-rate-limit-record-source-site" id="ref-for-attribution-rate-limit-record-source-site">source site</a>, <a data-link-type="dfn" href="#attribution-rate-limit-record-attribution-destination" id="ref-for-attribution-rate-limit-record-attribution-destination">attribution destination</a>) that can create <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-source②①">attribution sources</a> per <a data-link-type="dfn" href="#attribution-rate-limit-window" id="ref-for-attribution-rate-limit-window">attribution rate-limit window</a>.</p>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="max-attribution-reporting-endpoints-per-rate-limit-window">Max attribution reporting endpoints per rate-limit window</dfn> is a
positive integer that controls the maximum number of distinct <a data-link-type="dfn" href="#attribution-trigger-reporting-endpoint" id="ref-for-attribution-trigger-reporting-endpoint">reporting endpoints</a> for a
(<a data-link-type="dfn" href="#attribution-rate-limit-record-source-site" id="ref-for-attribution-rate-limit-record-source-site①">source site</a>, <a data-link-type="dfn" href="#attribution-rate-limit-record-attribution-destination" id="ref-for-attribution-rate-limit-record-attribution-destination①">attribution destination</a>) that can create <a data-link-type="dfn" href="#event-level-report" id="ref-for-event-level-report⑦">event-level reports</a> per <a data-link-type="dfn" href="#attribution-rate-limit-window" id="ref-for-attribution-rate-limit-window①">attribution rate-limit window</a>.</p>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="max-attributions-per-rate-limit-window">Max attributions per rate-limit window</dfn> is a positive integer that
controls the maximum number of attributions for a
(<a data-link-type="dfn" href="#attribution-rate-limit-record-source-site" id="ref-for-attribution-rate-limit-record-source-site②">source site</a>, <a data-link-type="dfn" href="#attribution-rate-limit-record-attribution-destination" id="ref-for-attribution-rate-limit-record-attribution-destination②">attribution destination</a>, <a data-link-type="dfn" href="#attribution-rate-limit-record-reporting-endpoint" id="ref-for-attribution-rate-limit-record-reporting-endpoint">reporting endpoint</a>) per <a data-link-type="dfn" href="#attribution-rate-limit-window" id="ref-for-attribution-rate-limit-window②">attribution rate-limit window</a>.</p>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="max-source-cache-size">Max source cache size</dfn> is a positive integer that controls how many <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-source②②">attribution sources</a> can be in the <a data-link-type="dfn" href="#attribution-source-cache" id="ref-for-attribution-source-cache①">attribution source cache</a>.</p>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="max-report-cache-size">Max report cache size</dfn> is a positive integer that controls how many <a data-link-type="dfn" href="#event-level-report" id="ref-for-event-level-report⑧">event-level reports</a> can be in the <a data-link-type="dfn" href="#event-level-report-cache" id="ref-for-event-level-report-cache①">event-level report cache</a>.</p>
   <h2 class="heading settled" data-level="8" id="general-algorithms"><span class="secno">8. </span><span class="content">General Algorithms</span><a class="self-link" href="#general-algorithms"></a></h2>
   <h3 class="heading settled" data-level="8.1" id="parsing-filter-data"><span class="secno">8.1. </span><span class="content">Parsing filter data</span><a class="self-link" href="#parsing-filter-data"></a></h3>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="parse-filter-data">parse filter data</dfn> given a <var>value</var> and a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string①⓪">string</a> <dfn class="dfn-paneled" data-dfn-for="parse filter data" data-dfn-type="dfn" data-noexport id="parse-filter-data-registrationtype"><var>registrationType</var></dfn>:</p>
   <ol>
    <li data-md>
     <p class="assertion">Assert: <var>registrationType</var> is either "<code>source</code>" or "<code>trigger</code>".</p>
    <li data-md>
     <p>If <var>value</var> is not a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map③">map</a>, return null.</p>
    <li data-md>
     <p>If <var>registrationType</var> is "<code>source</code>" and <var>value</var>["<code>source_type</code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists">exists</a>, return null.</p>
    <li data-md>
     <p>If <var>value</var>’s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-size" id="ref-for-map-size③">size</a> is greater than the user agent’s <a data-link-type="dfn" href="#max-entries-per-filter-map" id="ref-for-max-entries-per-filter-map">max entries per filter map</a>, return null.</p>
    <li data-md>
     <p>Let <var>result</var> be a new <a data-link-type="dfn" href="#filter-map" id="ref-for-filter-map⑨">filter map</a>.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-iterate" id="ref-for-map-iterate">For each</a> <var>filter</var> → <var>data</var> of <var>value</var>:</p>
     <ol>
      <li data-md>
       <p>If <var>data</var> is not a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list①">list</a>, return null.</p>
      <li data-md>
       <p>Let <var>set</var> be a new <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set⑧">ordered set</a>.</p>
      <li data-md>
       <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate" id="ref-for-list-iterate">For each</a> <var>d</var> of <var>data</var>:</p>
       <ol>
        <li data-md>
         <p>If <var>d</var> is not a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string①①">string</a>, return null.</p>
        <li data-md>
         <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#set-append" id="ref-for-set-append">Append</a> <var>d</var> to <var>set</var>.</p>
       </ol>
      <li data-md>
       <p>If <var>set</var>’s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-size" id="ref-for-list-size③">size</a> is greater than the user agent’s <a data-link-type="dfn" href="#max-values-per-filter-entry" id="ref-for-max-values-per-filter-entry">max values per filter entry</a>, return null.</p>
      <li data-md>
       <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-set" id="ref-for-map-set">Set</a> <var>result</var>[<var>filter</var>] to <var>set</var>.</p>
     </ol>
    <li data-md>
     <p>Return <var>result</var>.</p>
   </ol>
   <p class="issue" id="issue-5c232164"><a class="self-link" href="#issue-5c232164"></a> Determine whether to limit <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string-length" id="ref-for-string-length">length</a> or <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string-code-point-length" id="ref-for-string-code-point-length">code point length</a> for <var>filter</var> and <var>d</var> above.</p>
   <h3 class="heading settled" data-level="8.2" id="debug-keys"><span class="secno">8.2. </span><span class="content">Debug keys</span><a class="self-link" href="#debug-keys"></a></h3>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="check-if-a-debug-key-is-allowed">check if a debug key is allowed</dfn> given an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin" id="ref-for-concept-origin">origin</a> <var>reportingOrigin</var>:</p>
   <ol>
    <li data-md>
     <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert">Assert</a>: <var>reportingOrigin</var> is a <a data-link-type="dfn" href="https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-origin" id="ref-for-potentially-trustworthy-origin">potentially trustworthy origin</a>.</p>
    <li data-md>
     <p>Return <strong>blocked</strong>.</p>
   </ol>
   <p class="issue" id="issue-001a5052"><a class="self-link" href="#issue-001a5052"></a> Check for "<code>ar_debug</code>" cookie on <var>reportingOrigin</var> and return <strong>allowed</strong> if it exists, is <code>Secure</code>, is <code>HttpOnly</code>, and is <code>SameSite=None</code>.</p>
   <h3 class="heading settled" data-level="8.3" id="obtaining-randomized-response"><span class="secno">8.3. </span><span class="content">Obtaining a randomized response</span><a class="self-link" href="#obtaining-randomized-response"></a></h3>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="obtain-a-randomized-response">obtain a randomized response</dfn> given <var>trueValue</var>, a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set⑨">set</a> <var>possibleValues</var>, and a
double <var>randomPickRate</var>:</p>
   <ol>
    <li data-md>
     <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert①">Assert</a>: <var>randomPickRate</var> is between 0 and 1 (both inclusive).</p>
    <li data-md>
     <p>Let <var>r</var> be a random double between 0 (inclusive) and 1 (exclusive) with uniform probability.</p>
    <li data-md>
     <p>If <var>r</var> is less than <var>randomPickRate</var>, return a random item from <var>possibleValues</var> with uniform
probability.</p>
    <li data-md>
     <p>Otherwise, return <var>trueValue</var>.</p>
   </ol>
   <h3 class="heading settled algorithm" data-algorithm="Parsing aggregation key piece" data-level="8.4" id="parsing-aggregation-key-piece"><span class="secno">8.4. </span><span class="content">Parsing aggregation key piece</span><a class="self-link" href="#parsing-aggregation-key-piece"></a></h3>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="parse-an-aggregation-key-piece">parse an aggregation key piece</dfn> given a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string①②">string</a> <var>input</var>, perform the following steps.
This algorithm will return either a non-negative 128-bit integer or an error.</p>
   <ol>
    <li data-md>
     <p>If <var>input</var>’s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string-code-point-length" id="ref-for-string-code-point-length①">code point length</a> is not between 3 and 34 (both inclusive), return an error.</p>
    <li data-md>
     <p>If the first character is not a U+0030 DIGIT ZERO (0), return an error.</p>
    <li data-md>
     <p>If the second character is not a U+0058 LATIN CAPITAL LETTER X character (X) and not a
U+0078 LATIN SMALL LETTER X character (x), return an error.</p>
    <li data-md>
     <p>Let <var>value</var> be the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#code-point-substring" id="ref-for-code-point-substring">code point substring</a> from 2 to the end of <var>input</var>.</p>
    <li data-md>
     <p>If the characters within <var>value</var> are not all <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-hex-digit" id="ref-for-ascii-hex-digit">ASCII hex digits</a>, return an error.</p>
    <li data-md>
     <p>Interpret <var>value</var> as a hexadecimal number and return as a non-negative 128-bit integer.</p>
   </ol>
   <h2 class="heading settled" data-level="9" id="source-algorithms"><span class="secno">9. </span><span class="content">Source Algorithms</span><a class="self-link" href="#source-algorithms"></a></h2>
   <h3 class="heading settled" data-level="9.1" id="obtaining-attribution-source-expiry-time"><span class="secno">9.1. </span><span class="content">Obtaining an attribution source’s expiry time</span><a class="self-link" href="#obtaining-attribution-source-expiry-time"></a></h3>
   <p>An <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-source②③">attribution source</a> <var>source</var>’s <dfn class="dfn-paneled" data-dfn-for="attribution source" data-dfn-type="dfn" data-noexport id="attribution-source-expiry-time">expiry time</dfn> is <var>source</var>’s <a data-link-type="dfn" href="#attribution-source-source-time" id="ref-for-attribution-source-source-time">source time</a> + <var>source</var>’s <a data-link-type="dfn" href="#attribution-source-expiry" id="ref-for-attribution-source-expiry①">expiry</a>.</p>
   <h3 class="heading settled" data-level="9.2" id="obtaining-attribution-source-site"><span class="secno">9.2. </span><span class="content">Obtaining an attribution source’s source site</span><a class="self-link" href="#obtaining-attribution-source-site"></a></h3>
   <p>An <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-source②④">attribution source</a> <var>source</var>’s <dfn class="dfn-paneled" data-dfn-for="attribution source" data-dfn-type="dfn" data-noexport id="attribution-source-source-site">source site</dfn> is the result
of <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#obtain-a-site" id="ref-for-obtain-a-site">obtaining a site</a> from <var>source</var>’s <a data-link-type="dfn" href="#attribution-source-source-origin" id="ref-for-attribution-source-source-origin①">source origin</a>.</p>
   <h3 class="heading settled algorithm" data-algorithm="Parsing an attribution destination" data-level="9.3" id="parsing-attribution-destination"><span class="secno">9.3. </span><span class="content">Parsing an attribution destination</span><a class="self-link" href="#parsing-attribution-destination"></a></h3>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="parse-an-attribution-destination">parse an attribution destination</dfn> from a string <var>str</var>:</p>
   <ol>
    <li data-md>
     <p>Let <var>url</var> be the result of running the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-parser" id="ref-for-concept-url-parser">URL parser</a> on the value of
the <var>str</var>.</p>
    <li data-md>
     <p>If <var>url</var> is failure or null, return null.</p>
    <li data-md>
     <p>If <var>url</var>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin⑤">origin</a> is not a <a data-link-type="dfn" href="https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-origin" id="ref-for-potentially-trustworthy-origin①">potentially trustworthy origin</a>,
return null.</p>
    <li data-md>
     <p>Return the result of <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#obtain-a-site" id="ref-for-obtain-a-site①">obtaining a site</a> from <var>url</var>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin⑥">origin</a>.</p>
   </ol>
   <h3 class="heading settled algorithm" data-algorithm="Obtaining a randomized source response" data-level="9.4" id="obtaining-randomized-source-response"><span class="secno">9.4. </span><span class="content">Obtaining a randomized source response</span><a class="self-link" href="#obtaining-randomized-source-response"></a></h3>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="obtain-a-randomized-source-response">obtain a randomized source response</dfn> given a positive integer <var>triggerDataCardinality</var>, a positive integer <var>maxAttributionsPerSource</var>, a positive integer <var>numReportWindows</var>, and a double <var>randomPickRate</var>:</p>
   <ol>
    <li data-md>
     <p>Let <var>possibleTriggerStates</var> be a new <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-is-empty" id="ref-for-list-is-empty">empty</a> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set①⓪">set</a>.</p>
    <li data-md>
     <p>For each integer <var>triggerData</var> between 0 (inclusive) and <var>triggerDataCardinality</var> (exclusive):</p>
     <ol>
      <li data-md>
       <p>For each integer <var>reportWindow</var> between 0 (inclusive) and <var>numReportWindows</var> (exclusive):</p>
       <ol>
        <li data-md>
         <p>Let <var>state</var> be a new <a data-link-type="dfn" href="#trigger-state" id="ref-for-trigger-state①">trigger state</a> with the items:</p>
         <dl>
          <dt data-md><a data-link-type="dfn" href="#trigger-state-trigger-data" id="ref-for-trigger-state-trigger-data">trigger data</a>
          <dd data-md>
           <p><var>triggerData</var></p>
          <dt data-md><a data-link-type="dfn" href="#trigger-state-report-window" id="ref-for-trigger-state-report-window">report window</a>
          <dd data-md>
           <p><var>reportWindow</var></p>
         </dl>
        <li data-md>
         <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#set-append" id="ref-for-set-append①">Append</a> <var>state</var> to <var>possibleTriggerStates</var>.</p>
       </ol>
     </ol>
    <li data-md>
     <p>Let <var>possibleValues</var> be a new <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-is-empty" id="ref-for-list-is-empty①">empty</a> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set①①">set</a>.</p>
    <li data-md>
     <p>For each integer <var>attributions</var> between 0 (inclusive) and <var>maxAttributionsPerSource</var> (inclusive):</p>
     <ol>
      <li data-md>
       <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#set-append" id="ref-for-set-append②">Append</a> to <var>possibleValues</var> all distinct <var>attributions</var>-length combinations of <var>possibleTriggerStates</var>.</p>
     </ol>
    <li data-md>
     <p>Return the result of <a data-link-type="dfn" href="#obtain-a-randomized-response" id="ref-for-obtain-a-randomized-response">obtaining a randomized response</a> with null, <var>possibleValues</var>, and <var>randomPickRate</var>.</p>
   </ol>
   <h3 class="heading settled algorithm" data-algorithm="Obtaining an attribution source from an a element" data-level="9.5" id="obtaining-attribution-source-anchor"><span class="secno">9.5. </span><span class="content">Obtaining an attribution source from an <code>a</code> element</span><a class="self-link" href="#obtaining-attribution-source-anchor"></a></h3>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="obtain-an-attribution-source-from-an-anchor">obtain an attribution source from an anchor</dfn> given an <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-a-element" id="ref-for-the-a-element⑤">a</a></code> element <var>anchor</var>:</p>
   <ol>
    <li data-md>
     <p>If <var>anchor</var> does not have an <code><a data-link-type="element-sub" href="#element-attrdef-a-attributionsrc" id="ref-for-element-attrdef-a-attributionsrc">attributionsrc</a></code> attribute, return null.</p>
    <li data-md>
     <p>Return null.</p>
   </ol>
   <p class="issue" id="issue-45c98580"><a class="self-link" href="#issue-45c98580"></a> Specify the steps for making attributionsrc request.</p>
   <h3 class="heading settled algorithm" data-algorithm="Obtaining an attribution source from window features" data-level="9.6" id="obtaining-attribution-source-window-features"><span class="secno">9.6. </span><span class="content">Obtaining an attribution source from window features</span><a class="self-link" href="#obtaining-attribution-source-window-features"></a></h3>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="obtain-an-attribution-source-from-window-features">obtain an attribution source from window features</dfn> given an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map④">ordered map</a> <var>tokenizedFeatures</var> and a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context" id="ref-for-browsing-context">browsing context</a> <var>sourceBrowsingContext</var>:</p>
   <ol>
    <li data-md>
     <p>If <var>tokenizedFeatures</var>["attributionsrc"] does not <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists①">exist</a>, return null.</p>
    <li data-md>
     <p>If <var>sourceBrowsingContext</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#active-window" id="ref-for-active-window">active window</a> does not have <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/interaction.html#transient-activation" id="ref-for-transient-activation">transient activation</a>, return null.</p>
    <li data-md>
     <p>Let <var>decodedSrcBytes</var> be the result of <a data-link-type="dfn" href="https://url.spec.whatwg.org/#string-percent-decode" id="ref-for-string-percent-decode">percent-decoding</a> <var>tokenizedFeatures</var>["attributionsrc"].</p>
    <li data-md>
     <p>Let <var>decodedSrc</var> be the <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#utf-8-decode-without-bom" id="ref-for-utf-8-decode-without-bom">UTF-8 decode without BOM</a> of <var>decodedSrcBytes</var>.</p>
    <li data-md>
     <p>Return null.</p>
   </ol>
   <p class="issue" id="issue-1f7755b7"><a class="self-link" href="#issue-1f7755b7"></a> Specify the steps for making an attributionsrc request with <var>decodedSrc</var>.</p>
   <h3 class="heading settled algorithm" data-algorithm="Parsing source-registration JSON" data-level="9.7" id="parsing-source-registration"><span class="secno">9.7. </span><span class="content">Parsing source-registration JSON</span><a class="self-link" href="#parsing-source-registration"></a></h3>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="obtain-a-source-expiry">obtain a source expiry</dfn> given a <var>value</var>:</p>
   <ol>
    <li data-md>
     <p>If <var>value</var> is not a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string①③">string</a>, return null.</p>
    <li data-md>
     <p>Let <var>expirySeconds</var> be the result of applying the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/common-microsyntaxes.html#rules-for-parsing-integers" id="ref-for-rules-for-parsing-integers">rules for parsing integers</a> to <var>value</var>.</p>
    <li data-md>
     <p>If <var>expirySeconds</var> is an error, return null.</p>
    <li data-md>
     <p>Let <var>expiry</var> be <var>expirySeconds</var> seconds.</p>
    <li data-md>
     <p>If <var>expiry</var> is less than 1 day, set <var>expiry</var> to 1 day.</p>
    <li data-md>
     <p>If <var>expiry</var> is greater than the user agent’s <a data-link-type="dfn" href="#max-source-expiry" id="ref-for-max-source-expiry">max source expiry</a>, set <var>expiry</var> to that value.</p>
    <li data-md>
     <p>Return <var>expiry</var>.</p>
   </ol>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="parse-aggregation-keys">parse aggregation keys</dfn> given an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map⑤">ordered map</a> <var>map</var>:</p>
   <ol>
    <li data-md>
     <p>Let <var>aggregationKeys</var> be a new <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map⑥">ordered map</a>.</p>
    <li data-md>
     <p>If <var>map</var>["<code>aggregation_keys</code>"] does not <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists②">exist</a>, return <var>aggregationKeys</var>.</p>
    <li data-md>
     <p>Let <var>values</var> be <var>map</var>["<code>aggregation_keys</code>"].</p>
    <li data-md>
     <p>If <var>values</var> is not an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map⑦">ordered map</a>, return null.</p>
    <li data-md>
     <p>If <var>values</var>’s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-size" id="ref-for-map-size④">size</a> is greater than the user agent’s <a data-link-type="dfn" href="#max-aggregation-keys-per-attribution" id="ref-for-max-aggregation-keys-per-attribution">max aggregation keys per attribution</a>, return null.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-iterate" id="ref-for-map-iterate①">For each</a> <var>key</var> → <var>value</var> of <var>values</var>:</p>
     <ol>
      <li data-md>
       <p>If <var>value</var> is not a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string①④">string</a>, return null.</p>
      <li data-md>
       <p>Let <var>keyPiece</var> be the result of running <a data-link-type="dfn" href="#parse-an-aggregation-key-piece" id="ref-for-parse-an-aggregation-key-piece">parse an aggregation key piece</a> with <var>value</var>.</p>
      <li data-md>
       <p>If <var>keyPiece</var> is an error, return null.</p>
      <li data-md>
       <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-set" id="ref-for-map-set①">Set</a> <var>aggregationKeys</var>[<var>key</var>] to <var>keyPiece</var>.</p>
     </ol>
    <li data-md>
     <p>Return <var>aggregationKeys</var>.</p>
   </ol>
   <p>To <dfn data-dfn-type="dfn" data-noexport id="parse-source-registration-json">parse source-registration JSON<a class="self-link" href="#parse-source-registration-json"></a></dfn> given a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string①⑤">string</a> <var>json</var>, an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin" id="ref-for-concept-origin①">origin</a> <var>sourceOrigin</var>, an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin" id="ref-for-concept-origin②">origin</a> <var>reportingOrigin</var>, and a <a data-link-type="dfn" href="#source-type" id="ref-for-source-type②">source type</a> <var>sourceType</var>:</p>
   <ol>
    <li data-md>
     <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert②">Assert</a>: <var>sourceOrigin</var> is a <a data-link-type="dfn" href="https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-origin" id="ref-for-potentially-trustworthy-origin②">potentially trustworthy origin</a>.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert③">Assert</a>: <var>reportingOrigin</var> is a <a data-link-type="dfn" href="https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-origin" id="ref-for-potentially-trustworthy-origin③">potentially trustworthy origin</a>.</p>
    <li data-md>
     <p>Let <var>value</var> be the result of running <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#parse-a-json-string-to-an-infra-value" id="ref-for-parse-a-json-string-to-an-infra-value">parse a JSON string to an Infra value</a> with <var>json</var>.</p>
    <li data-md>
     <p>If <var>value</var> is not an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map⑧">ordered map</a>, return null.</p>
    <li data-md>
     <p>Let <var>sourceEventId</var> be 0.</p>
    <li data-md>
     <p>If <var>value</var>["<code>source_event_id</code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists③">exists</a> and is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string①⑥">string</a>:</p>
     <ol>
      <li data-md>
       <p>Set <var>sourceEventId</var> to the result of applying the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/common-microsyntaxes.html#rules-for-parsing-non-negative-integers" id="ref-for-rules-for-parsing-non-negative-integers">rules for parsing non-negative integers</a> to <var>value</var>["<code>source_event_id</code>"] modulo the user agent’s <a data-link-type="dfn" href="#source-event-id-cardinality" id="ref-for-source-event-id-cardinality">source event ID cardinality</a>.</p>
      <li data-md>
       <p>If <var>sourceEventId</var> is an error, set <var>sourceEventId</var> to 0.</p>
     </ol>
    <li data-md>
     <p>If <var>value</var>["<code>destination</code>"] does not <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists④">exist</a> or is not a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string①⑦">string</a>, return null.</p>
    <li data-md>
     <p>Let <var>attributionDestination</var> be the result of running <a data-link-type="dfn" href="#parse-an-attribution-destination" id="ref-for-parse-an-attribution-destination">parse an attribution destination</a> with <var>value</var>["<code>destination</code>"].</p>
    <li data-md>
     <p>If <var>attributionDestination</var> is null, return null.</p>
    <li data-md>
     <p>Let <var>expiry</var> be the result of running <a data-link-type="dfn" href="#obtain-a-source-expiry" id="ref-for-obtain-a-source-expiry">obtain a source expiry</a> on <var>value</var>["<code>expiry</code>"].</p>
    <li data-md>
     <p>If <var>expiry</var> is null, set <var>expiry</var> to 30 days.</p>
    <li data-md>
     <p>Let <var>priority</var> be 0.</p>
    <li data-md>
     <p>If <var>value</var>["<code>priority</code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists⑤">exists</a> and is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string①⑧">string</a>:</p>
     <ol>
      <li data-md>
       <p>Set <var>priority</var> to the result of applying the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/common-microsyntaxes.html#rules-for-parsing-integers" id="ref-for-rules-for-parsing-integers①">rules for parsing integers</a> to <var>value</var>["<code>priority</code>"].</p>
      <li data-md>
       <p>If <var>priority</var> is an error, set <var>priority</var> to 0.</p>
     </ol>
    <li data-md>
     <p>Let <var>filterData</var> be a new <a data-link-type="dfn" href="#filter-map" id="ref-for-filter-map①⓪">filter map</a>.</p>
    <li data-md>
     <p>If <var>value</var>["<code>filter_data</code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists⑥">exists</a>:</p>
     <ol>
      <li data-md>
       <p>Set <var>filterData</var> to the result of running <a data-link-type="dfn" href="#parse-filter-data" id="ref-for-parse-filter-data">parse filter data</a> with <var>value</var>["<code>filter_data</code>"] and <a data-link-type="dfn" href="#parse-filter-data-registrationtype" id="ref-for-parse-filter-data-registrationtype">registrationType</a> set
to "<code>source</code>".</p>
      <li data-md>
       <p>If <var>filterData</var> is null, return null.</p>
     </ol>
    <li data-md>
     <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-set" id="ref-for-map-set②">Set</a> <var>filterData</var>["<code>source_type</code>"] to « <var>sourceType</var> ».</p>
    <li data-md>
     <p>Let <var>debugKey</var> be null.</p>
    <li data-md>
     <p>If <var>value</var>["<code>debug_key</code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists⑦">exists</a> and is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string①⑨">string</a>:</p>
     <ol>
      <li data-md>
       <p>Set <var>debugKey</var> to the result of applying the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/common-microsyntaxes.html#rules-for-parsing-non-negative-integers" id="ref-for-rules-for-parsing-non-negative-integers①">rules for parsing non-negative integers</a> to <var>value</var>["<code>debug_key</code>"].</p>
      <li data-md>
       <p>If <var>debugKey</var> is an error, set <var>debugKey</var> to null.</p>
      <li data-md>
       <p>If the result of running <a data-link-type="dfn" href="#check-if-a-debug-key-is-allowed" id="ref-for-check-if-a-debug-key-is-allowed">check if a debug key is allowed</a> with <var>reportingOrigin</var> is <strong>blocked</strong>, set <var>debugKey</var> to null.</p>
     </ol>
    <li data-md>
     <p>Let <var>aggregationKeys</var> be the result of running <a data-link-type="dfn" href="#parse-aggregation-keys" id="ref-for-parse-aggregation-keys">parse aggregation keys</a> with <var>value</var>.</p>
    <li data-md>
     <p>If <var>aggregationKeys</var> is null, return null.</p>
    <li data-md>
     <p>Let <var>aggregatableExpiry</var> be the result of running <a data-link-type="dfn" href="#obtain-a-source-expiry" id="ref-for-obtain-a-source-expiry①">obtain a source expiry</a> on <var>value</var>["<code>aggregatable_expiry</code>"].</p>
    <li data-md>
     <p>If <var>aggregatableExpiry</var> is null, set <var>aggregatableExpiry</var> to <var>expiry</var>.</p>
    <li data-md>
     <p>Let <var>triggerDataCardinality</var> be the user agent’s <a data-link-type="dfn" href="#navigation-source-trigger-data-cardinality" id="ref-for-navigation-source-trigger-data-cardinality①">navigation-source trigger data cardinality</a>.</p>
    <li data-md>
     <p>Let <var>randomizedTriggerRate</var> be the user agent’s <a data-link-type="dfn" href="#randomized-navigation-source-trigger-rate" id="ref-for-randomized-navigation-source-trigger-rate">randomized navigation-source trigger rate</a>.</p>
    <li data-md>
     <p>Let <var>maxAttributionsPerSource</var> be the user agent’s <a data-link-type="dfn" href="#max-attributions-per-navigation-source" id="ref-for-max-attributions-per-navigation-source">max attributions per navigation source</a>.</p>
    <li data-md>
     <p>If <var>sourceType</var> is "<code>event</code>":</p>
     <ol>
      <li data-md>
       <p>Round <var>expiry</var> away from zero to the nearest day (86400 seconds).</p>
      <li data-md>
       <p>Set <var>triggerDataCardinality</var> to the user agent’s <a data-link-type="dfn" href="#event-source-trigger-data-cardinality" id="ref-for-event-source-trigger-data-cardinality①">event-source trigger data cardinality</a>.</p>
      <li data-md>
       <p>Set <var>randomizedTriggerRate</var>’s to the user agent’s <a data-link-type="dfn" href="#randomized-event-source-trigger-rate" id="ref-for-randomized-event-source-trigger-rate">randomized event-source trigger rate</a>.</p>
      <li data-md>
       <p>Set <var>maxAttributionsPerSource</var> to the user agent’s <a data-link-type="dfn" href="#max-attributions-per-event-source" id="ref-for-max-attributions-per-event-source">max attributions per event source</a>.</p>
     </ol>
    <li data-md>
     <p>Let <var>numReportWindows</var> be the result of running <a data-link-type="dfn" href="#obtain-the-number-of-report-windows" id="ref-for-obtain-the-number-of-report-windows">obtain the number of report windows</a> with <var>sourceType</var>.</p>
    <li data-md>
     <p>Let <var>source</var> be a new <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-source②⑤">attribution source</a> struct whose items are:</p>
     <dl>
      <dt data-md><a data-link-type="dfn" href="#attribution-source-source-identifier" id="ref-for-attribution-source-source-identifier">source identifier</a>
      <dd data-md>
       <p>A new unique <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string②⓪">string</a></p>
      <dt data-md><a data-link-type="dfn" href="#attribution-source-source-origin" id="ref-for-attribution-source-source-origin②">source origin</a>
      <dd data-md>
       <p><var>sourceOrigin</var></p>
      <dt data-md><a data-link-type="dfn" href="#attribution-source-event-id" id="ref-for-attribution-source-event-id①">event ID</a>
      <dd data-md>
       <p><var>sourceEventId</var></p>
      <dt data-md><a data-link-type="dfn" href="#attribution-source-attribution-destination" id="ref-for-attribution-source-attribution-destination④">attribution destination</a>
      <dd data-md>
       <p><var>attributionDestination</var></p>
      <dt data-md><a data-link-type="dfn" href="#attribution-source-reporting-endpoint" id="ref-for-attribution-source-reporting-endpoint②">reporting endpoint</a>
      <dd data-md>
       <p><var>reportingOrigin</var></p>
      <dt data-md><a data-link-type="dfn" href="#attribution-source-expiry" id="ref-for-attribution-source-expiry②">expiry</a>
      <dd data-md>
       <p><var>expiry</var></p>
      <dt data-md><a data-link-type="dfn" href="#attribution-source-priority" id="ref-for-attribution-source-priority">priority</a>
      <dd data-md>
       <p><var>priority</var></p>
      <dt data-md><a data-link-type="dfn" href="#attribution-source-source-time" id="ref-for-attribution-source-source-time①">source time</a>
      <dd data-md>
       <p>The current time</p>
      <dt data-md><a data-link-type="dfn" href="#attribution-source-source-type" id="ref-for-attribution-source-source-type⑥">source type</a>
      <dd data-md>
       <p><var>sourceType</var></p>
      <dt data-md><a data-link-type="dfn" href="#attribution-source-randomized-response" id="ref-for-attribution-source-randomized-response">randomized response</a>
      <dd data-md>
       <p>The result of <a data-link-type="dfn" href="#obtain-a-randomized-source-response" id="ref-for-obtain-a-randomized-source-response">obtaining a randomized source response</a> with <var>triggerDataCardinality</var>, <var>maxAttributionsPerSource</var>, <var>numReportWindows</var>, and <var>randomizedTriggerRate</var>.</p>
      <dt data-md><a data-link-type="dfn" href="#attribution-source-randomized-trigger-rate" id="ref-for-attribution-source-randomized-trigger-rate">randomized trigger rate</a>
      <dd data-md>
       <p><var>randomizedTriggerRate</var></p>
      <dt data-md><a data-link-type="dfn" href="#attribution-source-filter-data" id="ref-for-attribution-source-filter-data">filter data</a>
      <dd data-md>
       <p><var>filterData</var></p>
      <dt data-md><a data-link-type="dfn" href="#attribution-source-debug-key" id="ref-for-attribution-source-debug-key">debug key</a>
      <dd data-md>
       <p><var>debugKey</var></p>
      <dt data-md><a data-link-type="dfn" href="#attribution-source-aggregation-keys" id="ref-for-attribution-source-aggregation-keys①">aggregation keys</a>
      <dd data-md>
       <p><var>aggregationKeys</var></p>
      <dt data-md><a data-link-type="dfn" href="#attribution-source-aggregatable-expiry" id="ref-for-attribution-source-aggregatable-expiry">aggregatable expiry</a>
      <dd data-md>
       <p><var>aggregatableExpiry</var></p>
     </dl>
    <li data-md>
     <p>Return <var>source</var>.</p>
   </ol>
   <p class="issue" id="issue-e0364022"><a class="self-link" href="#issue-e0364022"></a> Ensure that <var>attributionDestination</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin-scheme" id="ref-for-concept-origin-scheme">scheme</a> is HTTP/HTTPS.</p>
   <h3 class="heading settled" data-level="9.8" id="check-pending-destination-limit"><span class="secno">9.8. </span><span class="content">Checking pending destination limit</span><a class="self-link" href="#check-pending-destination-limit"></a></h3>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="check-if-an-attribution-source-exceeds-the-pending-destination-limit">check if an <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-source②⑥">attribution source</a> exceeds the pending destination limit</dfn> given an <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-source②⑦">attribution source</a> <var>source</var>, run the following steps:</p>
   <ol>
    <li data-md>
     <p>Let <var>pendingSources</var> be all entries in the <a data-link-type="dfn" href="#attribution-source-cache" id="ref-for-attribution-source-cache②">attribution source cache</a> where all of the following are true:</p>
     <ul>
      <li data-md>
       <p>entry’s <a data-link-type="dfn" href="#attribution-source-source-site" id="ref-for-attribution-source-source-site①">source site</a> and <var>source</var>’s <a data-link-type="dfn" href="#attribution-source-source-site" id="ref-for-attribution-source-source-site②">source site</a> are equal.</p>
      <li data-md>
       <p>entry’s <a data-link-type="dfn" href="#attribution-source-reporting-endpoint" id="ref-for-attribution-source-reporting-endpoint③">reporting endpoint</a> and <var>source</var>’s <a data-link-type="dfn" href="#attribution-source-reporting-endpoint" id="ref-for-attribution-source-reporting-endpoint④">reporting endpoint</a> are <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#same-origin" id="ref-for-same-origin">same origin</a>.</p>
      <li data-md>
       <p>entry’s <a data-link-type="dfn" href="#attribution-source-number-of-event-level-reports" id="ref-for-attribution-source-number-of-event-level-reports">number of event-level reports</a> is equal to 0.</p>
     </ul>
    <li data-md>
     <p>Let <var>distinctDestinations</var> be a new <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-is-empty" id="ref-for-list-is-empty②">empty</a> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set①②">set</a>.</p>
    <li data-md>
     <p>For each <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-source②⑧">attribution source</a> <var>pendingSource</var> of <var>pendingSources</var>:</p>
     <ol>
      <li data-md>
       <p>If <var>source</var>’s <a data-link-type="dfn" href="#attribution-source-attribution-destination" id="ref-for-attribution-source-attribution-destination⑤">attribution destination</a> and <var>pendingSource</var>’s <a data-link-type="dfn" href="#attribution-source-attribution-destination" id="ref-for-attribution-source-attribution-destination⑥">attribution destination</a> are equal, then return false.</p>
      <li data-md>
       <p>If <var>distinctDestinations</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-contain" id="ref-for-list-contain">contains</a> <var>pendingSource</var>’s <a data-link-type="dfn" href="#attribution-source-attribution-destination" id="ref-for-attribution-source-attribution-destination⑦">attribution destination</a>, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#iteration-continue" id="ref-for-iteration-continue">continue</a>.</p>
      <li data-md>
       <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#set-append" id="ref-for-set-append③">Append</a> <var>pendingSource</var>’s <a data-link-type="dfn" href="#attribution-source-attribution-destination" id="ref-for-attribution-source-attribution-destination⑧">attribution destination</a> to <var>distinctDestinations</var>.</p>
     </ol>
    <li data-md>
     <p>If <var>distinctDestinations</var>’s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-size" id="ref-for-list-size④">size</a> is greater than or equal to
the user agent’s <a data-link-type="dfn" href="#max-destinations-covered-by-pending-sources" id="ref-for-max-destinations-covered-by-pending-sources">max destinations covered by pending sources</a>, then return true.</p>
    <li data-md>
     <p>Return false.</p>
   </ol>
   <p class="issue" id="issue-1ffadd57"><a class="self-link" href="#issue-1ffadd57"></a> Determine whether to change this limit to be time boudned, see <a href="https://github.com/WICG/attribution-reporting-api/issues/482">Source event limits should be time bounded</a>.</p>
   <h3 class="heading settled" data-level="9.9" id="processing-an-attribution-source"><span class="secno">9.9. </span><span class="content">Processing an attribution source</span><a class="self-link" href="#processing-an-attribution-source"></a></h3>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="maybe-process-a-navigation-attribution-source">maybe process a navigation attribution source</dfn> given a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params" id="ref-for-navigation-params①">navigation params</a> <var>navigationParams</var> and <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context" id="ref-for-browsing-context①">browsing context</a> <var>browsingContext</var>, run the following steps:</p>
   <ol>
    <li data-md>
     <p>If <var>browsingContext</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#active-window" id="ref-for-active-window①">active window</a> does not have <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/interaction.html#transient-activation" id="ref-for-transient-activation①">transient activation</a>, return.</p>
    <li data-md>
     <p>If <var>browsingContext</var> is not a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#top-level-browsing-context" id="ref-for-top-level-browsing-context">top-level browsing context</a>, return.</p>
    <li data-md>
     <p>Let <var>attributionSource</var> be <var>navigationParams</var>’s <a data-link-type="dfn" href="#navigation-params-attribution-source" id="ref-for-navigation-params-attribution-source③">attribution source</a>.</p>
    <li data-md>
     <p>If <var>attributionSource</var> is null, return.</p>
    <li data-md>
     <p>If <var>attributionSource</var>’s <a data-link-type="dfn" href="#attribution-source-attribution-destination" id="ref-for-attribution-source-attribution-destination⑨">attribution destination</a> is not <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#same-site" id="ref-for-same-site①">same site</a> to <var>navigationParams</var>’s <a href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params-origin">origin</a>, return.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task" id="ref-for-queue-a-task">Queue a task</a> to <a data-link-type="dfn" href="#process-an-attribution-source" id="ref-for-process-an-attribution-source">process an attribution source</a> with <var>attributionSource</var>.</p>
   </ol>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="obtain-a-fake-report">obtain a fake report</dfn> given an <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-source②⑨">attribution source</a> <var>source</var> and
a <a data-link-type="dfn" href="#trigger-state" id="ref-for-trigger-state②">trigger state</a> <var>triggerState</var>:</p>
   <ol>
    <li data-md>
     <p>Let <var>fakeConfig</var> be a new <a data-link-type="dfn" href="#event-level-trigger-configuration" id="ref-for-event-level-trigger-configuration①">event-level trigger configuration</a> with the items:</p>
     <dl>
      <dt data-md><a data-link-type="dfn" href="#event-level-trigger-configuration-trigger-data" id="ref-for-event-level-trigger-configuration-trigger-data④">trigger data</a>
      <dd data-md>
       <p><var>triggerState</var>’s <a data-link-type="dfn" href="#trigger-state-trigger-data" id="ref-for-trigger-state-trigger-data①">trigger data</a></p>
      <dt data-md><a data-link-type="dfn" href="#event-level-trigger-configuration-dedup-key" id="ref-for-event-level-trigger-configuration-dedup-key①">dedup key</a>
      <dd data-md>
       <p>null</p>
      <dt data-md><a data-link-type="dfn" href="#event-level-trigger-configuration-priority" id="ref-for-event-level-trigger-configuration-priority">priority</a>
      <dd data-md>
       <p>0</p>
      <dt data-md><a data-link-type="dfn" href="#event-level-trigger-configuration-filters" id="ref-for-event-level-trigger-configuration-filters">filters</a>
      <dd data-md>
       <p>«[ "<code>source_type</code>" → « <var>source</var>’s <a data-link-type="dfn" href="#attribution-source-source-type" id="ref-for-attribution-source-source-type⑦">source type</a> » ]»</p>
     </dl>
    <li data-md>
     <p>Let <var>fakeTrigger</var> be a new <a data-link-type="dfn" href="#attribution-trigger" id="ref-for-attribution-trigger⑥">attribution trigger</a> with the items:</p>
     <dl>
      <dt data-md><a data-link-type="dfn" href="#attribution-trigger-attribution-destination" id="ref-for-attribution-trigger-attribution-destination">attribution destination</a>
      <dd data-md>
       <p><var>source</var>’s <a data-link-type="dfn" href="#attribution-source-attribution-destination" id="ref-for-attribution-source-attribution-destination①⓪">attribution destination</a></p>
      <dt data-md><a data-link-type="dfn" href="#attribution-trigger-trigger-time" id="ref-for-attribution-trigger-trigger-time">trigger time</a>
      <dd data-md>
       <p><var>source</var>’s <a data-link-type="dfn" href="#attribution-source-source-time" id="ref-for-attribution-source-source-time②">source time</a></p>
      <dt data-md><a data-link-type="dfn" href="#attribution-trigger-reporting-endpoint" id="ref-for-attribution-trigger-reporting-endpoint①">reporting endpoint</a>
      <dd data-md>
       <p><var>source</var>’s <a data-link-type="dfn" href="#attribution-source-reporting-endpoint" id="ref-for-attribution-source-reporting-endpoint⑤">reporting endpoint</a></p>
      <dt data-md><a data-link-type="dfn" href="#attribution-trigger-filters" id="ref-for-attribution-trigger-filters">filters</a>
      <dd data-md>
       <p>«[]»</p>
      <dt data-md><a data-link-type="dfn" href="#attribution-trigger-debug-key" id="ref-for-attribution-trigger-debug-key">debug key</a>
      <dd data-md>
       <p>null</p>
      <dt data-md><a data-link-type="dfn" href="#attribution-trigger-event-level-trigger-configurations" id="ref-for-attribution-trigger-event-level-trigger-configurations">event-level trigger configurations</a>
      <dd data-md>
       <p>« <var>fakeConfig</var> »</p>
     </dl>
    <li data-md>
     <p>Let <var>fakeReport</var> be the result of running <a data-link-type="dfn" href="#obtain-an-event-level-report" id="ref-for-obtain-an-event-level-report">obtain an event-level report</a> with <var>source</var>, <var>fakeTrigger</var>, and <var>fakeConfig</var>.</p>
    <li data-md>
     <p>Set <var>fakeReport</var>’s <a data-link-type="dfn" href="#event-level-report-report-time" id="ref-for-event-level-report-report-time">report time</a> to the result of
running <a data-link-type="dfn" href="#obtain-the-report-time-at-a-window" id="ref-for-obtain-the-report-time-at-a-window">obtain the report time at a window</a> with <var>source</var> and <var>triggerState</var>’s <a data-link-type="dfn" href="#trigger-state-report-window" id="ref-for-trigger-state-report-window①">report window</a>.</p>
    <li data-md>
     <p>Return <var>fakeReport</var>.</p>
   </ol>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="process-an-attribution-source">process an attribution source</dfn> given an <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-source③⓪">attribution source</a> <var>source</var>:</p>
   <ol>
    <li data-md>
     <p>Let <var>cache</var> be the user agent’s <a data-link-type="dfn" href="#attribution-source-cache" id="ref-for-attribution-source-cache③">attribution source cache</a>.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-remove" id="ref-for-list-remove">Remove</a> all entries in <var>cache</var> where the entry’s <a data-link-type="dfn" href="#attribution-source-expiry-time" id="ref-for-attribution-source-expiry-time">expiry time</a> is less than the current time.</p>
    <li data-md>
     <p>If the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-size" id="ref-for-list-size⑤">size</a> of <var>cache</var> is greater than or equal to the user agent’s <a data-link-type="dfn" href="#max-source-cache-size" id="ref-for-max-source-cache-size">max source cache size</a>, return.</p>
    <li data-md>
     <p>Let <var>pendingSourcesForSourceOrigin</var> be the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set①③">set</a> of all <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-source③①">attribution sources</a> <var>pendingSource</var> of <var>cache</var> where <var>pendingSource</var>’s <a data-link-type="dfn" href="#attribution-source-source-origin" id="ref-for-attribution-source-source-origin③">source origin</a> and <var>source</var>’s <a data-link-type="dfn" href="#attribution-source-source-origin" id="ref-for-attribution-source-source-origin④">source origin</a> are <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#same-origin" id="ref-for-same-origin①">same origin</a>.</p>
    <li data-md>
     <p>If <var>pendingSourcesForSourceOrigin</var>’s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-size" id="ref-for-list-size⑥">size</a> is greater than or equal
to the user agent’s <a data-link-type="dfn" href="#max-pending-sources-per-source-origin" id="ref-for-max-pending-sources-per-source-origin">max pending sources per source origin</a>, return.</p>
    <li data-md>
     <p>If the result of running <a data-link-type="dfn" href="#check-if-an-attribution-source-exceeds-the-pending-destination-limit" id="ref-for-check-if-an-attribution-source-exceeds-the-pending-destination-limit">check if an attribution source exceeds the pending destination limit</a> with <var>source</var> is true, return.</p>
    <li data-md>
     <p>Let <var>rateLimitRecord</var> be a new <a data-link-type="dfn" href="#attribution-rate-limit-record" id="ref-for-attribution-rate-limit-record①">attribution rate-limit record</a> with the items:</p>
     <dl>
      <dt data-md><a data-link-type="dfn" href="#attribution-rate-limit-record-scope" id="ref-for-attribution-rate-limit-record-scope">scope</a>
      <dd data-md>
       <p>"<code>source</code>"</p>
      <dt data-md><a data-link-type="dfn" href="#attribution-rate-limit-record-source-site" id="ref-for-attribution-rate-limit-record-source-site③">source site</a>
      <dd data-md>
       <p><var>source</var>’s <a data-link-type="dfn" href="#attribution-source-source-site" id="ref-for-attribution-source-source-site③">source site</a></p>
      <dt data-md><a data-link-type="dfn" href="#attribution-rate-limit-record-attribution-destination" id="ref-for-attribution-rate-limit-record-attribution-destination③">attribution destination</a>
      <dd data-md>
       <p><var>source</var>’s <a data-link-type="dfn" href="#attribution-source-attribution-destination" id="ref-for-attribution-source-attribution-destination①①">attribution destination</a></p>
      <dt data-md><a data-link-type="dfn" href="#attribution-rate-limit-record-reporting-endpoint" id="ref-for-attribution-rate-limit-record-reporting-endpoint①">reporting endpoint</a>
      <dd data-md>
       <p><var>source</var>’s <a data-link-type="dfn" href="#attribution-source-reporting-endpoint" id="ref-for-attribution-source-reporting-endpoint⑥">reporting endpoint</a></p>
      <dt data-md><a data-link-type="dfn" href="#attribution-rate-limit-record-time" id="ref-for-attribution-rate-limit-record-time">time</a>
      <dd data-md>
       <p><var>source</var>’s <a data-link-type="dfn" href="#attribution-source-source-time" id="ref-for-attribution-source-source-time③">source time</a></p>
     </dl>
    <li data-md>
     <p>If the result of running <a data-link-type="dfn" href="#should-block-processing-for-reporting-endpoint-limit" id="ref-for-should-block-processing-for-reporting-endpoint-limit">should processing be blocked by reporting-endpoint limit</a> with <var>rateLimitRecord</var> is <strong>blocked</strong>, return.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#set-append" id="ref-for-set-append④">Append</a> <var>rateLimitRecord</var> to the <a data-link-type="dfn" href="#attribution-rate-limit-cache" id="ref-for-attribution-rate-limit-cache">attribution rate-limit cache</a>.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-remove" id="ref-for-list-remove①">Remove</a> all entries from the <a data-link-type="dfn" href="#attribution-rate-limit-cache" id="ref-for-attribution-rate-limit-cache①">attribution rate-limit cache</a> whose <a data-link-type="dfn" href="#attribution-rate-limit-record-time" id="ref-for-attribution-rate-limit-record-time①">time</a> is at least <a data-link-type="dfn" href="#attribution-rate-limit-window" id="ref-for-attribution-rate-limit-window③">attribution rate-limit window</a> before the current time.</p>
    <li data-md>
     <p>If <var>source</var>’s <a data-link-type="dfn" href="#attribution-source-randomized-response" id="ref-for-attribution-source-randomized-response①">randomized response</a> is not null and is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set①④">set</a>:</p>
     <ol>
      <li data-md>
       <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-iterate" id="ref-for-map-iterate②">For each</a> <a data-link-type="dfn" href="#trigger-state" id="ref-for-trigger-state③">trigger state</a> <var>triggerState</var> of <var>source</var>’s <a data-link-type="dfn" href="#attribution-source-randomized-response" id="ref-for-attribution-source-randomized-response②">randomized response</a>:</p>
       <ol>
        <li data-md>
         <p>Let <var>fakeReport</var> be the result of running <a data-link-type="dfn" href="#obtain-a-fake-report" id="ref-for-obtain-a-fake-report">obtain a fake report</a> with <var>source</var> and <var>triggerState</var>.</p>
        <li data-md>
         <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#set-append" id="ref-for-set-append⑤">Append</a> <var>fakeReport</var> to the <a data-link-type="dfn" href="#event-level-report-cache" id="ref-for-event-level-report-cache②">event-level report cache</a>.</p>
       </ol>
      <li data-md>
       <p>If <var>source</var>’s <a data-link-type="dfn" href="#attribution-source-randomized-response" id="ref-for-attribution-source-randomized-response③">randomized response</a> is not <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-is-empty" id="ref-for-list-is-empty③">empty</a>, return.</p>
     </ol>
    <li data-md>
     <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#set-append" id="ref-for-set-append⑥">Append</a> <var>source</var> to <var>cache</var>.</p>
   </ol>
   <p class="issue" id="issue-82e83119"><a class="self-link" href="#issue-82e83119"></a> Should fake reports respect the user agent’s <a data-link-type="dfn" href="#max-reports-per-attribution-destination" id="ref-for-max-reports-per-attribution-destination">max reports per attribution destination</a>?</p>
   <h2 class="heading settled" data-level="10" id="trigger-algorithms"><span class="secno">10. </span><span class="content">Triggering Algorithms</span><a class="self-link" href="#trigger-algorithms"></a></h2>
   <h3 class="heading settled algorithm" data-algorithm="Creating an attribution trigger" data-level="10.1" id="attribution-trigger-creation"><span class="secno">10.1. </span><span class="content">Creating an attribution trigger</span><a class="self-link" href="#attribution-trigger-creation"></a></h3>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="parse-event-triggers">parse event triggers</dfn> given an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map⑨">ordered map</a> <var>map</var>:</p>
   <ol>
    <li data-md>
     <p>Let <var>eventTriggers</var> be a new <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set①⑤">set</a>.</p>
    <li data-md>
     <p>If <var>map</var>["<code>event_trigger_data</code>"] does not <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists⑧">exist</a>, return <var>eventTriggers</var>.</p>
    <li data-md>
     <p>Let <var>values</var> be <var>map</var>["<code>event_trigger_data</code>"].</p>
    <li data-md>
     <p>If <var>values</var> is not a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list②">list</a>, return null.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate" id="ref-for-list-iterate①">For each</a> <var>value</var> of <var>values</var>:</p>
     <ol>
      <li data-md>
       <p>If <var>value</var> is not an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map①⓪">ordered map</a>, return null.</p>
      <li data-md>
       <p>Let <var>triggerData</var> be 0.</p>
      <li data-md>
       <p>If <var>value</var>["<code>trigger_data</code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists⑨">exists</a> and is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string②①">string</a>:</p>
       <ol>
        <li data-md>
         <p>Set <var>triggerData</var> to the result of applying the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/common-microsyntaxes.html#rules-for-parsing-non-negative-integers" id="ref-for-rules-for-parsing-non-negative-integers②">rules for parsing non-negative integers</a> to <var>value</var>["<code>trigger_data</code>"].</p>
        <li data-md>
         <p>If <var>triggerData</var> is an error, set <var>triggerData</var> to 0.</p>
       </ol>
      <li data-md>
       <p>Let <var>dedupKey</var> be null.</p>
      <li data-md>
       <p>If <var>value</var>["<code>deduplication_key</code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists①⓪">exists</a> and is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string②②">string</a>:</p>
       <ol>
        <li data-md>
         <p>Set <var>dedupKey</var> to the result of applying the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/common-microsyntaxes.html#rules-for-parsing-non-negative-integers" id="ref-for-rules-for-parsing-non-negative-integers③">rules for parsing non-negative integers</a> to <var>value</var>["<code>deduplication_key</code>"].</p>
        <li data-md>
         <p>If <var>dedupKey</var> is an error, set <var>dedupKey</var> to null.</p>
       </ol>
      <li data-md>
       <p>Let <var>priority</var> be 0.</p>
      <li data-md>
       <p>If <var>value</var>["<code>priority</code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists①①">exists</a> and is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string②③">string</a>:</p>
       <ol>
        <li data-md>
         <p>Set <var>priority</var> to the result of applying the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/common-microsyntaxes.html#rules-for-parsing-integers" id="ref-for-rules-for-parsing-integers②">rules for parsing integers</a> to <var>value</var>["<code>priority</code>"].</p>
        <li data-md>
         <p>If <var>priority</var> is an error, set <var>priority</var> to 0.</p>
       </ol>
      <li data-md>
       <p>Let <var>filters</var> be a new <a data-link-type="dfn" href="#filter-map" id="ref-for-filter-map①①">filter map</a>.</p>
      <li data-md>
       <p>If <var>value</var>["<code>filters</code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists①②">exists</a>:</p>
       <ol>
        <li data-md>
         <p>Set <var>filters</var> to the result of running <a data-link-type="dfn" href="#parse-filter-data" id="ref-for-parse-filter-data①">parse filter data</a> with <var>value</var>["<code>filters</code>"] and <a data-link-type="dfn" href="#parse-filter-data-registrationtype" id="ref-for-parse-filter-data-registrationtype①">registrationType</a> set
to "<code>trigger</code>".</p>
        <li data-md>
         <p>If <var>filters</var> is null, return null.</p>
       </ol>
      <li data-md>
       <p>Let <var>negatedFilters</var> be a new <a data-link-type="dfn" href="#filter-map" id="ref-for-filter-map①②">filter map</a>.</p>
      <li data-md>
       <p>If <var>value</var>["<code>not_filters</code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists①③">exists</a>:</p>
       <ol>
        <li data-md>
         <p>Set <var>negatedFilters</var> to the result of running <a data-link-type="dfn" href="#parse-filter-data" id="ref-for-parse-filter-data②">parse filter data</a> with <var>value</var>["<code>not_filters</code>"] and <a data-link-type="dfn" href="#parse-filter-data-registrationtype" id="ref-for-parse-filter-data-registrationtype②">registrationType</a> set to "<code>trigger</code>".</p>
        <li data-md>
         <p>If <var>negatedFilters</var> is null, return null.</p>
       </ol>
      <li data-md>
       <p>Let <var>eventTrigger</var> be a new <a data-link-type="dfn" href="#event-level-trigger-configuration" id="ref-for-event-level-trigger-configuration②">event-level trigger configuration</a> with
the items:</p>
       <dl>
        <dt data-md><a data-link-type="dfn" href="#event-level-trigger-configuration-trigger-data" id="ref-for-event-level-trigger-configuration-trigger-data⑤">trigger data</a>
        <dd data-md>
         <p><var>triggerData</var></p>
        <dt data-md><a data-link-type="dfn" href="#event-level-trigger-configuration-dedup-key" id="ref-for-event-level-trigger-configuration-dedup-key②">dedup key</a>
        <dd data-md>
         <p><var>dedupKey</var></p>
        <dt data-md><a data-link-type="dfn" href="#event-level-trigger-configuration-priority" id="ref-for-event-level-trigger-configuration-priority①">priority</a>
        <dd data-md>
         <p><var>priority</var></p>
        <dt data-md><a data-link-type="dfn" href="#event-level-trigger-configuration-filters" id="ref-for-event-level-trigger-configuration-filters①">filters</a>
        <dd data-md>
         <p><var>filters</var></p>
        <dt data-md><a data-link-type="dfn" href="#event-level-trigger-configuration-negated-filters" id="ref-for-event-level-trigger-configuration-negated-filters">negated filters</a>
        <dd data-md>
         <p><var>negatedFilters</var></p>
       </dl>
      <li data-md>
       <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#set-append" id="ref-for-set-append⑦">Append</a> <var>eventTrigger</var> to <var>eventTriggers</var>.</p>
     </ol>
    <li data-md>
     <p>Return <var>eventTriggers</var>.</p>
   </ol>
   <p class="issue" id="issue-4950c7c2"><a class="self-link" href="#issue-4950c7c2"></a> Allow the user agent to return null if <var>values</var>’s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-size" id="ref-for-list-size⑦">size</a> is
greater than some constant.</p>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="parse-aggregatable-trigger-data">parse aggregatable trigger data</dfn> given an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map①①">ordered map</a> <var>map</var>:</p>
   <ol>
    <li data-md>
     <p>Let <var>aggregatableTriggerData</var> be a new <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list③">list</a>.</p>
    <li data-md>
     <p>If <var>map</var>["<code>aggregatable_trigger_data</code>"] does not <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists①④">exist</a>, return <var>aggregatableTriggerData</var>.</p>
    <li data-md>
     <p>Let <var>values</var> be <var>map</var>["<code>aggregatable_trigger_data</code>"].</p>
    <li data-md>
     <p>If <var>values</var> is not a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list④">list</a>, return null.</p>
    <li data-md>
     <p>If <var>values</var>’s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-size" id="ref-for-list-size⑧">size</a> is greater than the user agent’s <a data-link-type="dfn" href="#max-aggregatable-trigger-data-per-trigger" id="ref-for-max-aggregatable-trigger-data-per-trigger">max aggregatable trigger data per trigger</a>, return null.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate" id="ref-for-list-iterate②">For each</a> <var>value</var> of <var>values</var>:</p>
     <ol>
      <li data-md>
       <p>If <var>value</var> is not an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map①②">ordered map</a>, return null.</p>
      <li data-md>
       <p>If <var>value</var>["<code>key_piece</code>"] does not <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists①⑤">exist</a> or is not a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string②④">string</a>, return null.</p>
      <li data-md>
       <p>Let <var>keyPiece</var> be the result of running <a data-link-type="dfn" href="#parse-an-aggregation-key-piece" id="ref-for-parse-an-aggregation-key-piece①">parse an aggregation key piece</a> with <var>value</var>["<code>key_piece</code>"].</p>
      <li data-md>
       <p>If <var>keyPiece</var> is an error, return null.</p>
      <li data-md>
       <p>If <var>value</var>["<code>source_keys</code>"] does not <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists①⑥">exist</a> or is not a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list⑤">list</a>, return null.</p>
      <li data-md>
       <p>If <var>value</var>["<code>source_keys</code>"]'s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-size" id="ref-for-list-size⑨">size</a> is greater than the user agent’s <a data-link-type="dfn" href="#max-aggregation-keys-per-attribution" id="ref-for-max-aggregation-keys-per-attribution①">max aggregation keys per attribution</a>, return null.</p>
      <li data-md>
       <p>Let <var>sourceKeys</var> be a new <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set①⑥">set</a>.</p>
      <li data-md>
       <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate" id="ref-for-list-iterate③">For each</a> <var>sourceKey</var> of <var>value</var>["<code>source_keys</code>"]:</p>
       <ol>
        <li data-md>
         <p>If <var>sourceKey</var> is not a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string②⑤">string</a>, return null.</p>
        <li data-md>
         <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#set-append" id="ref-for-set-append⑧">Append</a> <var>sourceKey</var> to <var>sourceKeys</var>.</p>
       </ol>
      <li data-md>
       <p>Let <var>filters</var> be a new <a data-link-type="dfn" href="#filter-map" id="ref-for-filter-map①③">filter map</a>.</p>
      <li data-md>
       <p>If <var>value</var>["<code>filters</code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists①⑦">exists</a>:</p>
       <ol>
        <li data-md>
         <p>Set <var>filters</var> to the result of running <a data-link-type="dfn" href="#parse-filter-data" id="ref-for-parse-filter-data③">parse filter data</a> with <var>value</var>["<code>filters</code>"] and "<code>trigger</code>".</p>
        <li data-md>
         <p>If <var>filters</var> is null, return null.</p>
       </ol>
      <li data-md>
       <p>Let <var>negatedFilters</var> be a new <a data-link-type="dfn" href="#filter-map" id="ref-for-filter-map①④">filter map</a>.</p>
      <li data-md>
       <p>If <var>value</var>["<code>not_filters</code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists①⑧">exists</a>:</p>
       <ol>
        <li data-md>
         <p>Set <var>negatedFilters</var> to the result of running <a data-link-type="dfn" href="#parse-filter-data" id="ref-for-parse-filter-data④">parse filter data</a> with <var>value</var>["<code>not_filters</code>"] and "<code>trigger</code>".</p>
        <li data-md>
         <p>If <var>negatedFilters</var> is null, return null.</p>
       </ol>
      <li data-md>
       <p>Let <var>aggregatableTrigger</var> be a new <a data-link-type="dfn" href="#aggregatable-trigger-data" id="ref-for-aggregatable-trigger-data②">aggregatable trigger data</a> with the items:</p>
       <dl>
        <dt data-md><a data-link-type="dfn" href="#aggregatable-trigger-data-key-piece" id="ref-for-aggregatable-trigger-data-key-piece">key piece</a>
        <dd data-md>
         <p><var>keyPiece</var></p>
        <dt data-md><a data-link-type="dfn" href="#aggregatable-trigger-data-source-keys" id="ref-for-aggregatable-trigger-data-source-keys①">source keys</a>
        <dd data-md>
         <p><var>sourceKeys</var></p>
        <dt data-md><a data-link-type="dfn" href="#aggregatable-trigger-data-filters" id="ref-for-aggregatable-trigger-data-filters">filters</a>
        <dd data-md>
         <p><var>filters</var></p>
        <dt data-md><a data-link-type="dfn" href="#aggregatable-trigger-data-negated-filters" id="ref-for-aggregatable-trigger-data-negated-filters">negated filters</a>
        <dd data-md>
         <p><var>negatedFilters</var></p>
       </dl>
      <li data-md>
       <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append" id="ref-for-list-append">Append</a> <var>aggregatableTrigger</var> to <var>aggregatableTriggerData</var>.</p>
     </ol>
    <li data-md>
     <p>Return <var>aggregatableTriggerData</var>.</p>
   </ol>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="parse-aggregatable-values">parse aggregatable values</dfn> given an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map①③">ordered map</a> <var>map</var>:</p>
   <ol>
    <li data-md>
     <p>If <var>map</var>["<code>aggregatable_values</code>"] does not <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists①⑨">exist</a>, return «[]».</p>
    <li data-md>
     <p>Let <var>values</var> be <var>map</var>["<code>aggregatable_values</code>"].</p>
    <li data-md>
     <p>If <var>values</var> is not an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map①④">ordered map</a>, return null.</p>
    <li data-md>
     <p>If <var>values</var>’s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-size" id="ref-for-map-size⑤">size</a> is great than the user agent’s <a data-link-type="dfn" href="#max-aggregation-keys-per-attribution" id="ref-for-max-aggregation-keys-per-attribution②">max aggregation keys per attribution</a>, return null.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-iterate" id="ref-for-map-iterate③">For each</a> <var>key</var> → <var>value</var> of <var>values</var>:</p>
     <ol>
      <li data-md>
       <p>If <var>value</var> is not an integer, return null.</p>
      <li data-md>
       <p>If <var>value</var> is less than or equal to 0, return null.</p>
     </ol>
    <li data-md>
     <p>Return <var>values</var>.</p>
   </ol>
   <p>To <dfn data-dfn-type="dfn" data-noexport id="parse-trigger-registration-json">parse trigger-registration JSON<a class="self-link" href="#parse-trigger-registration-json"></a></dfn> given a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string②⑥">string</a> <var>json</var>, a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#site" id="ref-for-site⑤">site</a> <var>destination</var>, and an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin" id="ref-for-concept-origin③">origin</a> <var>reportingOrigin</var>:</p>
   <ol>
    <li data-md>
     <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert④">Assert</a>: <var>reportingOrigin</var> is a <a data-link-type="dfn" href="https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-origin" id="ref-for-potentially-trustworthy-origin④">potentially trustworthy origin</a>.</p>
    <li data-md>
     <p>Let <var>value</var> be the result of running <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#parse-a-json-string-to-an-infra-value" id="ref-for-parse-a-json-string-to-an-infra-value①">parse a JSON string to an Infra value</a> with <var>json</var>.</p>
    <li data-md>
     <p>If <var>value</var> is not an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map①⑤">ordered map</a>, return null.</p>
    <li data-md>
     <p>Let <var>eventTriggers</var> be the result of running <a data-link-type="dfn" href="#parse-event-triggers" id="ref-for-parse-event-triggers">parse event triggers</a> with <var>value</var>.</p>
    <li data-md>
     <p>If <var>eventTriggers</var> is null, return null.</p>
    <li data-md>
     <p>Let <var>aggregatableTriggerData</var> be the result of running <a data-link-type="dfn" href="#parse-aggregatable-trigger-data" id="ref-for-parse-aggregatable-trigger-data">parse aggregatable trigger data</a> with <var>value</var>.</p>
    <li data-md>
     <p>If <var>aggregatableTriggerData</var> is null, return null.</p>
    <li data-md>
     <p>Let <var>aggregatableValues</var> be the result of running <a data-link-type="dfn" href="#parse-aggregatable-values" id="ref-for-parse-aggregatable-values">parse aggregatable values</a> with <var>value</var>.</p>
    <li data-md>
     <p>If <var>aggregatableValues</var> is null, return null.</p>
    <li data-md>
     <p>Let <var>aggregatableDedupKey</var> be null.</p>
    <li data-md>
     <p>If <var>value</var>["<code>aggregatable_deduplication_key</code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists②⓪">exists</a> and is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string②⑦">string</a>:</p>
     <ol>
      <li data-md>
       <p>Set <var>aggregatableDedupKey</var> to the result of applying the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/common-microsyntaxes.html#rules-for-parsing-non-negative-integers" id="ref-for-rules-for-parsing-non-negative-integers④">rules for parsing non-negative integers</a> to <var>value</var>["<code>aggregatable_deduplication_key</code>"].</p>
      <li data-md>
       <p>If <var>aggregatableDedupKey</var> is an error, set <var>aggregatableDedupKey</var> to null.</p>
     </ol>
    <li data-md>
     <p>Let <var>debugKey</var> be null.</p>
    <li data-md>
     <p>If <var>value</var>["<code>debug_key</code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists②①">exists</a> and is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string②⑧">string</a>:</p>
     <ol>
      <li data-md>
       <p>Set <var>debugKey</var> to the result of applying the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/common-microsyntaxes.html#rules-for-parsing-non-negative-integers" id="ref-for-rules-for-parsing-non-negative-integers⑤">rules for parsing non-negative integers</a> to <var>value</var>["<code>debug_key</code>"].</p>
      <li data-md>
       <p>If <var>debugKey</var> is an error, set <var>debugKey</var> to null.</p>
      <li data-md>
       <p>If the result of running <a data-link-type="dfn" href="#check-if-a-debug-key-is-allowed" id="ref-for-check-if-a-debug-key-is-allowed①">check if a debug key is allowed</a> with <var>reportingOrigin</var> is <strong>blocked</strong>, set <var>debugKey</var> to null.</p>
     </ol>
    <li data-md>
     <p>Let <var>filters</var> be a new <a data-link-type="dfn" href="#filter-map" id="ref-for-filter-map①⑤">filter map</a>.</p>
    <li data-md>
     <p>If <var>value</var>["<code>filters</code>"] exists:</p>
     <ol>
      <li data-md>
       <p>Set <var>filters</var> to the result of running <a data-link-type="dfn" href="#parse-filter-data" id="ref-for-parse-filter-data⑤">parse filter data</a> with <var>value</var>["<code>filters</code>"] and <a data-link-type="dfn" href="#parse-filter-data-registrationtype" id="ref-for-parse-filter-data-registrationtype③">registrationType</a> set to
"<code>trigger</code>".</p>
      <li data-md>
       <p>If <var>filters</var> is null, return null.</p>
     </ol>
    <li data-md>
     <p>Let <var>negatedFilters</var> be a new <a data-link-type="dfn" href="#filter-map" id="ref-for-filter-map①⑥">filter map</a>.</p>
    <li data-md>
     <p>If <var>value</var>["<code>not_filters</code>"] exists:</p>
     <ol>
      <li data-md>
       <p>Set <var>negatedFilters</var> to the result of running <a data-link-type="dfn" href="#parse-filter-data" id="ref-for-parse-filter-data⑥">parse filter data</a> with <var>value</var>["<code>not_filters</code>"] and <a data-link-type="dfn" href="#parse-filter-data-registrationtype" id="ref-for-parse-filter-data-registrationtype④">registrationType</a> set
to "<code>trigger</code>".</p>
      <li data-md>
       <p>If <var>negatedFilters</var> is null, return null.</p>
     </ol>
    <li data-md>
     <p>Let <var>trigger</var> be a new <a data-link-type="dfn" href="#attribution-trigger" id="ref-for-attribution-trigger⑦">attribution trigger</a> with the items:</p>
     <dl>
      <dt data-md><a data-link-type="dfn" href="#attribution-trigger-attribution-destination" id="ref-for-attribution-trigger-attribution-destination①">attribution destination</a>
      <dd data-md>
       <p><var>destination</var></p>
      <dt data-md><a data-link-type="dfn" href="#attribution-trigger-trigger-time" id="ref-for-attribution-trigger-trigger-time①">trigger time</a>
      <dd data-md>
       <p>The current time.</p>
      <dt data-md><a data-link-type="dfn" href="#attribution-trigger-reporting-endpoint" id="ref-for-attribution-trigger-reporting-endpoint②">reporting endpoint</a>
      <dd data-md>
       <p><var>reportingOrigin</var></p>
      <dt data-md><a data-link-type="dfn" href="#attribution-trigger-filters" id="ref-for-attribution-trigger-filters①">filters</a>
      <dd data-md>
       <p><var>filters</var></p>
      <dt data-md><a data-link-type="dfn" href="#attribution-trigger-negated-filters" id="ref-for-attribution-trigger-negated-filters">negated filters</a>
      <dd data-md>
       <p><var>negatedFilters</var></p>
      <dt data-md><a data-link-type="dfn" href="#attribution-trigger-debug-key" id="ref-for-attribution-trigger-debug-key①">debug key</a>
      <dd data-md>
       <p><var>debugKey</var></p>
      <dt data-md><a data-link-type="dfn" href="#attribution-trigger-event-level-trigger-configurations" id="ref-for-attribution-trigger-event-level-trigger-configurations①">event-level trigger configurations</a>
      <dd data-md>
       <p><var>eventTriggers</var></p>
      <dt data-md><a data-link-type="dfn" href="#attribution-trigger-aggregatable-trigger-data" id="ref-for-attribution-trigger-aggregatable-trigger-data①">aggregatable trigger data</a>
      <dd data-md>
       <p><var>aggregatableTriggerData</var></p>
      <dt data-md><a data-link-type="dfn" href="#attribution-trigger-aggregatable-values" id="ref-for-attribution-trigger-aggregatable-values①">aggregatable values</a>
      <dd data-md>
       <p><var>aggregatableValues</var></p>
      <dt data-md><a data-link-type="dfn" href="#attribution-trigger-aggregatable-dedup-key" id="ref-for-attribution-trigger-aggregatable-dedup-key">aggregatable dedup key</a>
      <dd data-md>
       <p><var>aggregatableDedupKey</var></p>
     </dl>
    <li data-md>
     <p>Return <var>trigger</var>.</p>
   </ol>
   <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-level="10.2" data-lt="Does filter data match" data-noexport id="does-filter-data-match"><span class="secno">10.2. </span><span class="content">Does filter data match</span><a class="self-link" href="#does-filter-data-match" id="ref-for-does-filter-data-match"></a></h3>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="match-filter-values">match <a data-link-type="dfn" href="#filter-value" id="ref-for-filter-value①">filter values</a></dfn> given a <a data-link-type="dfn" href="#filter-value" id="ref-for-filter-value②">filter value</a> <var>a</var> and a <a data-link-type="dfn" href="#filter-value" id="ref-for-filter-value③">filter value</a> <var>b</var>:</p>
   <ol>
    <li data-md>
     <p>If <var>b</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-is-empty" id="ref-for-list-is-empty④">is empty</a>, then:</p>
     <ol>
      <li data-md>
       <p>If <var>a</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-is-empty" id="ref-for-list-is-empty⑤">is empty</a>, then return true.</p>
      <li data-md>
       <p>Otherwise, return false.</p>
     </ol>
    <li data-md>
     <p>Let <var>i</var> be the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#set-intersection" id="ref-for-set-intersection">intersection</a> of <var>a</var> and <var>b</var>.</p>
    <li data-md>
     <p>If <var>i</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-is-empty" id="ref-for-list-is-empty⑥">is empty</a>, then return false.</p>
    <li data-md>
     <p>Return true.</p>
   </ol>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="match-filter-values-with-negation">match <a data-link-type="dfn" href="#filter-value" id="ref-for-filter-value④">filter values</a> with negation</dfn> given a <a data-link-type="dfn" href="#filter-value" id="ref-for-filter-value⑤">filter value</a> <var>a</var> and a <a data-link-type="dfn" href="#filter-value" id="ref-for-filter-value⑥">filter value</a> <var>b</var>:</p>
   <ol>
    <li data-md>
     <p>If <var>b</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-is-empty" id="ref-for-list-is-empty⑦">is empty</a>, then:</p>
     <ol>
      <li data-md>
       <p>If <var>a</var> is not <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-is-empty" id="ref-for-list-is-empty⑧">empty</a>, then return true.</p>
      <li data-md>
       <p>Otherwise, return false.</p>
     </ol>
    <li data-md>
     <p>Let <var>i</var> be the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#set-intersection" id="ref-for-set-intersection①">intersection</a> of <var>a</var> and <var>b</var>.</p>
    <li data-md>
     <p>If <var>i</var> is not <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-is-empty" id="ref-for-list-is-empty⑨">empty</a>, then return false.</p>
    <li data-md>
     <p>Return true.</p>
   </ol>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="match-an-attribution-sources-filter-data-against-filters">match an attribution source’s filter data against filters</dfn> given an <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-source③②">attribution source</a> <var>source</var>, a <a data-link-type="dfn" href="#filter-map" id="ref-for-filter-map①⑦">filter map</a> <var>filters</var>, and a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#boolean" id="ref-for-boolean①">boolean</a> <dfn class="dfn-paneled" data-dfn-for="match an attribution source’s filter data against filters" data-dfn-type="dfn" data-noexport id="match-an-attribution-sources-filter-data-against-filters-isnegated"><var>isNegated</var></dfn>:</p>
   <ol>
    <li data-md>
     <p>Let <var>sourceData</var> be <var>source</var>’s <a data-link-type="dfn" href="#attribution-source-filter-data" id="ref-for-attribution-source-filter-data①">filter data</a>.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-iterate" id="ref-for-map-iterate④">For each</a> <var>key</var> → <var>filterValues</var> of <var>filters</var>:</p>
     <ol>
      <li data-md>
       <p>If <var>sourceData</var>[<var>key</var>] does not <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists②②">exist</a>, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#iteration-continue" id="ref-for-iteration-continue①">continue</a>.</p>
      <li data-md>
       <p>Let <var>sourceValues</var> be <var>sourceData</var>[<var>key</var>].</p>
      <li data-md>
       <p>If <var>isNegated</var> is:</p>
       <dl class="switch">
        <dt>false
        <dd> If the result of running <a data-link-type="dfn" href="#match-filter-values" id="ref-for-match-filter-values">match filter values</a> with <var>sourceValues</var> and <var>filterValues</var> is false, return false.
        <dt>true
        <dd>If the result of running <a data-link-type="dfn" href="#match-filter-values-with-negation" id="ref-for-match-filter-values-with-negation">match filter values with negation</a> with <var>sourceValues</var> and <var>filterValues</var> is false, return false.
       </dl>
     </ol>
    <li data-md>
     <p>Return true.</p>
   </ol>
   <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-level="10.3" data-lt="Should attribution be blocked by rate limit" data-noexport id="should-rate-limit-attribution"><span class="secno">10.3. </span><span class="content">Should attribution be blocked by rate limit</span><a class="self-link" href="#should-rate-limit-attribution" id="ref-for-should-rate-limit-attribution"></a></h3>
   <p>Given an <a data-link-type="dfn" href="#attribution-trigger" id="ref-for-attribution-trigger⑧">attribution trigger</a> <var>trigger</var> and <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-source③③">attribution source</a> <var>sourceToAttribute</var>:</p>
   <ol>
    <li data-md>
     <p>Let <var>matchingRateLimitRecords</var> be all <a data-link-type="dfn" href="#attribution-rate-limit-record" id="ref-for-attribution-rate-limit-record②">attribution rate-limit records</a> <var>record</var> of <a data-link-type="dfn" href="#attribution-rate-limit-cache" id="ref-for-attribution-rate-limit-cache②">attribution rate-limit cache</a> where all of the following are true:</p>
     <ul>
      <li data-md>
       <p><var>record</var>’s <a data-link-type="dfn" href="#attribution-rate-limit-record-scope" id="ref-for-attribution-rate-limit-record-scope①">scope</a> is "<code>attribution</code>"</p>
      <li data-md>
       <p><var>record</var>’s <a data-link-type="dfn" href="#attribution-rate-limit-record-source-site" id="ref-for-attribution-rate-limit-record-source-site④">source site</a> and <var>sourceToAttribute</var>’s <a data-link-type="dfn" href="#attribution-source-source-site" id="ref-for-attribution-source-source-site④">source site</a> are equal</p>
      <li data-md>
       <p><var>record</var>’s <a data-link-type="dfn" href="#attribution-rate-limit-record-attribution-destination" id="ref-for-attribution-rate-limit-record-attribution-destination④">attribution destination</a> and <var>trigger</var>’s <a data-link-type="dfn" href="#attribution-trigger-attribution-destination" id="ref-for-attribution-trigger-attribution-destination②">attribution destination</a> are equal</p>
      <li data-md>
       <p><var>record</var>’s <a data-link-type="dfn" href="#attribution-rate-limit-record-reporting-endpoint" id="ref-for-attribution-rate-limit-record-reporting-endpoint②">reporting endpoint</a> and <var>trigger</var>’s <a data-link-type="dfn" href="#attribution-trigger-reporting-endpoint" id="ref-for-attribution-trigger-reporting-endpoint③">reporting endpoint</a> are <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#same-origin" id="ref-for-same-origin②">same origin</a></p>
      <li data-md>
       <p><var>record</var>’s <a data-link-type="dfn" href="#attribution-rate-limit-record-time" id="ref-for-attribution-rate-limit-record-time②">time</a> is at least <a data-link-type="dfn" href="#attribution-rate-limit-window" id="ref-for-attribution-rate-limit-window④">attribution rate-limit window</a> before <var>trigger</var>’s <a data-link-type="dfn" href="#attribution-trigger-trigger-time" id="ref-for-attribution-trigger-trigger-time②">trigger time</a></p>
     </ul>
    <li data-md>
     <p>If <var>matchingRateLimitRecords</var>’s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-size" id="ref-for-list-size①⓪">size</a> is greater than or equal to <a data-link-type="dfn" href="#max-attributions-per-rate-limit-window" id="ref-for-max-attributions-per-rate-limit-window">max attributions per rate-limit window</a>, return <strong>blocked</strong>.</p>
    <li data-md>
     <p>Return <strong>allowed</strong>.</p>
   </ol>
   <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-level="10.4" data-lt="Should processing be blocked by reporting-endpoint limit" data-noexport id="should-block-processing-for-reporting-endpoint-limit"><span class="secno">10.4. </span><span class="content">Should processing be blocked by reporting-endpoint limit</span><a class="self-link" href="#should-block-processing-for-reporting-endpoint-limit" id="ref-for-should-block-processing-for-reporting-endpoint-limit②"></a></h3>
   <p>Given an <a data-link-type="dfn" href="#attribution-rate-limit-record" id="ref-for-attribution-rate-limit-record③">attribution rate-limit record</a> <var>newRecord</var>:</p>
   <ol>
    <li data-md>
     <p>Let <var>max</var> be <a data-link-type="dfn" href="#max-source-reporting-endpoints-per-rate-limit-window" id="ref-for-max-source-reporting-endpoints-per-rate-limit-window">max source reporting endpoints per rate-limit window</a>.</p>
    <li data-md>
     <p>If <var>newRecord</var>’s <a data-link-type="dfn" href="#attribution-rate-limit-record-scope" id="ref-for-attribution-rate-limit-record-scope②">scope</a> is "<code>attribution</code>", set <var>max</var> to <a data-link-type="dfn" href="#max-attribution-reporting-endpoints-per-rate-limit-window" id="ref-for-max-attribution-reporting-endpoints-per-rate-limit-window">max attribution reporting endpoints per rate-limit window</a>.</p>
    <li data-md>
     <p>Let <var>matchingRateLimitRecords</var> be all <a data-link-type="dfn" href="#attribution-rate-limit-record" id="ref-for-attribution-rate-limit-record④">attribution rate-limit records</a> <var>record</var> in the <a data-link-type="dfn" href="#attribution-rate-limit-cache" id="ref-for-attribution-rate-limit-cache③">attribution rate-limit cache</a> where all of the following are true:</p>
     <ul>
      <li data-md>
       <p><var>record</var>’s <a data-link-type="dfn" href="#attribution-rate-limit-record-scope" id="ref-for-attribution-rate-limit-record-scope③">scope</a> and <var>newRecord</var>’s <a data-link-type="dfn" href="#attribution-rate-limit-record-scope" id="ref-for-attribution-rate-limit-record-scope④">scope</a> are equal</p>
      <li data-md>
       <p><var>record</var>’s <a data-link-type="dfn" href="#attribution-rate-limit-record-source-site" id="ref-for-attribution-rate-limit-record-source-site⑤">source site</a> and <var>newRecord</var>’s <a data-link-type="dfn" href="#attribution-rate-limit-record-source-site" id="ref-for-attribution-rate-limit-record-source-site⑥">source site</a> are equal</p>
      <li data-md>
       <p><var>record</var>’s <a data-link-type="dfn" href="#attribution-rate-limit-record-attribution-destination" id="ref-for-attribution-rate-limit-record-attribution-destination⑤">attribution destination</a> and <var>newRecord</var>’s <a data-link-type="dfn" href="#attribution-rate-limit-record-attribution-destination" id="ref-for-attribution-rate-limit-record-attribution-destination⑥">attribution destination</a> are equal</p>
      <li data-md>
       <p><var>record</var>’s <a data-link-type="dfn" href="#attribution-rate-limit-record-time" id="ref-for-attribution-rate-limit-record-time③">time</a> is at least <a data-link-type="dfn" href="#attribution-rate-limit-window" id="ref-for-attribution-rate-limit-window⑤">attribution rate-limit window</a> before <var>newRecord</var>’s <a data-link-type="dfn" href="#attribution-rate-limit-record-time" id="ref-for-attribution-rate-limit-record-time④">time</a></p>
     </ul>
    <li data-md>
     <p>Let <var>distinctReportingEndpoints</var> be a new empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set①⑦">ordered set</a>.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-iterate" id="ref-for-map-iterate⑤">For each</a> <var>record</var> of <var>matchingRateLimitRecords</var>, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#set-append" id="ref-for-set-append⑨">append</a> <var>record</var>’s <a data-link-type="dfn" href="#attribution-rate-limit-record-reporting-endpoint" id="ref-for-attribution-rate-limit-record-reporting-endpoint③">reporting endpoint</a> to <var>distinctReportingEndpoints</var>.</p>
    <li data-md>
     <p>If <var>distinctReportingEndpoints</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-contain" id="ref-for-list-contain①">contains</a> <var>newRecord</var>’s <a data-link-type="dfn" href="#attribution-rate-limit-record-reporting-endpoint" id="ref-for-attribution-rate-limit-record-reporting-endpoint④">reporting endpoint</a>, return <strong>allowed</strong>.</p>
    <li data-md>
     <p>If <var>distinctReportingEndpoints</var>’s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-size" id="ref-for-list-size①①">size</a> is greater than or equal to <var>max</var>, return <strong>blocked</strong>.</p>
    <li data-md>
     <p>Return <strong>allowed</strong>.</p>
   </ol>
   <h3 class="heading settled algorithm" data-algorithm="Creating aggregatable contributions" data-level="10.5" id="creating-aggregatable-contributions"><span class="secno">10.5. </span><span class="content">Creating aggregatable contributions</span><a class="self-link" href="#creating-aggregatable-contributions"></a></h3>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="create-aggregatable-contributions">create <a data-link-type="dfn" href="#aggregatable-contribution" id="ref-for-aggregatable-contribution②">aggregatable contributions</a></dfn> given an <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-source③④">attribution source</a> <var>source</var> and an <a data-link-type="dfn" href="#attribution-trigger" id="ref-for-attribution-trigger⑨">attribution trigger</a> <var>trigger</var>, run the following steps:</p>
   <ol>
    <li data-md>
     <p>Let <var>aggregationKeys</var> be <var>source</var>’s <a data-link-type="dfn" href="#attribution-source-aggregation-keys" id="ref-for-attribution-source-aggregation-keys②">aggregation keys</a>.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate" id="ref-for-list-iterate④">For each</a> <var>triggerData</var> of <var>trigger</var>’s <a data-link-type="dfn" href="#attribution-trigger-aggregatable-trigger-data" id="ref-for-attribution-trigger-aggregatable-trigger-data②">aggregatable trigger data</a>:</p>
     <ol>
      <li data-md>
       <p>If the result of running <a data-link-type="dfn" href="#match-an-attribution-sources-filter-data-against-filters" id="ref-for-match-an-attribution-sources-filter-data-against-filters">match an attribution source’s filter data against filters</a> with <var>source</var>, <var>triggerData</var>’s <a data-link-type="dfn" href="#aggregatable-trigger-data-filters" id="ref-for-aggregatable-trigger-data-filters①">filters</a>, and <a data-link-type="dfn" href="#match-an-attribution-sources-filter-data-against-filters-isnegated" id="ref-for-match-an-attribution-sources-filter-data-against-filters-isnegated">isNegated</a> set to false is false, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#iteration-continue" id="ref-for-iteration-continue②">continue</a>.</p>
      <li data-md>
       <p>If the result of running <a data-link-type="dfn" href="#match-an-attribution-sources-filter-data-against-filters" id="ref-for-match-an-attribution-sources-filter-data-against-filters①">match an attribution source’s filter data against filters</a> with <var>source</var>, <var>triggerData</var>’s <a data-link-type="dfn" href="#aggregatable-trigger-data-negated-filters" id="ref-for-aggregatable-trigger-data-negated-filters①">negated filters</a>, and <a data-link-type="dfn" href="#match-an-attribution-sources-filter-data-against-filters-isnegated" id="ref-for-match-an-attribution-sources-filter-data-against-filters-isnegated①">isNegated</a> set to true is false, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#iteration-continue" id="ref-for-iteration-continue③">continue</a>.</p>
      <li data-md>
       <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate" id="ref-for-list-iterate⑤">For each</a> <var>sourceKey</var> of <var>triggerData</var>’s <a data-link-type="dfn" href="#aggregatable-trigger-data-source-keys" id="ref-for-aggregatable-trigger-data-source-keys②">source keys</a>:</p>
       <ol>
        <li data-md>
         <p>If <var>aggregationKeys</var>[<var>sourceKey</var>] does not <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists②③">exist</a>, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#iteration-continue" id="ref-for-iteration-continue④">continue</a>.</p>
        <li data-md>
         <p>Set <var>aggregationKeys</var>[<var>sourceKey</var>] to <var>aggregationKeys</var>[<var>sourceKey</var>] XOR <var>triggerData</var>’s <a data-link-type="dfn" href="#aggregatable-trigger-data-key-piece" id="ref-for-aggregatable-trigger-data-key-piece①">key piece</a>.</p>
       </ol>
     </ol>
    <li data-md>
     <p>Let <var>aggregatableValues</var> be <var>trigger</var>’s <a data-link-type="dfn" href="#attribution-trigger-aggregatable-values" id="ref-for-attribution-trigger-aggregatable-values②">aggregatable values</a>.</p>
    <li data-md>
     <p>Let <var>contributions</var> be a new empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list⑥">list</a>.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-iterate" id="ref-for-map-iterate⑥">For each</a> <var>id</var> → <var>key</var> of <var>aggregationKeys</var>:</p>
     <ol>
      <li data-md>
       <p>If <var>aggregatableValues</var>[<var>id</var>] does not <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists②④">exist</a>, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#iteration-continue" id="ref-for-iteration-continue⑤">continue</a>.</p>
      <li data-md>
       <p>Let <var>contribution</var> be a new <a data-link-type="dfn" href="#aggregatable-contribution" id="ref-for-aggregatable-contribution①">aggregatable contribution</a> with the items:</p>
       <dl>
        <dt data-md><a data-link-type="dfn" href="#aggregatable-contribution-key" id="ref-for-aggregatable-contribution-key">key</a>
        <dd data-md>
         <p><var>key</var></p>
        <dt data-md><a data-link-type="dfn" href="#aggregatable-contribution-value" id="ref-for-aggregatable-contribution-value">value</a>
        <dd data-md>
         <p><var>aggregatableValues</var>[<var>id</var>]</p>
       </dl>
      <li data-md>
       <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append" id="ref-for-list-append①">Append</a> <var>contribution</var> to <var>contributions</var>.</p>
     </ol>
    <li data-md>
     <p>Return <var>contributions</var>.</p>
   </ol>
   <p class="issue" id="issue-67aec5eb"><a class="self-link" href="#issue-67aec5eb"></a> Use <a data-link-type="dfn" href="#create-aggregatable-contributions" id="ref-for-create-aggregatable-contributions">create aggregatable contributions</a> in <a data-link-type="dfn" href="#trigger-attribution" id="ref-for-trigger-attribution">trigger attribution</a>.</p>
   <h3 class="heading settled algorithm" data-algorithm="Triggering attribution" data-level="10.6" id="triggering-attribution"><span class="secno">10.6. </span><span class="content">Triggering attribution</span><a class="self-link" href="#triggering-attribution"></a></h3>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="trigger-attribution">trigger attribution</dfn> given an <a data-link-type="dfn" href="#attribution-trigger" id="ref-for-attribution-trigger①⓪">attribution trigger</a> <var>trigger</var> run the following steps:</p>
   <ol>
    <li data-md>
     <p>Let <var>attributionDestination</var> be <var>trigger</var>’s <a data-link-type="dfn" href="#attribution-trigger-attribution-destination" id="ref-for-attribution-trigger-attribution-destination③">attribution destination</a>.</p>
    <li data-md>
     <p>Let <var>matchingSources</var> be all entries in the <a data-link-type="dfn" href="#attribution-source-cache" id="ref-for-attribution-source-cache④">attribution source cache</a> where all of the following are true:</p>
     <ul>
      <li data-md>
       <p>entry’s <a data-link-type="dfn" href="#attribution-source-attribution-destination" id="ref-for-attribution-source-attribution-destination①②">attribution destination</a> and <var>attributionDestination</var> are equal.</p>
      <li data-md>
       <p>entry’s <a data-link-type="dfn" href="#attribution-source-reporting-endpoint" id="ref-for-attribution-source-reporting-endpoint⑦">reporting endpoint</a> and <var>trigger</var>’s <a data-link-type="dfn" href="#attribution-trigger-reporting-endpoint" id="ref-for-attribution-trigger-reporting-endpoint④">reporting endpoint</a> are <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#same-origin" id="ref-for-same-origin③">same origin</a>.</p>
      <li data-md>
       <p>entry’s <a data-link-type="dfn" href="#attribution-source-expiry-time" id="ref-for-attribution-source-expiry-time①">expiry time</a> is greater than the current time.</p>
     </ul>
    <li data-md>
     <p>If <var>matchingSources</var> is empty, return.</p>
    <li data-md>
     <p>Set <var>matchingSources</var> to the result of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-sort-in-descending-order" id="ref-for-list-sort-in-descending-order">sorting</a> <var>matchingSources</var> in descending order, with <var>a</var> being less than <var>b</var> if any of the following are true:</p>
     <ul>
      <li data-md>
       <p><var>a</var>’s <a data-link-type="dfn" href="#attribution-source-priority" id="ref-for-attribution-source-priority①">priority</a> is less than <var>b</var>’s <a data-link-type="dfn" href="#attribution-source-priority" id="ref-for-attribution-source-priority②">priority</a>.</p>
      <li data-md>
       <p><var>a</var>’s <a data-link-type="dfn" href="#attribution-source-priority" id="ref-for-attribution-source-priority③">priority</a> is equal to <var>b</var>’s <a data-link-type="dfn" href="#attribution-source-priority" id="ref-for-attribution-source-priority④">priority</a> and <var>a</var>’s <a data-link-type="dfn" href="#attribution-source-source-time" id="ref-for-attribution-source-source-time④">source time</a> is less than <var>b</var>’s <a data-link-type="dfn" href="#attribution-source-source-time" id="ref-for-attribution-source-source-time⑤">source time</a>.</p>
     </ul>
    <li data-md>
     <p>Let <var>sourceToAttribute</var> be the first item in <var>matchingSources</var>.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert⑤">Assert</a>: <var>sourceToAttribute</var>’s <a data-link-type="dfn" href="#attribution-source-randomized-response" id="ref-for-attribution-source-randomized-response④">randomized response</a> is
null or an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-is-empty" id="ref-for-list-is-empty①⓪">empty</a> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set①⑧">set</a>.</p>
    <li data-md>
     <p>If the result of running <a data-link-type="dfn" href="#match-an-attribution-sources-filter-data-against-filters" id="ref-for-match-an-attribution-sources-filter-data-against-filters②">match an attribution source’s filter data against filters</a> with <var>sourceToAttribute</var>, <var>trigger</var>’s <a data-link-type="dfn" href="#attribution-trigger-filters" id="ref-for-attribution-trigger-filters②">filters</a>, and <a data-link-type="dfn" href="#match-an-attribution-sources-filter-data-against-filters-isnegated" id="ref-for-match-an-attribution-sources-filter-data-against-filters-isnegated②">isNegated</a> set to false is false, return.</p>
    <li data-md>
     <p>If the result of running <a data-link-type="dfn" href="#match-an-attribution-sources-filter-data-against-filters" id="ref-for-match-an-attribution-sources-filter-data-against-filters③">match an attribution source’s filter data against filters</a> with <var>sourceToAttribute</var>, <var>trigger</var>’s <a data-link-type="dfn" href="#attribution-trigger-negated-filters" id="ref-for-attribution-trigger-negated-filters①">negated filters</a>, and <a data-link-type="dfn" href="#match-an-attribution-sources-filter-data-against-filters-isnegated" id="ref-for-match-an-attribution-sources-filter-data-against-filters-isnegated③">isNegated</a> set to true is false, return.</p>
    <li data-md>
     <p>Let <var>matchedConfig</var> be null.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-iterate" id="ref-for-map-iterate⑦">For each</a> <a data-link-type="dfn" href="#event-level-trigger-configuration" id="ref-for-event-level-trigger-configuration③">event-level trigger configuration</a> <var>config</var> of <var>trigger</var>’s <a data-link-type="dfn" href="#attribution-trigger-event-level-trigger-configurations" id="ref-for-attribution-trigger-event-level-trigger-configurations②">event-level trigger configurations</a>:</p>
     <ol>
      <li data-md>
       <p>If the result of running <a data-link-type="dfn" href="#match-an-attribution-sources-filter-data-against-filters" id="ref-for-match-an-attribution-sources-filter-data-against-filters④">match an attribution source’s filter data against filters</a> with <var>sourceToAttribute</var>, <var>config</var>’s <a data-link-type="dfn" href="#event-level-trigger-configuration-filters" id="ref-for-event-level-trigger-configuration-filters②">filters</a>, and <a data-link-type="dfn" href="#match-an-attribution-sources-filter-data-against-filters-isnegated" id="ref-for-match-an-attribution-sources-filter-data-against-filters-isnegated④">isNegated</a> set to false is false, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#iteration-continue" id="ref-for-iteration-continue⑥">continue</a>.</p>
      <li data-md>
       <p>If the result of running <a data-link-type="dfn" href="#match-an-attribution-sources-filter-data-against-filters" id="ref-for-match-an-attribution-sources-filter-data-against-filters⑤">match an attribution source’s filter data against filters</a> with <var>sourceToAttribute</var>, <var>config</var>’s <a data-link-type="dfn" href="#event-level-trigger-configuration-negated-filters" id="ref-for-event-level-trigger-configuration-negated-filters①">negated filters</a>, and <a data-link-type="dfn" href="#match-an-attribution-sources-filter-data-against-filters-isnegated" id="ref-for-match-an-attribution-sources-filter-data-against-filters-isnegated⑤">isNegated</a> set to true is false, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#iteration-continue" id="ref-for-iteration-continue⑦">continue</a>.</p>
      <li data-md>
       <p>Set <var>matchedConfig</var> to <var>config</var>.</p>
      <li data-md>
       <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#iteration-break" id="ref-for-iteration-break">Break</a>.</p>
     </ol>
    <li data-md>
     <p>If <var>matchedConfig</var> is null, return.</p>
    <li data-md>
     <p>If <var>matchedConfig</var>’s <a data-link-type="dfn" href="#event-level-trigger-configuration-dedup-key" id="ref-for-event-level-trigger-configuration-dedup-key③">dedup key</a> is not null and <var>sourceToAttribute</var>’s <a data-link-type="dfn" href="#attribution-source-dedup-keys" id="ref-for-attribution-source-dedup-keys">dedup keys</a> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-contain" id="ref-for-list-contain②">contains</a> it, return.</p>
    <li data-md>
     <p>Let <var>numMatchingReports</var> be the number of entries in the <a data-link-type="dfn" href="#event-level-report-cache" id="ref-for-event-level-report-cache③">event-level report cache</a> whose <a data-link-type="dfn" href="#event-level-report-attribution-destination" id="ref-for-event-level-report-attribution-destination①">attribution destination</a> equals <var>attributionDestination</var>.</p>
    <li data-md>
     <p>If <var>numMatchingReports</var> is greater than or equal to the user agent’s <a data-link-type="dfn" href="#max-reports-per-attribution-destination" id="ref-for-max-reports-per-attribution-destination①">max reports per attribution destination</a>, return.</p>
    <li data-md>
     <p>If the result of running <a data-link-type="dfn" href="#should-rate-limit-attribution" id="ref-for-should-rate-limit-attribution①">should attribution be blocked by rate limit</a> with <var>trigger</var> and <var>sourceToAttribute</var> is <strong>blocked</strong>, return.</p>
    <li data-md>
     <p>Let <var>rateLimitRecord</var> be a new <a data-link-type="dfn" href="#attribution-rate-limit-record" id="ref-for-attribution-rate-limit-record⑤">attribution rate-limit record</a> with the items:</p>
     <dl>
      <dt data-md><a data-link-type="dfn" href="#attribution-rate-limit-record-scope" id="ref-for-attribution-rate-limit-record-scope⑤">scope</a>
      <dd data-md>
       <p>"<code>attribution</code>"</p>
      <dt data-md><a data-link-type="dfn" href="#attribution-rate-limit-record-source-site" id="ref-for-attribution-rate-limit-record-source-site⑦">source site</a>
      <dd data-md>
       <p><var>sourceToAttribute</var>’s <a data-link-type="dfn" href="#attribution-source-source-site" id="ref-for-attribution-source-source-site⑤">source site</a></p>
      <dt data-md><a data-link-type="dfn" href="#attribution-rate-limit-record-attribution-destination" id="ref-for-attribution-rate-limit-record-attribution-destination⑦">attribution destination</a>
      <dd data-md>
       <p><var>attributionDestination</var></p>
      <dt data-md><a data-link-type="dfn" href="#attribution-rate-limit-record-reporting-endpoint" id="ref-for-attribution-rate-limit-record-reporting-endpoint⑤">reporting endpoint</a>
      <dd data-md>
       <p><var>sourceToAttribute</var>’s <a data-link-type="dfn" href="#attribution-source-reporting-endpoint" id="ref-for-attribution-source-reporting-endpoint⑧">reporting endpoint</a></p>
      <dt data-md><a data-link-type="dfn" href="#attribution-rate-limit-record-time" id="ref-for-attribution-rate-limit-record-time⑤">time</a>
      <dd data-md>
       <p><var>trigger</var>’s <a data-link-type="dfn" href="#attribution-trigger-trigger-time" id="ref-for-attribution-trigger-trigger-time③">trigger time</a></p>
     </dl>
    <li data-md>
     <p>If the result of running <a data-link-type="dfn" href="#should-block-processing-for-reporting-endpoint-limit" id="ref-for-should-block-processing-for-reporting-endpoint-limit①">should processing be blocked by reporting-endpoint limit</a> with <var>rateLimitRecord</var> is <strong>blocked</strong>, return.</p>
    <li data-md>
     <p>Let <var>report</var> be the result of running <a data-link-type="dfn" href="#obtain-an-event-level-report" id="ref-for-obtain-an-event-level-report①">obtain an event-level report</a> with <var>sourceToAttribute</var>, <var>trigger</var>,
and <var>matchedConfig</var>.</p>
    <li data-md>
     <p>Let <var>maxAttributionsPerSource</var> be the user agent’s <a data-link-type="dfn" href="#max-attributions-per-navigation-source" id="ref-for-max-attributions-per-navigation-source①">max attributions per navigation source</a>.</p>
    <li data-md>
     <p>If <var>sourceToAttribute</var>’s <a data-link-type="dfn" href="#attribution-source-source-type" id="ref-for-attribution-source-source-type⑧">source type</a> is "<code>event</code>", set <var>maxAttributionsPerSource</var> to the user agent’s <a data-link-type="dfn" href="#max-attributions-per-event-source" id="ref-for-max-attributions-per-event-source①">max attributions per event source</a>.</p>
    <li data-md>
     <p>If <var>sourceToAttribute</var>’s <a data-link-type="dfn" href="#attribution-source-number-of-event-level-reports" id="ref-for-attribution-source-number-of-event-level-reports①">number of event-level reports</a> value is equal to <var>maxAttributionsPerSource</var>, then:</p>
     <ol>
      <li data-md>
       <p>Let <var>matchingReports</var> be all entries in the <a data-link-type="dfn" href="#event-level-report-cache" id="ref-for-event-level-report-cache④">event-level report cache</a> where all of the following are true:</p>
       <ul>
        <li data-md>
         <p>entry’s <a data-link-type="dfn" href="#event-level-report-report-time" id="ref-for-event-level-report-report-time①">report time</a> and <var>report</var>’s <a data-link-type="dfn" href="#event-level-report-report-time" id="ref-for-event-level-report-report-time②">report time</a> are equal.</p>
        <li data-md>
         <p>entry’s <a data-link-type="dfn" href="#event-level-report-source-identifier" id="ref-for-event-level-report-source-identifier">source identifier</a> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string-is" id="ref-for-string-is">is</a> <var>report</var>’s <a data-link-type="dfn" href="#event-level-report-source-identifier" id="ref-for-event-level-report-source-identifier①">source identifier</a></p>
       </ul>
      <li data-md>
       <p>If <var>matchingReports</var> is empty, then <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-remove" id="ref-for-list-remove②">remove</a> <var>sourceToAttribute</var> from the <a data-link-type="dfn" href="#attribution-source-cache" id="ref-for-attribution-source-cache⑤">attribution source cache</a> and return.</p>
      <li data-md>
       <p>Set <var>matchingReports</var> to the result of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-sort-in-ascending-order" id="ref-for-list-sort-in-ascending-order">sorting</a> <var>matchingReports</var> in ascending order, with <var>a</var> being less than <var>b</var> if any of the following are true:</p>
       <ul>
        <li data-md>
         <p><var>a</var>’s <a data-link-type="dfn" href="#event-level-report-trigger-priority" id="ref-for-event-level-report-trigger-priority">trigger priority</a> is less than <var>b</var>’s <a data-link-type="dfn" href="#event-level-report-trigger-priority" id="ref-for-event-level-report-trigger-priority①">trigger priority</a>.</p>
        <li data-md>
         <p><var>a</var>’s <a data-link-type="dfn" href="#event-level-report-trigger-priority" id="ref-for-event-level-report-trigger-priority②">trigger priority</a> is equal to <var>b</var>’s <a data-link-type="dfn" href="#event-level-report-trigger-priority" id="ref-for-event-level-report-trigger-priority③">trigger priority</a> and <var>a</var>’s <a data-link-type="dfn" href="#event-level-report-trigger-time" id="ref-for-event-level-report-trigger-time">trigger time</a> is greater than <var>b</var>’s <a data-link-type="dfn" href="#event-level-report-trigger-time" id="ref-for-event-level-report-trigger-time①">trigger time</a>.</p>
       </ul>
      <li data-md>
       <p>Let <var>lowestPriorityReport</var> be the first item in <var>matchingReports</var>.</p>
      <li data-md>
       <p>If <var>report</var>’s <a data-link-type="dfn" href="#event-level-report-trigger-priority" id="ref-for-event-level-report-trigger-priority④">trigger priority</a> is less than or equal to <var>lowestPriorityReport</var>’s <a data-link-type="dfn" href="#event-level-report-trigger-priority" id="ref-for-event-level-report-trigger-priority⑤">trigger priority</a>, return.</p>
      <li data-md>
       <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-remove" id="ref-for-list-remove③">Remove</a> <var>lowestPriorityReport</var> from the <a data-link-type="dfn" href="#event-level-report-cache" id="ref-for-event-level-report-cache⑤">event-level report cache</a>.</p>
      <li data-md>
       <p>Decrement <var>sourceToAttribute</var>’s <a data-link-type="dfn" href="#attribution-source-number-of-event-level-reports" id="ref-for-attribution-source-number-of-event-level-reports②">number of event-level reports</a> value by 1.</p>
     </ol>
    <li data-md>
     <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-remove" id="ref-for-list-remove④">Remove</a> <var>sourceToAttribute</var> from <var>matchingSources</var>.</p>
    <li data-md>
     <p>For each <var>item</var> of <var>matchingSources</var>:</p>
     <ol>
      <li data-md>
       <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-remove" id="ref-for-list-remove⑤">Remove</a> <var>item</var> from the <a data-link-type="dfn" href="#attribution-source-cache" id="ref-for-attribution-source-cache⑥">attribution source cache</a>.</p>
     </ol>
    <li data-md>
     <p>If the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-size" id="ref-for-list-size①②">size</a> of the <a data-link-type="dfn" href="#event-level-report-cache" id="ref-for-event-level-report-cache⑥">event-level report cache</a> is greater than or equal to the user
agent’s <a data-link-type="dfn" href="#max-report-cache-size" id="ref-for-max-report-cache-size">max report cache size</a>, return.</p>
    <li data-md>
     <p>If <var>sourceToAttribute</var>’s <a data-link-type="dfn" href="#attribution-source-randomized-response" id="ref-for-attribution-source-randomized-response⑤">randomized response</a> is
null, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#set-append" id="ref-for-set-append①⓪">append</a> <var>report</var> to the <a data-link-type="dfn" href="#event-level-report-cache" id="ref-for-event-level-report-cache⑦">event-level report cache</a>.</p>
    <li data-md>
     <p>Increment <var>sourceToAttribute</var>’s <a data-link-type="dfn" href="#attribution-source-number-of-event-level-reports" id="ref-for-attribution-source-number-of-event-level-reports③">number of event-level reports</a> value by 1.</p>
    <li data-md>
     <p>If <var>matchedConfig</var>’s <a data-link-type="dfn" href="#event-level-trigger-configuration-dedup-key" id="ref-for-event-level-trigger-configuration-dedup-key④">dedup key</a> is not null, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append" id="ref-for-list-append②">append</a> it to <var>sourceToAttribute</var>’s <a data-link-type="dfn" href="#attribution-source-dedup-keys" id="ref-for-attribution-source-dedup-keys①">dedup keys</a>.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#set-append" id="ref-for-set-append①①">Append</a> <var>rateLimitRecord</var> to the <a data-link-type="dfn" href="#attribution-rate-limit-cache" id="ref-for-attribution-rate-limit-cache④">attribution rate-limit cache</a>.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-remove" id="ref-for-list-remove⑥">Remove</a> all entries from the <a data-link-type="dfn" href="#attribution-rate-limit-cache" id="ref-for-attribution-rate-limit-cache⑤">attribution rate-limit cache</a> whose <a data-link-type="dfn" href="#attribution-rate-limit-record-time" id="ref-for-attribution-rate-limit-record-time⑥">time</a> is at least <a data-link-type="dfn" href="#attribution-rate-limit-window" id="ref-for-attribution-rate-limit-window⑥">attribution rate-limit window</a> before the current time.</p>
    <li data-md>
     <p>If <var>report</var>’s <a data-link-type="dfn" href="#event-level-report-source-debug-key" id="ref-for-event-level-report-source-debug-key">source debug key</a> is not null and <var>report</var>’s <a data-link-type="dfn" href="#event-level-report-trigger-debug-key" id="ref-for-event-level-report-trigger-debug-key">trigger debug key</a> is not null, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task" id="ref-for-queue-a-task①">queue a task</a> to <a data-link-type="dfn" href="#attempt-to-deliver-a-debug-report" id="ref-for-attempt-to-deliver-a-debug-report">attempt to deliver a debug report</a> with <var>report</var>.</p>
   </ol>
   <h3 class="heading settled algorithm" data-algorithm="Establishing report delivery time" data-level="10.7" id="delivery-time"><span class="secno">10.7. </span><span class="content">Establishing report delivery time</span><a class="self-link" href="#delivery-time"></a></h3>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="obtain-an-expiry-deadline">obtain an expiry deadline</dfn> given an <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-source③⑤">attribution source</a> <var>source</var>:</p>
   <ol>
    <li data-md>
     <p>Return the maximum of <var>source</var>’s <a data-link-type="dfn" href="#attribution-source-expiry" id="ref-for-attribution-source-expiry③">expiry</a> and 2 days
(172800 seconds).</p>
   </ol>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="obtain-early-deadlines">obtain early deadlines</dfn> given a <a data-link-type="dfn" href="#source-type" id="ref-for-source-type③">source type</a> <var>sourceType</var>:</p>
   <ol>
    <li data-md>
     <p>If <var>sourceType</var> is "<code>event</code>", return «».</p>
    <li data-md>
     <p>Return « (2 days - 1 hour), (7 days - 1 hour) ».</p>
   </ol>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="obtain-the-number-of-report-windows">obtain the number of report windows</dfn> given a <a data-link-type="dfn" href="#source-type" id="ref-for-source-type④">source type</a> <var>sourceType</var>:</p>
   <ol>
    <li data-md>
     <p>Let <var>earlyDeadlines</var> be the result of running <a data-link-type="dfn" href="#obtain-early-deadlines" id="ref-for-obtain-early-deadlines">obtain early deadlines</a> with <var>sourceType</var>.</p>
    <li data-md>
     <p>Return the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-size" id="ref-for-list-size①③">size</a> of <var>earlyDeadlines</var> + 1.</p>
   </ol>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="obtain-a-report-time-from-deadline">obtain a report time from deadline</dfn> given a time <var>sourceTime</var> and
a length of time <var>deadline</var>:</p>
   <ol>
    <li data-md>
     <p>Return <var>sourceTime</var> + <var>deadline</var> + 1 hour.</p>
   </ol>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="obtain-the-report-time-at-a-window">obtain the report time at a window</dfn> given an <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-source③⑥">attribution source</a> <var>source</var> and a non-negative integer <var>window</var>:</p>
   <ol>
    <li data-md>
     <p>Let <var>earlyDeadlines</var> be the result of running <a data-link-type="dfn" href="#obtain-early-deadlines" id="ref-for-obtain-early-deadlines①">obtain early deadlines</a> with <var>source</var>’s <a data-link-type="dfn" href="#attribution-source-source-type" id="ref-for-attribution-source-source-type⑨">source type</a>.</p>
    <li data-md>
     <p>Let <var>deadline</var> be the result of running <a data-link-type="dfn" href="#obtain-an-expiry-deadline" id="ref-for-obtain-an-expiry-deadline">obtain an expiry deadline</a> with <var>source</var>.</p>
    <li data-md>
     <p>If <var>earlyDeadlines</var>[<var>window</var>] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-contain" id="ref-for-list-contain③">exists</a>, set <var>deadline</var> to it.</p>
    <li data-md>
     <p>Return the result of running <a data-link-type="dfn" href="#obtain-a-report-time-from-deadline" id="ref-for-obtain-a-report-time-from-deadline">obtain a report time from deadline</a> with <var>source</var>’s <a data-link-type="dfn" href="#attribution-source-source-time" id="ref-for-attribution-source-source-time⑥">source time</a> and <var>deadline</var>.</p>
   </ol>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="obtain-an-event-level-report-delivery-time">obtain an event-level report delivery time</dfn> given an <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-source③⑦">attribution source</a> <var>source</var> and a time <var>triggerTime</var>:</p>
   <ol>
    <li data-md>
     <p>Let <var>deadlineToUse</var> be the result of running <a data-link-type="dfn" href="#obtain-an-expiry-deadline" id="ref-for-obtain-an-expiry-deadline①">obtain an expiry deadline</a> with <var>source</var>.</p>
    <li data-md>
     <p>Let <var>earlyDeadlines</var> be the result of running <a data-link-type="dfn" href="#obtain-early-deadlines" id="ref-for-obtain-early-deadlines②">obtain early deadlines</a> with <var>source</var>’s <a data-link-type="dfn" href="#attribution-source-source-type" id="ref-for-attribution-source-source-type①⓪">source type</a>.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate" id="ref-for-list-iterate⑥">For each</a> <var>earlyDeadline</var> of <var>earlyDeadlines</var>:</p>
     <ol>
      <li data-md>
       <p>Let <var>time</var> be <var>source</var>’s <a data-link-type="dfn" href="#attribution-source-source-time" id="ref-for-attribution-source-source-time⑦">source time</a> + <var>earlyDeadline</var>.</p>
      <li data-md>
       <p>If <var>time</var> is less than <var>triggerTime</var>, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#iteration-continue" id="ref-for-iteration-continue⑧">continue</a>.</p>
      <li data-md>
       <p>If <var>earlyDeadline</var> is greater than or equal to <var>deadlineToUse</var>, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#iteration-continue" id="ref-for-iteration-continue⑨">continue</a>.</p>
      <li data-md>
       <p>Set <var>deadlineToUse</var> to <var>earlyDeadline</var>.</p>
      <li data-md>
       <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#iteration-break" id="ref-for-iteration-break①">Break</a>.</p>
     </ol>
    <li data-md>
     <p>Return the result of running <a data-link-type="dfn" href="#obtain-a-report-time-from-deadline" id="ref-for-obtain-a-report-time-from-deadline①">obtain a report time from deadline</a> with <var>source</var>’s <a data-link-type="dfn" href="#attribution-source-source-time" id="ref-for-attribution-source-source-time⑧">source time</a> and <var>deadlineToUse</var>.</p>
   </ol>
   <h3 class="heading settled algorithm" data-algorithm="Obtaining an event-level report" data-level="10.8" id="obtaining-an-event-level-report"><span class="secno">10.8. </span><span class="content">Obtaining an event-level report</span><a class="self-link" href="#obtaining-an-event-level-report"></a></h3>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="obtain-an-event-level-report">obtain an event-level report</dfn> given an <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-source③⑧">attribution source</a> <var>source</var>, an <a data-link-type="dfn" href="#attribution-trigger" id="ref-for-attribution-trigger①①">attribution trigger</a> <var>trigger</var>, and an <a data-link-type="dfn" href="#event-level-trigger-configuration" id="ref-for-event-level-trigger-configuration④">event-level trigger configuration</a> <var>config</var>:</p>
   <ol>
    <li data-md>
     <p>Let <var>triggerDataCardinality</var> be the user agent’s <a data-link-type="dfn" href="#navigation-source-trigger-data-cardinality" id="ref-for-navigation-source-trigger-data-cardinality②">navigation-source trigger data cardinality</a>.</p>
    <li data-md>
     <p>If <var>source</var>’s <a data-link-type="dfn" href="#attribution-source-source-type" id="ref-for-attribution-source-source-type①①">source type</a> is "<code>event</code>", set <var>triggerDataCardinality</var> to
the user agent’s <a data-link-type="dfn" href="#event-source-trigger-data-cardinality" id="ref-for-event-source-trigger-data-cardinality②">event-source trigger data cardinality</a>.</p>
    <li data-md>
     <p>Let <var>report</var> be a new <a data-link-type="dfn" href="#event-level-report" id="ref-for-event-level-report⑨">event-level report</a> struct whose items are:</p>
     <dl>
      <dt data-md><a data-link-type="dfn" href="#event-level-report-event-id" id="ref-for-event-level-report-event-id">event ID</a>
      <dd data-md>
       <p><var>source</var>’s <a data-link-type="dfn" href="#attribution-source-event-id" id="ref-for-attribution-source-event-id②">event ID</a>.</p>
      <dt data-md><a data-link-type="dfn" href="#event-level-report-trigger-data" id="ref-for-event-level-report-trigger-data">trigger data</a>
      <dd data-md>
       <p>The remainder when dividing <var>config</var>’s <a data-link-type="dfn" href="#event-level-trigger-configuration-trigger-data" id="ref-for-event-level-trigger-configuration-trigger-data⑥">trigger data</a> by <var>triggerDataCardinality</var>.</p>
      <dt data-md><a data-link-type="dfn" href="#event-level-report-randomized-trigger-rate" id="ref-for-event-level-report-randomized-trigger-rate">randomized trigger rate</a>
      <dd data-md>
       <p><var>source</var>’s <a data-link-type="dfn" href="#attribution-source-randomized-trigger-rate" id="ref-for-attribution-source-randomized-trigger-rate①">randomized trigger rate</a>.</p>
      <dt data-md><a data-link-type="dfn" href="#event-level-report-reporting-endpoint" id="ref-for-event-level-report-reporting-endpoint">reporting endpoint</a>
      <dd data-md>
       <p><var>source</var>’s <a data-link-type="dfn" href="#attribution-source-reporting-endpoint" id="ref-for-attribution-source-reporting-endpoint⑨">reporting endpoint</a>.</p>
      <dt data-md><a data-link-type="dfn" href="#event-level-report-attribution-destination" id="ref-for-event-level-report-attribution-destination②">attribution destination</a>
      <dd data-md>
       <p><var>source</var>’s <a data-link-type="dfn" href="#attribution-source-attribution-destination" id="ref-for-attribution-source-attribution-destination①③">attribution destination</a>.</p>
      <dt data-md><a data-link-type="dfn" href="#event-level-report-report-time" id="ref-for-event-level-report-report-time③">reporting time</a>
      <dd data-md>
       <p>The result of running <a data-link-type="dfn" href="#obtain-an-event-level-report-delivery-time" id="ref-for-obtain-an-event-level-report-delivery-time">obtain an event-level report delivery time</a> with <var>source</var> and <var>trigger</var>’s <a data-link-type="dfn" href="#attribution-trigger-trigger-time" id="ref-for-attribution-trigger-trigger-time④">trigger time</a>.</p>
      <dt data-md><a data-link-type="dfn" href="#event-level-report-trigger-priority" id="ref-for-event-level-report-trigger-priority⑥">trigger priority</a>
      <dd data-md>
       <p><var>config</var>’s <a data-link-type="dfn" href="#event-level-trigger-configuration-priority" id="ref-for-event-level-trigger-configuration-priority②">priority</a>.</p>
      <dt data-md><a data-link-type="dfn" href="#event-level-report-trigger-time" id="ref-for-event-level-report-trigger-time②">trigger time</a>
      <dd data-md>
       <p><var>trigger</var>’s <a data-link-type="dfn" href="#attribution-trigger-trigger-time" id="ref-for-attribution-trigger-trigger-time⑤">trigger time</a>.</p>
      <dt data-md><a data-link-type="dfn" href="#event-level-report-source-identifier" id="ref-for-event-level-report-source-identifier②">source identifier</a>
      <dd data-md>
       <p><var>source</var>’s <a data-link-type="dfn" href="#attribution-source-source-identifier" id="ref-for-attribution-source-source-identifier①">source identifier</a>.</p>
      <dt data-md><a data-link-type="dfn" href="#event-level-report-report-id" id="ref-for-event-level-report-report-id">report id</a>
      <dd data-md>
       <p>The result of <a data-link-type="dfn" href="https://wicg.github.io/uuid/#dfn-generate-a-random-uuid" id="ref-for-dfn-generate-a-random-uuid">generating a random UUID</a>.</p>
      <dt data-md><a data-link-type="dfn" href="#event-level-report-source-debug-key" id="ref-for-event-level-report-source-debug-key①">source debug key</a>
      <dd data-md>
       <p><var>source</var>’s <a data-link-type="dfn" href="#attribution-source-debug-key" id="ref-for-attribution-source-debug-key①">debug key</a>.</p>
      <dt data-md><a data-link-type="dfn" href="#event-level-report-trigger-debug-key" id="ref-for-event-level-report-trigger-debug-key①">trigger debug key</a>
      <dd data-md>
       <p><var>trigger</var>’s <a data-link-type="dfn" href="#attribution-trigger-debug-key" id="ref-for-attribution-trigger-debug-key②">debug key</a>.</p>
     </dl>
    <li data-md>
     <p>Return <var>report</var>.</p>
   </ol>
   <h2 class="heading settled" data-level="11" id="report-delivery"><span class="secno">11. </span><span class="content">Report delivery</span><a class="self-link" href="#report-delivery"></a></h2>
   <p>The user agent MUST periodically <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate" id="ref-for-list-iterate⑦">iterate</a> over its <a data-link-type="dfn" href="#event-level-report-cache" id="ref-for-event-level-report-cache⑧">event-level report cache</a> and run <a data-link-type="dfn" href="#queue-a-report-for-delivery" id="ref-for-queue-a-report-for-delivery">queue a report for delivery</a> on each item.</p>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="queue-a-report-for-delivery">queue a report for delivery</dfn> given an <a data-link-type="dfn" href="#event-level-report" id="ref-for-event-level-report①⓪">event-level report</a> <var>report</var>, run the following steps <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel" id="ref-for-in-parallel">in parallel</a>:</p>
   <ol>
    <li data-md>
     <p>If <var>report</var>’s <a data-link-type="dfn" href="#event-level-report-delivered" id="ref-for-event-level-report-delivered">delivered</a> value is true, return.</p>
    <li data-md>
     <p>Set <var>report</var>’s <a data-link-type="dfn" href="#event-level-report-delivered" id="ref-for-event-level-report-delivered①">delivered</a> value to true.</p>
    <li data-md>
     <p>If <var>report</var>’s <a data-link-type="dfn" href="#event-level-report-report-time" id="ref-for-event-level-report-report-time④">report time</a> is less than the current time, add an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#implementation-defined" id="ref-for-implementation-defined">implementation-defined</a> random amount to report time.</p>
     <p class="note" role="note"><span>Note:</span> On startup, it is possible the user agent will need to send many reports whose report times passed while the browser was
 closed. Adding random delay prevents temporal joining of reports from different <a data-link-type="dfn" href="#attribution-source-source-origin" id="ref-for-attribution-source-source-origin⑤">source origin</a>s.</p>
    <li data-md>
     <p>Wait until <var>report</var>’s <a data-link-type="dfn" href="#event-level-report-report-time" id="ref-for-event-level-report-report-time⑤">report time</a> is the current time.</p>
    <li data-md>
     <p>Optionally, wait a further <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#implementation-defined" id="ref-for-implementation-defined①">implementation-defined</a> length of time.</p>
     <p class="note" role="note"><span>Note:</span> This is intended to allow user agents to optimize device resource usage.</p>
    <li data-md>
     <p>Run <a data-link-type="dfn" href="#attempt-to-deliver-a-report" id="ref-for-attempt-to-deliver-a-report">attempt to deliver a report</a> with <var>report</var>.</p>
   </ol>
   <h3 class="heading settled" data-level="11.1" id="serialize-integer"><span class="secno">11.1. </span><span class="content">Serialize an integer</span><a class="self-link" href="#serialize-integer"></a></h3>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="serialize-an-integer">serialize an integer</dfn>, represent it as a string of the shortest possible decimal number.</p>
   <p class="issue" id="issue-ccb90c6c"><a class="self-link" href="#issue-ccb90c6c"></a> This would ideally be replaced by a more descriptive algorithm in Infra. See <a href="https://github.com/whatwg/infra/issues/201">infra/201</a></p>
   <h3 class="heading settled" data-level="11.2" id="serialize-report-body"><span class="secno">11.2. </span><span class="content">Serialize attribution report body</span><a class="self-link" href="#serialize-report-body"></a></h3>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="serialize-an-event-level-report">serialize an <a data-link-type="dfn" href="#event-level-report" id="ref-for-event-level-report①①">event-level report</a></dfn> <var>report</var>, run the following steps:</p>
   <ol>
    <li data-md>
     <p>Let <var>destination</var> be <var>report</var>’s <a data-link-type="dfn" href="#event-level-report-attribution-destination" id="ref-for-event-level-report-attribution-destination③">attribution destination</a>.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert⑥">Assert</a>: <var>destination</var> is not an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin-opaque" id="ref-for-concept-origin-opaque">opaque origin</a>.</p>
    <li data-md>
     <p>Let <var>data</var> be a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map①⑥">map</a> of the following key/value pairs:</p>
     <dl>
      <dt data-md>"<code>attribution_destination</code>"
      <dd data-md>
       <p><var>destination</var>, <a href="https://html.spec.whatwg.org/multipage/origin.html#serialization-of-a-site">serialized</a></p>
      <dt data-md>"<code>randomized_trigger_rate</code>"
      <dd data-md>
       <p><var>report</var>’s <a data-link-type="dfn" href="#event-level-report-randomized-trigger-rate" id="ref-for-event-level-report-randomized-trigger-rate①">randomized trigger rate</a></p>
      <dt data-md>"<code>source_type</code>"
      <dd data-md>
       <p><var>report</var>’s <a data-link-type="dfn" href="#event-level-report-source-type" id="ref-for-event-level-report-source-type">source type</a></p>
      <dt data-md>"<code>source_event_id</code>"
      <dd data-md>
       <p><var>report</var>’s <a data-link-type="dfn" href="#event-level-report-event-id" id="ref-for-event-level-report-event-id①">event ID</a>, <a data-link-type="dfn" href="#serialize-an-integer" id="ref-for-serialize-an-integer">serialized</a></p>
      <dt data-md>"<code>trigger_data</code>"
      <dd data-md>
       <p><var>report</var>’s <a data-link-type="dfn" href="#event-level-report-trigger-data" id="ref-for-event-level-report-trigger-data①">trigger data</a>, <a data-link-type="dfn" href="#serialize-an-integer" id="ref-for-serialize-an-integer①">serialized</a></p>
      <dt data-md>"<code>report_id</code>"
      <dd data-md>
       <p><var>report</var>’s <a data-link-type="dfn" href="#event-level-report-report-id" id="ref-for-event-level-report-report-id①">report ID</a></p>
     </dl>
    <li data-md>
     <p>If <var>report</var>’s <a data-link-type="dfn" href="#event-level-report-source-debug-key" id="ref-for-event-level-report-source-debug-key②">source debug key</a> is not null, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-set" id="ref-for-map-set③">set</a> <var>data</var>["<code>source_debug_key</code>"] to <var>report</var>’s <a data-link-type="dfn" href="#event-level-report-source-debug-key" id="ref-for-event-level-report-source-debug-key③">source debug key</a>, <a data-link-type="dfn" href="#serialize-an-integer" id="ref-for-serialize-an-integer②">serialized</a>.</p>
    <li data-md>
     <p>If <var>report</var>’s <a data-link-type="dfn" href="#event-level-report-trigger-debug-key" id="ref-for-event-level-report-trigger-debug-key②">trigger debug key</a> is not null, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-set" id="ref-for-map-set④">set</a> <var>data</var>["<code>trigger_debug_key</code>"] to <var>report</var>’s <a data-link-type="dfn" href="#event-level-report-trigger-debug-key" id="ref-for-event-level-report-trigger-debug-key③">trigger debug key</a>, <a data-link-type="dfn" href="#serialize-an-integer" id="ref-for-serialize-an-integer③">serialized</a>.</p>
    <li data-md>
     <p>Return the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence" id="ref-for-byte-sequence">byte sequence</a> resulting from executing <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#serialize-an-infra-value-to-json-bytes" id="ref-for-serialize-an-infra-value-to-json-bytes">serialize an infra value to JSON bytes</a> on <var>data</var>.</p>
   </ol>
   <p class="note" role="note"><span>Note:</span> The inclusion of "<code>report_id</code>" in the report body is intended to allow the report recipient
to perform deduplication and prevent double counting, in the event that the user agent retries
reports on failure. To prevent the report recipient from learning additional information about
whether a user is online, retries might be limited in number and subject to random delays.</p>
   <h3 class="heading settled" data-level="11.3" id="get-report-url"><span class="secno">11.3. </span><span class="content">Get report request URL</span><a class="self-link" href="#get-report-url"></a></h3>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="generate-a-report-url">generate a report URL</dfn> given a <a data-link-type="dfn" href="#event-level-report" id="ref-for-event-level-report①②">event-level report</a> <var>report</var> and an optional <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#boolean" id="ref-for-boolean②">boolean</a> <dfn class="dfn-paneled" data-dfn-for="generate a report URL" data-dfn-type="dfn" data-noexport id="generate-a-report-url-isdebugreport"><var>isDebugReport</var></dfn> (default false):</p>
   <ol>
    <li data-md>
     <p>Let <var>reportUrl</var> be a new <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url⑥">URL record</a>.</p>
    <li data-md>
     <p>Let <var>reportingOrigin</var> be <var>report</var>’s <a data-link-type="dfn" href="#event-level-report-reporting-endpoint" id="ref-for-event-level-report-reporting-endpoint①">reporting endpoint</a>.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert⑦">Assert</a>: <var>reportingOrigin</var> is not an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin-opaque" id="ref-for-concept-origin-opaque①">opaque origin</a>.</p>
    <li data-md>
     <p>Set <var>reportUrl</var>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-scheme" id="ref-for-concept-url-scheme">scheme</a> to <var>reportingOrigin</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin-scheme" id="ref-for-concept-origin-scheme①">scheme</a>.</p>
    <li data-md>
     <p>Set <var>reportUrl</var>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-host" id="ref-for-concept-url-host">host</a> to <var>reportingOrigin</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin-host" id="ref-for-concept-origin-host">host</a>.</p>
    <li data-md>
     <p>Set <var>reportUrl</var>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-port" id="ref-for-concept-url-port">port</a> to <var>reportingOrigin</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin-port" id="ref-for-concept-origin-port">port</a>.</p>
    <li data-md>
     <p>Let <var>path</var> be «"<code>.well-known</code>", "<code>attribution-reporting</code>"».</p>
    <li data-md>
     <p>If <var>isDebugReport</var> is true, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append" id="ref-for-list-append③">append</a> "<code>debug</code>" to <var>path</var>.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append" id="ref-for-list-append④">Append</a> "<code>report-event-attribution</code>" to <var>path</var>.</p>
    <li data-md>
     <p>Set <var>reportUrl</var>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-path" id="ref-for-concept-url-path">path</a> to <var>path</var>.</p>
    <li data-md>
     <p>Return <var>reportUrl</var>.</p>
   </ol>
   <h3 class="heading settled" data-level="11.4" id="create-report-request"><span class="secno">11.4. </span><span class="content">Creating a report request</span><a class="self-link" href="#create-report-request"></a></h3>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="create-a-report-request">create a report request</dfn> given an <a data-link-type="dfn" href="#event-level-report" id="ref-for-event-level-report①③">event-level report</a> <var>report</var>:</p>
   <ol>
    <li data-md>
     <p>Let <var>body</var> be the result of executing <a data-link-type="dfn" href="#serialize-an-event-level-report" id="ref-for-serialize-an-event-level-report">serialize an event-level report</a> on <var>report</var>.</p>
    <li data-md>
     <p>Let <var>request</var> be a new <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request">request</a> with the following properties:</p>
     <dl>
      <dt data-md><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-method" id="ref-for-concept-request-method">method</a>
      <dd data-md>
       <p>"<code>POST</code>"</p>
      <dt data-md><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url" id="ref-for-concept-request-url">URL</a>
      <dd data-md>
       <p><var>url</var></p>
      <dt data-md><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-header-list" id="ref-for-concept-request-header-list">header list</a>
      <dd data-md>
       <p>A new <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-list" id="ref-for-concept-header-list">header list</a> containing a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header" id="ref-for-concept-header">header</a> named
"<code>Content-Type</code>" whose value is "<code>application/json</code>"</p>
      <dt data-md><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-body" id="ref-for-concept-request-body">body</a>
      <dd data-md>
       <p>A <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-body" id="ref-for-concept-body">body</a> whose <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-body-source" id="ref-for-concept-body-source">source</a> is <var>body</var>.</p>
      <dt data-md><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-referrer" id="ref-for-concept-request-referrer">referrer</a>
      <dd data-md>
       <p>"<code>no-referrer</code>"</p>
      <dt data-md><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client" id="ref-for-concept-request-client">client</a>
      <dd data-md>
       <p><code>null</code></p>
      <dt data-md><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-window" id="ref-for-concept-request-window">window</a>
      <dd data-md>
       <p>"<code>no-window</code>"</p>
      <dt data-md><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#request-service-workers-mode" id="ref-for-request-service-workers-mode">service-workers mode</a>
      <dd data-md>
       <p>"<code>none</code>"</p>
      <dt data-md><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-initiator" id="ref-for-concept-request-initiator">initiator</a>
      <dd data-md>
       <p>""</p>
      <dt data-md><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-mode" id="ref-for-concept-request-mode">mode</a>
      <dd data-md>
       <p>"<code>cors</code>"</p>
      <dt data-md><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#unsafe-request-flag" id="ref-for-unsafe-request-flag">unsafe-request flag</a>
      <dd data-md>
       <p>set</p>
      <dt data-md><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-credentials-mode" id="ref-for-concept-request-credentials-mode">credentials mode</a>
      <dd data-md>
       <p>"<code>omit</code>"</p>
      <dt data-md><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-cache-mode" id="ref-for-concept-request-cache-mode">cache mode</a>
      <dd data-md>
       <p>"<code>no-store</code>"</p>
     </dl>
    <li data-md>
     <p>Return <var>request</var>.</p>
   </ol>
   <h3 class="heading settled" data-level="11.5" id="issue-report-request"><span class="secno">11.5. </span><span class="content">Issuing a report request</span><a class="self-link" href="#issue-report-request"></a></h3>
   <p>This algorithm constructs a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request①">request</a> and attempts to deliver it to <var>report</var>’s <a data-link-type="dfn" href="#event-level-report-reporting-endpoint" id="ref-for-event-level-report-reporting-endpoint②">reporting endpoint</a>.</p>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="attempt-to-deliver-a-report">attempt to deliver a report</dfn> given an <a data-link-type="dfn" href="#event-level-report" id="ref-for-event-level-report①④">event-level report</a> <var>report</var>, run the following steps:</p>
   <ol>
    <li data-md>
     <p>Let <var>url</var> be the result of executing <a data-link-type="dfn" href="#generate-a-report-url" id="ref-for-generate-a-report-url">generate a report URL</a> on <var>report</var>.</p>
    <li data-md>
     <p>Let <var>request</var> be the result of executing <a data-link-type="dfn" href="#create-a-report-request" id="ref-for-create-a-report-request">create a report request</a> on <var>report</var>.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task" id="ref-for-queue-a-task②">Queue a task</a> to <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-fetch" id="ref-for-concept-fetch">fetch</a> <var>request</var> with <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#process-response" id="ref-for-process-response">processResponse</a> being these steps:</p>
     <ol>
      <li data-md>
       <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task" id="ref-for-queue-a-task③">Queue a task</a> to <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-remove" id="ref-for-list-remove⑦">remove</a> <var>report</var> from the <a data-link-type="dfn" href="#event-level-report-cache" id="ref-for-event-level-report-cache⑨">event-level report cache</a>.</p>
     </ol>
   </ol>
   <p class="issue" id="issue-c8706ee1"><a class="self-link" href="#issue-c8706ee1"></a> This fetch should use a network partition key for an opaque origin. <a href="https://github.com/WICG/attribution-reporting-api/issues/220">[Issue #220]</a></p>
   <p>A user agent MAY retry this algorithm in the event that there was an error.</p>
   <h3 class="heading settled" data-level="11.6" id="issue-debug-report-request"><span class="secno">11.6. </span><span class="content">Issuing a debug report request</span><a class="self-link" href="#issue-debug-report-request"></a></h3>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="attempt-to-deliver-a-debug-report">attempt to deliver a debug report</dfn> given an <a data-link-type="dfn" href="#event-level-report" id="ref-for-event-level-report①⑤">event-level report</a> <var>report</var>:</p>
   <ol>
    <li data-md>
     <p>Let <var>url</var> be the result of executing <a data-link-type="dfn" href="#generate-a-report-url" id="ref-for-generate-a-report-url①">generate a report URL</a> on <var>report</var> with <a data-link-type="dfn" href="#generate-a-report-url-isdebugreport" id="ref-for-generate-a-report-url-isdebugreport">isDebugReport</a> set to true.</p>
    <li data-md>
     <p>Let <var>request</var> be the result of executing <a data-link-type="dfn" href="#create-a-report-request" id="ref-for-create-a-report-request①">create a report request</a> on <var>report</var>.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-fetch" id="ref-for-concept-fetch①">Fetch</a> <var>request</var>.</p>
   </ol>
   <p class="issue" id="issue-c8706ee1①"><a class="self-link" href="#issue-c8706ee1①"></a> This fetch should use a network partition key for an opaque origin. <a href="https://github.com/WICG/attribution-reporting-api/issues/220">[Issue #220]</a></p>
   <p>A user agent MAY retry this algorithm in the event that there was an error.</p>
   <h2 class="heading settled" data-level="12" id="security-considerations"><span class="secno">12. </span><span class="content">Security considerations</span><a class="self-link" href="#security-considerations"></a></h2>
    TODO 
   <h2 class="heading settled" data-level="13" id="privacy-considerations"><span class="secno">13. </span><span class="content">Privacy consideration</span><a class="self-link" href="#privacy-considerations"></a></h2>
    TODO 
   <h3 class="heading settled" data-level="13.1" id="clearing-attribution-storage"><span class="secno">13.1. </span><span class="content">Clearing attribution storage</span><a class="self-link" href="#clearing-attribution-storage"></a></h3>
   <p>A user agent’s <a data-link-type="dfn" href="#attribution-caches" id="ref-for-attribution-caches①">attribution caches</a> contain data about a user’s web activity. When a user agent clears an origin’s storage,
it MUST also <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-remove" id="ref-for-list-remove⑧">remove</a> entries in the <a data-link-type="dfn" href="#attribution-caches" id="ref-for-attribution-caches②">attribution caches</a> whose <a data-link-type="dfn" href="#attribution-source-source-origin" id="ref-for-attribution-source-source-origin⑥">source origin</a>, <a data-link-type="dfn" href="#attribution-source-attribution-destination" id="ref-for-attribution-source-attribution-destination①④">attribution destination</a>, <a data-link-type="dfn" href="#attribution-source-reporting-endpoint" id="ref-for-attribution-source-reporting-endpoint①⓪">reporting endpoint</a>, <a data-link-type="dfn" href="#event-level-report-attribution-destination" id="ref-for-event-level-report-attribution-destination④">attribution destination</a>, or <a data-link-type="dfn" href="#event-level-report-reporting-endpoint" id="ref-for-event-level-report-reporting-endpoint③">reporting endpoint</a> is the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#same-origin" id="ref-for-same-origin④">same</a> as the cleared origin.</p>
   <p>A user agent MAY clear <a data-link-type="dfn" href="#attribution-caches" id="ref-for-attribution-caches③">attribution cache</a> entries at other times. For example, when a user agent clears
an origin from a user’s browsing history.</p>
  </main>
  <div data-fill-with="conformance">
   <h2 class="no-ref no-num heading settled" id="w3c-conformance"><span class="content">Conformance</span><a class="self-link" href="#w3c-conformance"></a></h2>
   <h3 class="no-ref no-num heading settled" id="w3c-conventions"><span class="content">Document conventions</span><a class="self-link" href="#w3c-conventions"></a></h3>
   <p>Conformance requirements are expressed
    with a combination of descriptive assertions
    and RFC 2119 terminology.
    The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL”
    in the normative parts of this document
    are to be interpreted as described in RFC 2119.
    However, for readability,
    these words do not appear in all uppercase letters in this specification. </p>
   <p>All of the text of this specification is normative
    except sections explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119">[RFC2119]</a> </p>
   <p>Examples in this specification are introduced with the words “for example”
    or are set apart from the normative text
    with <code>class="example"</code>,
    like this: </p>
   <div class="example" id="w3c-example">
    <a class="self-link" href="#w3c-example"></a> 
    <p>This is an example of an informative example. </p>
   </div>
   <p>Informative notes begin with the word “Note”
    and are set apart from the normative text
    with <code>class="note"</code>,
    like this: </p>
   <p class="note" role="note">Note, this is an informative note.</p>
   <h3 class="no-ref no-num heading settled" id="w3c-conformant-algorithms"><span class="content">Conformant Algorithms</span><a class="self-link" href="#w3c-conformant-algorithms"></a></h3>
   <p>Requirements phrased in the imperative as part of algorithms
    (such as "strip any leading space characters"
    or "return false and abort these steps")
    are to be interpreted with the meaning of the key word
    ("must", "should", "may", etc)
    used in introducing the algorithm. </p>
   <p>Conformance requirements phrased as algorithms or specific steps
    can be implemented in any manner,
    so long as the end result is equivalent.
    In particular, the algorithms defined in this specification
    are intended to be easy to understand
    and are not intended to be performant.
    Implementers are encouraged to optimize. </p>
  </div>
<script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#aggregatable-contribution">Aggregatable contribution</a><span>, in § 5.9</span>
   <li><a href="#attribution-trigger-aggregatable-dedup-key">aggregatable dedup key</a><span>, in § 5.8</span>
   <li><a href="#attribution-source-aggregatable-expiry">aggregatable expiry</a><span>, in § 5.5</span>
   <li><a href="#aggregatable-trigger-data">Aggregatable trigger data</a><span>, in § 5.5</span>
   <li><a href="#attribution-trigger-aggregatable-trigger-data">aggregatable trigger data</a><span>, in § 5.8</span>
   <li><a href="#attribution-trigger-aggregatable-values">aggregatable values</a><span>, in § 5.8</span>
   <li><a href="#attribution-source-aggregation-keys">aggregation keys</a><span>, in § 5.5</span>
   <li><a href="#attempt-to-deliver-a-debug-report">attempt to deliver a debug report</a><span>, in § 11.6</span>
   <li><a href="#attempt-to-deliver-a-report">attempt to deliver a report</a><span>, in § 11.5</span>
   <li><a href="#attribution-caches">attribution caches</a><span>, in § 6</span>
   <li>
    attribution destination
    <ul>
     <li><a href="#attribution-rate-limit-record-attribution-destination">dfn for attribution rate-limit record</a><span>, in § 5.11</span>
     <li><a href="#attribution-source-attribution-destination">dfn for attribution source</a><span>, in § 5.5</span>
     <li><a href="#attribution-trigger-attribution-destination">dfn for attribution trigger</a><span>, in § 5.8</span>
     <li><a href="#event-level-report-attribution-destination">dfn for event-level report</a><span>, in § 5.9</span>
    </ul>
   <li><a href="#attribution-rate-limit-cache">attribution rate-limit cache</a><span>, in § 6</span>
   <li><a href="#attribution-rate-limit-record">Attribution rate-limit record</a><span>, in § 5.10</span>
   <li><a href="#attribution-rate-limit-window">Attribution rate-limit window</a><span>, in § 7</span>
   <li><a href="#attribution-reporting">attribution-reporting</a><span>, in § 4</span>
   <li><a href="#attribution-source">Attribution source</a><span>, in § 5.4</span>
   <li><a href="#navigation-params-attribution-source">attribution source</a><span>, in § 2.2.1</span>
   <li><a href="#attribution-source-cache">attribution source cache</a><span>, in § 6</span>
   <li><a href="#dom-htmlattributionsrcelementutils-attributionsrc">attributionSrc</a><span>, in § 2.1</span>
   <li>
    attributionsrc
    <ul>
     <li><a href="#element-attrdef-a-attributionsrc">element-attr for a</a><span>, in § 2.1</span>
     <li><a href="#element-attrdef-img-attributionsrc">element-attr for img</a><span>, in § 2.1</span>
     <li><a href="#element-attrdef-script-attributionsrc">element-attr for script</a><span>, in § 2.1</span>
    </ul>
   <li><a href="#attribution-trigger">Attribution trigger</a><span>, in § 5.7</span>
   <li><a href="#check-if-a-debug-key-is-allowed">check if a debug key is allowed</a><span>, in § 8.2</span>
   <li><a href="#check-if-an-attribution-source-exceeds-the-pending-destination-limit">check if an attribution source exceeds the pending destination limit</a><span>, in § 9.8</span>
   <li><a href="#create-aggregatable-contributions">create aggregatable contributions</a><span>, in § 10.5</span>
   <li><a href="#create-a-report-request">create a report request</a><span>, in § 11.4</span>
   <li>
    debug key
    <ul>
     <li><a href="#attribution-source-debug-key">dfn for attribution source</a><span>, in § 5.5</span>
     <li><a href="#attribution-trigger-debug-key">dfn for attribution trigger</a><span>, in § 5.8</span>
    </ul>
   <li><a href="#event-level-trigger-configuration-dedup-key">dedup key</a><span>, in § 5.7</span>
   <li><a href="#attribution-source-dedup-keys">dedup keys</a><span>, in § 5.5</span>
   <li><a href="#event-level-report-delivered">delivered</a><span>, in § 5.9</span>
   <li><a href="#does-filter-data-match">Does filter data match</a><span>, in § 10.1</span>
   <li>
    event ID
    <ul>
     <li><a href="#attribution-source-event-id">dfn for attribution source</a><span>, in § 5.5</span>
     <li><a href="#event-level-report-event-id">dfn for event-level report</a><span>, in § 5.9</span>
    </ul>
   <li><a href="#event-level-report">Event-level report</a><span>, in § 5.8</span>
   <li><a href="#event-level-report-cache">event-level report cache</a><span>, in § 6</span>
   <li><a href="#event-level-trigger-configuration">Event-level trigger configuration</a><span>, in § 5.6</span>
   <li><a href="#attribution-trigger-event-level-trigger-configurations">event-level trigger configurations</a><span>, in § 5.8</span>
   <li><a href="#event-source-trigger-data-cardinality">Event-source trigger data cardinality</a><span>, in § 7</span>
   <li><a href="#attribution-source-expiry">expiry</a><span>, in § 5.5</span>
   <li><a href="#attribution-source-expiry-time">expiry time</a><span>, in § 9.1</span>
   <li><a href="#attribution-source-filter-data">filter data</a><span>, in § 5.5</span>
   <li><a href="#filter-map">filter map</a><span>, in § 5.3</span>
   <li>
    filters
    <ul>
     <li><a href="#aggregatable-trigger-data-filters">dfn for aggregatable trigger data</a><span>, in § 5.6</span>
     <li><a href="#attribution-trigger-filters">dfn for attribution trigger</a><span>, in § 5.8</span>
     <li><a href="#event-level-trigger-configuration-filters">dfn for event-level trigger configuration</a><span>, in § 5.7</span>
    </ul>
   <li><a href="#filter-value">filter value</a><span>, in § 5.3</span>
   <li><a href="#generate-a-report-url">generate a report URL</a><span>, in § 11.3</span>
   <li><a href="#htmlattributionsrcelementutils">HTMLAttributionSrcElementUtils</a><span>, in § 2.1</span>
   <li><a href="#generate-a-report-url-isdebugreport">isDebugReport</a><span>, in § 11.3</span>
   <li><a href="#match-an-attribution-sources-filter-data-against-filters-isnegated">isNegated</a><span>, in § 10.2</span>
   <li><a href="#aggregatable-contribution-key">key</a><span>, in § 5.10</span>
   <li><a href="#aggregatable-trigger-data-key-piece">key piece</a><span>, in § 5.6</span>
   <li><a href="#match-an-attribution-sources-filter-data-against-filters">match an attribution source’s filter data against filters</a><span>, in § 10.2</span>
   <li><a href="#match-filter-values">match filter values</a><span>, in § 10.2</span>
   <li><a href="#match-filter-values-with-negation">match filter values with negation</a><span>, in § 10.2</span>
   <li><a href="#max-aggregatable-trigger-data-per-trigger">Max aggregatable trigger data per trigger</a><span>, in § 7</span>
   <li><a href="#max-aggregation-keys-per-attribution">Max aggregation keys per attribution</a><span>, in § 7</span>
   <li><a href="#max-attribution-reporting-endpoints-per-rate-limit-window">Max attribution reporting endpoints per rate-limit window</a><span>, in § 7</span>
   <li><a href="#max-attributions-per-event-source">Max attributions per event source</a><span>, in § 7</span>
   <li><a href="#max-attributions-per-navigation-source">Max attributions per navigation source</a><span>, in § 7</span>
   <li><a href="#max-attributions-per-rate-limit-window">Max attributions per rate-limit window</a><span>, in § 7</span>
   <li><a href="#max-destinations-covered-by-pending-sources">Max destinations covered by pending sources</a><span>, in § 7</span>
   <li><a href="#max-entries-per-filter-map">Max entries per filter map</a><span>, in § 7</span>
   <li><a href="#max-pending-sources-per-source-origin">Max pending sources per source origin</a><span>, in § 7</span>
   <li><a href="#max-report-cache-size">Max report cache size</a><span>, in § 7</span>
   <li><a href="#max-reports-per-attribution-destination">Max reports per attribution destination</a><span>, in § 7</span>
   <li><a href="#max-source-cache-size">Max source cache size</a><span>, in § 7</span>
   <li><a href="#max-source-expiry">Max source expiry</a><span>, in § 7</span>
   <li><a href="#max-source-reporting-endpoints-per-rate-limit-window">Max source reporting endpoints per rate-limit window</a><span>, in § 7</span>
   <li><a href="#max-values-per-filter-entry">Max values per filter entry</a><span>, in § 7</span>
   <li><a href="#maybe-process-a-navigation-attribution-source">maybe process a navigation attribution source</a><span>, in § 9.9</span>
   <li><a href="#navigation-source-trigger-data-cardinality">Navigation-source trigger data cardinality</a><span>, in § 7</span>
   <li>
    negated filters
    <ul>
     <li><a href="#aggregatable-trigger-data-negated-filters">dfn for aggregatable trigger data</a><span>, in § 5.6</span>
     <li><a href="#attribution-trigger-negated-filters">dfn for attribution trigger</a><span>, in § 5.8</span>
     <li><a href="#event-level-trigger-configuration-negated-filters">dfn for event-level trigger configuration</a><span>, in § 5.7</span>
    </ul>
   <li><a href="#attribution-source-number-of-event-level-reports">number of event-level reports</a><span>, in § 5.5</span>
   <li><a href="#obtain-a-fake-report">obtain a fake report</a><span>, in § 9.9</span>
   <li><a href="#obtain-an-attribution-source-from-an-anchor">obtain an attribution source from an anchor</a><span>, in § 9.5</span>
   <li><a href="#obtain-an-attribution-source-from-window-features">obtain an attribution source from window features</a><span>, in § 9.6</span>
   <li><a href="#obtain-an-event-level-report">obtain an event-level report</a><span>, in § 10.8</span>
   <li><a href="#obtain-an-event-level-report-delivery-time">obtain an event-level report delivery time</a><span>, in § 10.7</span>
   <li><a href="#obtain-an-expiry-deadline">obtain an expiry deadline</a><span>, in § 10.7</span>
   <li><a href="#obtain-a-randomized-response">obtain a randomized response</a><span>, in § 8.3</span>
   <li><a href="#obtain-a-randomized-source-response">obtain a randomized source response</a><span>, in § 9.4</span>
   <li><a href="#obtain-a-report-time-from-deadline">obtain a report time from deadline</a><span>, in § 10.7</span>
   <li><a href="#obtain-a-source-expiry">obtain a source expiry</a><span>, in § 9.7</span>
   <li><a href="#obtain-early-deadlines">obtain early deadlines</a><span>, in § 10.7</span>
   <li><a href="#obtain-the-number-of-report-windows">obtain the number of report windows</a><span>, in § 10.7</span>
   <li><a href="#obtain-the-report-time-at-a-window">obtain the report time at a window</a><span>, in § 10.7</span>
   <li><a href="#parse-aggregatable-trigger-data">parse aggregatable trigger data</a><span>, in § 10.1</span>
   <li><a href="#parse-aggregatable-values">parse aggregatable values</a><span>, in § 10.1</span>
   <li><a href="#parse-aggregation-keys">parse aggregation keys</a><span>, in § 9.7</span>
   <li><a href="#parse-an-aggregation-key-piece">parse an aggregation key piece</a><span>, in § 8.4</span>
   <li><a href="#parse-an-attribution-destination">parse an attribution destination</a><span>, in § 9.3</span>
   <li><a href="#parse-event-triggers">parse event triggers</a><span>, in § 10.1</span>
   <li><a href="#parse-filter-data">parse filter data</a><span>, in § 8.1</span>
   <li><a href="#parse-source-registration-json">parse source-registration JSON</a><span>, in § 9.7</span>
   <li><a href="#parse-trigger-registration-json">parse trigger-registration JSON</a><span>, in § 10.1</span>
   <li>
    priority
    <ul>
     <li><a href="#attribution-source-priority">dfn for attribution source</a><span>, in § 5.5</span>
     <li><a href="#event-level-trigger-configuration-priority">dfn for event-level trigger configuration</a><span>, in § 5.7</span>
    </ul>
   <li><a href="#process-an-attribution-source">process an attribution source</a><span>, in § 9.9</span>
   <li><a href="#queue-a-report-for-delivery">queue a report for delivery</a><span>, in § 11</span>
   <li><a href="#randomized-event-source-trigger-rate">Randomized event-source trigger rate</a><span>, in § 7</span>
   <li><a href="#randomized-navigation-source-trigger-rate">Randomized navigation-source trigger rate</a><span>, in § 7</span>
   <li><a href="#attribution-source-randomized-response">randomized response</a><span>, in § 5.5</span>
   <li><a href="#randomized-source-response">Randomized source response</a><span>, in § 5.1</span>
   <li>
    randomized trigger rate
    <ul>
     <li><a href="#attribution-source-randomized-trigger-rate">dfn for attribution source</a><span>, in § 5.5</span>
     <li><a href="#event-level-report-randomized-trigger-rate">dfn for event-level report</a><span>, in § 5.9</span>
    </ul>
   <li><a href="#parse-filter-data-registrationtype">registrationType</a><span>, in § 8.1</span>
   <li><a href="#event-level-report-report-id">report ID</a><span>, in § 5.9</span>
   <li>
    reporting endpoint
    <ul>
     <li><a href="#attribution-rate-limit-record-reporting-endpoint">dfn for attribution rate-limit record</a><span>, in § 5.11</span>
     <li><a href="#attribution-source-reporting-endpoint">dfn for attribution source</a><span>, in § 5.5</span>
     <li><a href="#attribution-trigger-reporting-endpoint">dfn for attribution trigger</a><span>, in § 5.8</span>
     <li><a href="#event-level-report-reporting-endpoint">dfn for event-level report</a><span>, in § 5.9</span>
    </ul>
   <li><a href="#event-level-report-report-time">report time</a><span>, in § 5.9</span>
   <li><a href="#trigger-state-report-window">report window</a><span>, in § 5.1</span>
   <li><a href="#attribution-rate-limit-record-scope">scope</a><span>, in § 5.11</span>
   <li><a href="#serialize-an-event-level-report">serialize an event-level report</a><span>, in § 11.2</span>
   <li><a href="#serialize-an-integer">serialize an integer</a><span>, in § 11.1</span>
   <li><a href="#should-rate-limit-attribution">Should attribution be blocked by rate limit</a><span>, in § 10.2</span>
   <li><a href="#should-block-processing-for-reporting-endpoint-limit">Should processing be blocked by reporting-endpoint limit</a><span>, in § 10.3</span>
   <li><a href="#event-level-report-source-debug-key">source debug key</a><span>, in § 5.9</span>
   <li><a href="#source-event-id-cardinality">Source event ID cardinality</a><span>, in § 7</span>
   <li>
    source identifier
    <ul>
     <li><a href="#attribution-source-source-identifier">dfn for attribution source</a><span>, in § 5.5</span>
     <li><a href="#event-level-report-source-identifier">dfn for event-level report</a><span>, in § 5.9</span>
    </ul>
   <li><a href="#aggregatable-trigger-data-source-keys">source keys</a><span>, in § 5.6</span>
   <li><a href="#attribution-source-source-origin">source origin</a><span>, in § 5.5</span>
   <li>
    source site
    <ul>
     <li><a href="#attribution-rate-limit-record-source-site">dfn for attribution rate-limit record</a><span>, in § 5.11</span>
     <li><a href="#attribution-source-source-site">dfn for attribution source</a><span>, in § 9.2</span>
    </ul>
   <li><a href="#attribution-source-source-time">source time</a><span>, in § 5.5</span>
   <li><a href="#source-type">Source type</a><span>, in § 5.3</span>
   <li>
    source type
    <ul>
     <li><a href="#attribution-source-source-type">dfn for attribution source</a><span>, in § 5.5</span>
     <li><a href="#event-level-report-source-type">dfn for event-level report</a><span>, in § 5.9</span>
    </ul>
   <li><a href="#attribution-rate-limit-record-time">time</a><span>, in § 5.11</span>
   <li><a href="#trigger-attribution">trigger attribution</a><span>, in § 10.6</span>
   <li>
    trigger data
    <ul>
     <li><a href="#event-level-report-trigger-data">dfn for event-level report</a><span>, in § 5.9</span>
     <li><a href="#event-level-trigger-configuration-trigger-data">dfn for event-level trigger configuration</a><span>, in § 5.7</span>
     <li><a href="#trigger-state-trigger-data">dfn for trigger state</a><span>, in § 5.1</span>
    </ul>
   <li><a href="#event-level-report-trigger-debug-key">trigger debug key</a><span>, in § 5.9</span>
   <li><a href="#event-level-report-trigger-priority">trigger priority</a><span>, in § 5.9</span>
   <li><a href="#trigger-state">Trigger state</a><span>, in § 5</span>
   <li>
    trigger time
    <ul>
     <li><a href="#attribution-trigger-trigger-time">dfn for attribution trigger</a><span>, in § 5.8</span>
     <li><a href="#event-level-report-trigger-time">dfn for event-level report</a><span>, in § 5.9</span>
    </ul>
   <li><a href="#aggregatable-contribution-value">value</a><span>, in § 5.10</span>
  </ul>
  <aside class="dfn-panel" data-for="term-for-utf-8-decode-without-bom">
   <a href="https://encoding.spec.whatwg.org/#utf-8-decode-without-bom">https://encoding.spec.whatwg.org/#utf-8-decode-without-bom</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-utf-8-decode-without-bom">9.6. Obtaining an attribution source from window features</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-request-body">
   <a href="https://fetch.spec.whatwg.org/#concept-request-body">https://fetch.spec.whatwg.org/#concept-request-body</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-request-body">11.4. Creating a report request</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-request-cache-mode">
   <a href="https://fetch.spec.whatwg.org/#concept-request-cache-mode">https://fetch.spec.whatwg.org/#concept-request-cache-mode</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-request-cache-mode">11.4. Creating a report request</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-request-client">
   <a href="https://fetch.spec.whatwg.org/#concept-request-client">https://fetch.spec.whatwg.org/#concept-request-client</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-request-client">11.4. Creating a report request</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-request-credentials-mode">
   <a href="https://fetch.spec.whatwg.org/#concept-request-credentials-mode">https://fetch.spec.whatwg.org/#concept-request-credentials-mode</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-request-credentials-mode">11.4. Creating a report request</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-fetch">
   <a href="https://fetch.spec.whatwg.org/#concept-fetch">https://fetch.spec.whatwg.org/#concept-fetch</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-fetch">11.5. Issuing a report request</a>
    <li><a href="#ref-for-concept-fetch①">11.6. Issuing a debug report request</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-header">
   <a href="https://fetch.spec.whatwg.org/#concept-header">https://fetch.spec.whatwg.org/#concept-header</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-header">11.4. Creating a report request</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-request-header-list">
   <a href="https://fetch.spec.whatwg.org/#concept-request-header-list">https://fetch.spec.whatwg.org/#concept-request-header-list</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-request-header-list">11.4. Creating a report request</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-request-initiator">
   <a href="https://fetch.spec.whatwg.org/#concept-request-initiator">https://fetch.spec.whatwg.org/#concept-request-initiator</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-request-initiator">11.4. Creating a report request</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-request-method">
   <a href="https://fetch.spec.whatwg.org/#concept-request-method">https://fetch.spec.whatwg.org/#concept-request-method</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-request-method">11.4. Creating a report request</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-request-mode">
   <a href="https://fetch.spec.whatwg.org/#concept-request-mode">https://fetch.spec.whatwg.org/#concept-request-mode</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-request-mode">11.4. Creating a report request</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-process-response">
   <a href="https://fetch.spec.whatwg.org/#process-response">https://fetch.spec.whatwg.org/#process-response</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-process-response">11.5. Issuing a report request</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-request-referrer">
   <a href="https://fetch.spec.whatwg.org/#concept-request-referrer">https://fetch.spec.whatwg.org/#concept-request-referrer</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-request-referrer">11.4. Creating a report request</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-request">
   <a href="https://fetch.spec.whatwg.org/#concept-request">https://fetch.spec.whatwg.org/#concept-request</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-request">11.4. Creating a report request</a>
    <li><a href="#ref-for-concept-request①">11.5. Issuing a report request</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-request-service-workers-mode">
   <a href="https://fetch.spec.whatwg.org/#request-service-workers-mode">https://fetch.spec.whatwg.org/#request-service-workers-mode</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-request-service-workers-mode">11.4. Creating a report request</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-body-source">
   <a href="https://fetch.spec.whatwg.org/#concept-body-source">https://fetch.spec.whatwg.org/#concept-body-source</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-body-source">11.4. Creating a report request</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-unsafe-request-flag">
   <a href="https://fetch.spec.whatwg.org/#unsafe-request-flag">https://fetch.spec.whatwg.org/#unsafe-request-flag</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-unsafe-request-flag">11.4. Creating a report request</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-request-url">
   <a href="https://fetch.spec.whatwg.org/#concept-request-url">https://fetch.spec.whatwg.org/#concept-request-url</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-request-url">11.4. Creating a report request</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-request-window">
   <a href="https://fetch.spec.whatwg.org/#concept-request-window">https://fetch.spec.whatwg.org/#concept-request-window</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-request-window">11.4. Creating a report request</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-cereactions">
   <a href="https://html.spec.whatwg.org/multipage/custom-elements.html#cereactions">https://html.spec.whatwg.org/multipage/custom-elements.html#cereactions</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-cereactions">2.1. API for elements</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-htmlanchorelement">
   <a href="https://html.spec.whatwg.org/multipage/text-level-semantics.html#htmlanchorelement">https://html.spec.whatwg.org/multipage/text-level-semantics.html#htmlanchorelement</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-htmlanchorelement">2.1. API for elements</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-htmlimageelement">
   <a href="https://html.spec.whatwg.org/multipage/embedded-content.html#htmlimageelement">https://html.spec.whatwg.org/multipage/embedded-content.html#htmlimageelement</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-htmlimageelement">2.1. API for elements</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-htmlscriptelement">
   <a href="https://html.spec.whatwg.org/multipage/scripting.html#htmlscriptelement">https://html.spec.whatwg.org/multipage/scripting.html#htmlscriptelement</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-htmlscriptelement">2.1. API for elements</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-the-a-element">
   <a href="https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-a-element">https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-a-element</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-the-a-element">2.1. API for elements</a> <a href="#ref-for-the-a-element①">(2)</a> <a href="#ref-for-the-a-element②">(3)</a>
    <li><a href="#ref-for-the-a-element③">2.3. Follow the hyperlink</a> <a href="#ref-for-the-a-element④">(2)</a>
    <li><a href="#ref-for-the-a-element⑤">9.5. Obtaining an attribution source from an a element</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-active-window">
   <a href="https://html.spec.whatwg.org/multipage/browsers.html#active-window">https://html.spec.whatwg.org/multipage/browsers.html#active-window</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-active-window">9.6. Obtaining an attribution source from window features</a>
    <li><a href="#ref-for-active-window①">9.9. Processing an attribution source</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-browsing-context">
   <a href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context">https://html.spec.whatwg.org/multipage/browsers.html#browsing-context</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-browsing-context">9.6. Obtaining an attribution source from window features</a>
    <li><a href="#ref-for-browsing-context①">9.9. Processing an attribution source</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-element-attributes">
   <a href="https://html.spec.whatwg.org/multipage/dom.html#concept-element-attributes">https://html.spec.whatwg.org/multipage/dom.html#concept-element-attributes</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-element-attributes">2.1. API for elements</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-initialise-the-document-object">
   <a href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#initialise-the-document-object">https://html.spec.whatwg.org/multipage/browsing-the-web.html#initialise-the-document-object</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-initialise-the-document-object">2.2.4. Document creation</a> <a href="#ref-for-initialise-the-document-object①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-environment-settings-object">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object">https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-environment-settings-object">6. Storage</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-exceptions-enabled">
   <a href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#exceptions-enabled">https://html.spec.whatwg.org/multipage/browsing-the-web.html#exceptions-enabled</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-exceptions-enabled">2.4. Window open steps</a> <a href="#ref-for-exceptions-enabled①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-following-hyperlinks-2">
   <a href="https://html.spec.whatwg.org/multipage/links.html#following-hyperlinks-2">https://html.spec.whatwg.org/multipage/links.html#following-hyperlinks-2</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-following-hyperlinks-2">2.3. Follow the hyperlink</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-origin-host">
   <a href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin-host">https://html.spec.whatwg.org/multipage/origin.html#concept-origin-host</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-origin-host">11.3. Get report request URL</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-the-img-element">
   <a href="https://html.spec.whatwg.org/multipage/embedded-content.html#the-img-element">https://html.spec.whatwg.org/multipage/embedded-content.html#the-img-element</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-the-img-element">2.1. API for elements</a> <a href="#ref-for-the-img-element①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-in-parallel">
   <a href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-in-parallel">11. Report delivery</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-navigate">
   <a href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigate">https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigate</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-navigate">2.2.2. Navigate algorithm</a> <a href="#ref-for-navigate①">(2)</a>
    <li><a href="#ref-for-navigate②">2.3. Follow the hyperlink</a> <a href="#ref-for-navigate③">(2)</a>
    <li><a href="#ref-for-navigate④">2.4. Window open steps</a> <a href="#ref-for-navigate⑤">(2)</a> <a href="#ref-for-navigate⑥">(3)</a> <a href="#ref-for-navigate⑦">(4)</a> <a href="#ref-for-navigate⑧">(5)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-navigation-params">
   <a href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params">https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-navigation-params">2.2.1. Navigation Params</a>
    <li><a href="#ref-for-navigation-params①">9.9. Processing an attribution source</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-obtain-a-site">
   <a href="https://html.spec.whatwg.org/multipage/origin.html#obtain-a-site">https://html.spec.whatwg.org/multipage/origin.html#obtain-a-site</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-obtain-a-site">9.2. Obtaining an attribution source’s source site</a>
    <li><a href="#ref-for-obtain-a-site①">9.3. Parsing an attribution destination</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-origin-opaque">
   <a href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin-opaque">https://html.spec.whatwg.org/multipage/origin.html#concept-origin-opaque</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-origin-opaque">11.2. Serialize attribution report body</a>
    <li><a href="#ref-for-concept-origin-opaque①">11.3. Get report request URL</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-origin">
   <a href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin">https://html.spec.whatwg.org/multipage/origin.html#concept-origin</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-origin">8.2. Debug keys</a>
    <li><a href="#ref-for-concept-origin①">9.7. Parsing source-registration JSON</a> <a href="#ref-for-concept-origin②">(2)</a>
    <li><a href="#ref-for-concept-origin③">10.1. Creating an attribution trigger</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-origin-port">
   <a href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin-port">https://html.spec.whatwg.org/multipage/origin.html#concept-origin-port</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-origin-port">11.3. Get report request URL</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-process-a-navigate-fetch">
   <a href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#process-a-navigate-fetch">https://html.spec.whatwg.org/multipage/browsing-the-web.html#process-a-navigate-fetch</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-process-a-navigate-fetch">2.2.2. Navigate algorithm</a>
    <li><a href="#ref-for-process-a-navigate-fetch①">2.2.3. Process a navigate fetch</a> <a href="#ref-for-process-a-navigate-fetch②">(2)</a> <a href="#ref-for-process-a-navigate-fetch③">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-queue-a-task">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-queue-a-task">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-queue-a-task①">10.6. Triggering attribution</a>
    <li><a href="#ref-for-queue-a-task②">11.5. Issuing a report request</a> <a href="#ref-for-queue-a-task③">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-reflect">
   <a href="https://html.spec.whatwg.org/multipage/common-dom-interfaces.html#reflect">https://html.spec.whatwg.org/multipage/common-dom-interfaces.html#reflect</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-reflect">2.1. API for elements</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-rules-for-parsing-integers">
   <a href="https://html.spec.whatwg.org/multipage/common-microsyntaxes.html#rules-for-parsing-integers">https://html.spec.whatwg.org/multipage/common-microsyntaxes.html#rules-for-parsing-integers</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-rules-for-parsing-integers">9.7. Parsing source-registration JSON</a> <a href="#ref-for-rules-for-parsing-integers①">(2)</a>
    <li><a href="#ref-for-rules-for-parsing-integers②">10.1. Creating an attribution trigger</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-rules-for-parsing-non-negative-integers">
   <a href="https://html.spec.whatwg.org/multipage/common-microsyntaxes.html#rules-for-parsing-non-negative-integers">https://html.spec.whatwg.org/multipage/common-microsyntaxes.html#rules-for-parsing-non-negative-integers</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-rules-for-parsing-non-negative-integers">9.7. Parsing source-registration JSON</a> <a href="#ref-for-rules-for-parsing-non-negative-integers①">(2)</a>
    <li><a href="#ref-for-rules-for-parsing-non-negative-integers②">10.1. Creating an attribution trigger</a> <a href="#ref-for-rules-for-parsing-non-negative-integers③">(2)</a> <a href="#ref-for-rules-for-parsing-non-negative-integers④">(3)</a> <a href="#ref-for-rules-for-parsing-non-negative-integers⑤">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-same-origin">
   <a href="https://html.spec.whatwg.org/multipage/origin.html#same-origin">https://html.spec.whatwg.org/multipage/origin.html#same-origin</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-same-origin">9.8. Checking pending destination limit</a>
    <li><a href="#ref-for-same-origin①">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-same-origin②">10.3. Should attribution be blocked by rate limit</a>
    <li><a href="#ref-for-same-origin③">10.6. Triggering attribution</a>
    <li><a href="#ref-for-same-origin④">13.1. Clearing attribution storage</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-same-site">
   <a href="https://html.spec.whatwg.org/multipage/origin.html#same-site">https://html.spec.whatwg.org/multipage/origin.html#same-site</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-same-site">2.2. Navigation</a>
    <li><a href="#ref-for-same-site①">9.9. Processing an attribution source</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-origin-scheme">
   <a href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin-scheme">https://html.spec.whatwg.org/multipage/origin.html#concept-origin-scheme</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-origin-scheme">9.7. Parsing source-registration JSON</a>
    <li><a href="#ref-for-concept-origin-scheme①">11.3. Get report request URL</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-script">
   <a href="https://html.spec.whatwg.org/multipage/scripting.html#script">https://html.spec.whatwg.org/multipage/scripting.html#script</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-script">2.1. API for elements</a> <a href="#ref-for-script①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-site">
   <a href="https://html.spec.whatwg.org/multipage/origin.html#site">https://html.spec.whatwg.org/multipage/origin.html#site</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-site">5.5. Attribution source</a>
    <li><a href="#ref-for-site①">5.8. Attribution trigger</a>
    <li><a href="#ref-for-site②">5.9. Event-level report</a>
    <li><a href="#ref-for-site③">5.11. Attribution rate-limit record</a> <a href="#ref-for-site④">(2)</a>
    <li><a href="#ref-for-site⑤">10.1. Creating an attribution trigger</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-source-browsing-context">
   <a href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#source-browsing-context">https://html.spec.whatwg.org/multipage/browsing-the-web.html#source-browsing-context</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-source-browsing-context">2.4. Window open steps</a> <a href="#ref-for-source-browsing-context①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-top-level-browsing-context">
   <a href="https://html.spec.whatwg.org/multipage/browsers.html#top-level-browsing-context">https://html.spec.whatwg.org/multipage/browsers.html#top-level-browsing-context</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-top-level-browsing-context">9.9. Processing an attribution source</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-transient-activation">
   <a href="https://html.spec.whatwg.org/multipage/interaction.html#transient-activation">https://html.spec.whatwg.org/multipage/interaction.html#transient-activation</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-transient-activation">9.6. Obtaining an attribution source from window features</a>
    <li><a href="#ref-for-transient-activation①">9.9. Processing an attribution source</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-window-open-steps">
   <a href="https://html.spec.whatwg.org/multipage/window-object.html#window-open-steps">https://html.spec.whatwg.org/multipage/window-object.html#window-open-steps</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-window-open-steps">2.4. Window open steps</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-set-append">
   <a href="https://infra.spec.whatwg.org/#set-append">https://infra.spec.whatwg.org/#set-append</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-set-append">8.1. Parsing filter data</a>
    <li><a href="#ref-for-set-append①">9.4. Obtaining a randomized source response</a> <a href="#ref-for-set-append②">(2)</a>
    <li><a href="#ref-for-set-append③">9.8. Checking pending destination limit</a>
    <li><a href="#ref-for-set-append④">9.9. Processing an attribution source</a> <a href="#ref-for-set-append⑤">(2)</a> <a href="#ref-for-set-append⑥">(3)</a>
    <li><a href="#ref-for-set-append⑦">10.1. Creating an attribution trigger</a> <a href="#ref-for-set-append⑧">(2)</a>
    <li><a href="#ref-for-set-append⑨">10.4. Should processing be blocked by reporting-endpoint limit</a>
    <li><a href="#ref-for-set-append①⓪">10.6. Triggering attribution</a> <a href="#ref-for-set-append①①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-ascii-hex-digit">
   <a href="https://infra.spec.whatwg.org/#ascii-hex-digit">https://infra.spec.whatwg.org/#ascii-hex-digit</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-ascii-hex-digit">8.4. Parsing aggregation key piece</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-assert">
   <a href="https://infra.spec.whatwg.org/#assert">https://infra.spec.whatwg.org/#assert</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-assert">8.2. Debug keys</a>
    <li><a href="#ref-for-assert①">8.3. Obtaining a randomized response</a>
    <li><a href="#ref-for-assert②">9.7. Parsing source-registration JSON</a> <a href="#ref-for-assert③">(2)</a>
    <li><a href="#ref-for-assert④">10.1. Creating an attribution trigger</a>
    <li><a href="#ref-for-assert⑤">10.6. Triggering attribution</a>
    <li><a href="#ref-for-assert⑥">11.2. Serialize attribution report body</a>
    <li><a href="#ref-for-assert⑦">11.3. Get report request URL</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-boolean">
   <a href="https://infra.spec.whatwg.org/#boolean">https://infra.spec.whatwg.org/#boolean</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-boolean">5.9. Event-level report</a>
    <li><a href="#ref-for-boolean①">10.2. Does filter data match</a>
    <li><a href="#ref-for-boolean②">11.3. Get report request URL</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-iteration-break">
   <a href="https://infra.spec.whatwg.org/#iteration-break">https://infra.spec.whatwg.org/#iteration-break</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-iteration-break">10.6. Triggering attribution</a>
    <li><a href="#ref-for-iteration-break①">10.7. Establishing report delivery time</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-byte-sequence">
   <a href="https://infra.spec.whatwg.org/#byte-sequence">https://infra.spec.whatwg.org/#byte-sequence</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-byte-sequence">11.2. Serialize attribution report body</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-string-code-point-length">
   <a href="https://infra.spec.whatwg.org/#string-code-point-length">https://infra.spec.whatwg.org/#string-code-point-length</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-string-code-point-length">8.1. Parsing filter data</a>
    <li><a href="#ref-for-string-code-point-length①">8.4. Parsing aggregation key piece</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-code-point-substring">
   <a href="https://infra.spec.whatwg.org/#code-point-substring">https://infra.spec.whatwg.org/#code-point-substring</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-code-point-substring">8.4. Parsing aggregation key piece</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-list-contain">
   <a href="https://infra.spec.whatwg.org/#list-contain">https://infra.spec.whatwg.org/#list-contain</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-list-contain">9.8. Checking pending destination limit</a>
    <li><a href="#ref-for-list-contain①">10.4. Should processing be blocked by reporting-endpoint limit</a>
    <li><a href="#ref-for-list-contain②">10.6. Triggering attribution</a>
    <li><a href="#ref-for-list-contain③">10.7. Establishing report delivery time</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-iteration-continue">
   <a href="https://infra.spec.whatwg.org/#iteration-continue">https://infra.spec.whatwg.org/#iteration-continue</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-iteration-continue">9.8. Checking pending destination limit</a>
    <li><a href="#ref-for-iteration-continue①">10.2. Does filter data match</a>
    <li><a href="#ref-for-iteration-continue②">10.5. Creating aggregatable contributions</a> <a href="#ref-for-iteration-continue③">(2)</a> <a href="#ref-for-iteration-continue④">(3)</a> <a href="#ref-for-iteration-continue⑤">(4)</a>
    <li><a href="#ref-for-iteration-continue⑥">10.6. Triggering attribution</a> <a href="#ref-for-iteration-continue⑦">(2)</a>
    <li><a href="#ref-for-iteration-continue⑧">10.7. Establishing report delivery time</a> <a href="#ref-for-iteration-continue⑨">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-map-exists">
   <a href="https://infra.spec.whatwg.org/#map-exists">https://infra.spec.whatwg.org/#map-exists</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-map-exists">8.1. Parsing filter data</a>
    <li><a href="#ref-for-map-exists①">9.6. Obtaining an attribution source from window features</a>
    <li><a href="#ref-for-map-exists②">9.7. Parsing source-registration JSON</a> <a href="#ref-for-map-exists③">(2)</a> <a href="#ref-for-map-exists④">(3)</a> <a href="#ref-for-map-exists⑤">(4)</a> <a href="#ref-for-map-exists⑥">(5)</a> <a href="#ref-for-map-exists⑦">(6)</a>
    <li><a href="#ref-for-map-exists⑧">10.1. Creating an attribution trigger</a> <a href="#ref-for-map-exists⑨">(2)</a> <a href="#ref-for-map-exists①⓪">(3)</a> <a href="#ref-for-map-exists①①">(4)</a> <a href="#ref-for-map-exists①②">(5)</a> <a href="#ref-for-map-exists①③">(6)</a> <a href="#ref-for-map-exists①④">(7)</a> <a href="#ref-for-map-exists①⑤">(8)</a> <a href="#ref-for-map-exists①⑥">(9)</a> <a href="#ref-for-map-exists①⑦">(10)</a> <a href="#ref-for-map-exists①⑧">(11)</a> <a href="#ref-for-map-exists①⑨">(12)</a> <a href="#ref-for-map-exists②⓪">(13)</a> <a href="#ref-for-map-exists②①">(14)</a>
    <li><a href="#ref-for-map-exists②②">10.2. Does filter data match</a>
    <li><a href="#ref-for-map-exists②③">10.5. Creating aggregatable contributions</a> <a href="#ref-for-map-exists②④">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-implementation-defined">
   <a href="https://infra.spec.whatwg.org/#implementation-defined">https://infra.spec.whatwg.org/#implementation-defined</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-implementation-defined">11. Report delivery</a> <a href="#ref-for-implementation-defined①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-set-intersection">
   <a href="https://infra.spec.whatwg.org/#set-intersection">https://infra.spec.whatwg.org/#set-intersection</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-set-intersection">10.2. Does filter data match</a> <a href="#ref-for-set-intersection①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-string-is">
   <a href="https://infra.spec.whatwg.org/#string-is">https://infra.spec.whatwg.org/#string-is</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-string-is">10.6. Triggering attribution</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-list-is-empty">
   <a href="https://infra.spec.whatwg.org/#list-is-empty">https://infra.spec.whatwg.org/#list-is-empty</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-list-is-empty">9.4. Obtaining a randomized source response</a> <a href="#ref-for-list-is-empty①">(2)</a>
    <li><a href="#ref-for-list-is-empty②">9.8. Checking pending destination limit</a>
    <li><a href="#ref-for-list-is-empty③">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-list-is-empty④">10.2. Does filter data match</a> <a href="#ref-for-list-is-empty⑤">(2)</a> <a href="#ref-for-list-is-empty⑥">(3)</a> <a href="#ref-for-list-is-empty⑦">(4)</a> <a href="#ref-for-list-is-empty⑧">(5)</a> <a href="#ref-for-list-is-empty⑨">(6)</a>
    <li><a href="#ref-for-list-is-empty①⓪">10.6. Triggering attribution</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-map-iterate">
   <a href="https://infra.spec.whatwg.org/#map-iterate">https://infra.spec.whatwg.org/#map-iterate</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-map-iterate">8.1. Parsing filter data</a>
    <li><a href="#ref-for-map-iterate①">9.7. Parsing source-registration JSON</a>
    <li><a href="#ref-for-map-iterate②">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-map-iterate③">10.1. Creating an attribution trigger</a>
    <li><a href="#ref-for-map-iterate④">10.2. Does filter data match</a>
    <li><a href="#ref-for-map-iterate⑤">10.4. Should processing be blocked by reporting-endpoint limit</a>
    <li><a href="#ref-for-map-iterate⑥">10.5. Creating aggregatable contributions</a>
    <li><a href="#ref-for-map-iterate⑦">10.6. Triggering attribution</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-map-key">
   <a href="https://infra.spec.whatwg.org/#map-key">https://infra.spec.whatwg.org/#map-key</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-map-key">5.3. Attribution filtering</a>
    <li><a href="#ref-for-map-key①">5.5. Attribution source</a>
    <li><a href="#ref-for-map-key②">5.8. Attribution trigger</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-string-length">
   <a href="https://infra.spec.whatwg.org/#string-length">https://infra.spec.whatwg.org/#string-length</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-string-length">8.1. Parsing filter data</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-list">
   <a href="https://infra.spec.whatwg.org/#list">https://infra.spec.whatwg.org/#list</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-list">5.8. Attribution trigger</a>
    <li><a href="#ref-for-list①">8.1. Parsing filter data</a>
    <li><a href="#ref-for-list②">10.1. Creating an attribution trigger</a> <a href="#ref-for-list③">(2)</a> <a href="#ref-for-list④">(3)</a> <a href="#ref-for-list⑤">(4)</a>
    <li><a href="#ref-for-list⑥">10.5. Creating aggregatable contributions</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-ordered-map">
   <a href="https://infra.spec.whatwg.org/#ordered-map">https://infra.spec.whatwg.org/#ordered-map</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-ordered-map">5.3. Attribution filtering</a>
    <li><a href="#ref-for-ordered-map①">5.5. Attribution source</a>
    <li><a href="#ref-for-ordered-map②">5.8. Attribution trigger</a>
    <li><a href="#ref-for-ordered-map③">8.1. Parsing filter data</a>
    <li><a href="#ref-for-ordered-map④">9.6. Obtaining an attribution source from window features</a>
    <li><a href="#ref-for-ordered-map⑤">9.7. Parsing source-registration JSON</a> <a href="#ref-for-ordered-map⑥">(2)</a> <a href="#ref-for-ordered-map⑦">(3)</a> <a href="#ref-for-ordered-map⑧">(4)</a>
    <li><a href="#ref-for-ordered-map⑨">10.1. Creating an attribution trigger</a> <a href="#ref-for-ordered-map①⓪">(2)</a> <a href="#ref-for-ordered-map①①">(3)</a> <a href="#ref-for-ordered-map①②">(4)</a> <a href="#ref-for-ordered-map①③">(5)</a> <a href="#ref-for-ordered-map①④">(6)</a> <a href="#ref-for-ordered-map①⑤">(7)</a>
    <li><a href="#ref-for-ordered-map①⑥">11.2. Serialize attribution report body</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-ordered-map">
   <a href="https://infra.spec.whatwg.org/#ordered-map">https://infra.spec.whatwg.org/#ordered-map</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-ordered-map">5.3. Attribution filtering</a>
    <li><a href="#ref-for-ordered-map①">5.5. Attribution source</a>
    <li><a href="#ref-for-ordered-map②">5.8. Attribution trigger</a>
    <li><a href="#ref-for-ordered-map③">8.1. Parsing filter data</a>
    <li><a href="#ref-for-ordered-map④">9.6. Obtaining an attribution source from window features</a>
    <li><a href="#ref-for-ordered-map⑤">9.7. Parsing source-registration JSON</a> <a href="#ref-for-ordered-map⑥">(2)</a> <a href="#ref-for-ordered-map⑦">(3)</a> <a href="#ref-for-ordered-map⑧">(4)</a>
    <li><a href="#ref-for-ordered-map⑨">10.1. Creating an attribution trigger</a> <a href="#ref-for-ordered-map①⓪">(2)</a> <a href="#ref-for-ordered-map①①">(3)</a> <a href="#ref-for-ordered-map①②">(4)</a> <a href="#ref-for-ordered-map①③">(5)</a> <a href="#ref-for-ordered-map①④">(6)</a> <a href="#ref-for-ordered-map①⑤">(7)</a>
    <li><a href="#ref-for-ordered-map①⑥">11.2. Serialize attribution report body</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-ordered-set">
   <a href="https://infra.spec.whatwg.org/#ordered-set">https://infra.spec.whatwg.org/#ordered-set</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-ordered-set">5.2. Randomized source response</a>
    <li><a href="#ref-for-ordered-set①">5.3. Attribution filtering</a>
    <li><a href="#ref-for-ordered-set②">5.5. Attribution source</a>
    <li><a href="#ref-for-ordered-set③">5.6. Aggregatable trigger data</a>
    <li><a href="#ref-for-ordered-set④">5.8. Attribution trigger</a>
    <li><a href="#ref-for-ordered-set⑤">6. Storage</a> <a href="#ref-for-ordered-set⑥">(2)</a> <a href="#ref-for-ordered-set⑦">(3)</a>
    <li><a href="#ref-for-ordered-set⑧">8.1. Parsing filter data</a>
    <li><a href="#ref-for-ordered-set⑨">8.3. Obtaining a randomized response</a>
    <li><a href="#ref-for-ordered-set①⓪">9.4. Obtaining a randomized source response</a> <a href="#ref-for-ordered-set①①">(2)</a>
    <li><a href="#ref-for-ordered-set①②">9.8. Checking pending destination limit</a>
    <li><a href="#ref-for-ordered-set①③">9.9. Processing an attribution source</a> <a href="#ref-for-ordered-set①④">(2)</a>
    <li><a href="#ref-for-ordered-set①⑤">10.1. Creating an attribution trigger</a> <a href="#ref-for-ordered-set①⑥">(2)</a>
    <li><a href="#ref-for-ordered-set①⑦">10.4. Should processing be blocked by reporting-endpoint limit</a>
    <li><a href="#ref-for-ordered-set①⑧">10.6. Triggering attribution</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-parse-a-json-string-to-an-infra-value">
   <a href="https://infra.spec.whatwg.org/#parse-a-json-string-to-an-infra-value">https://infra.spec.whatwg.org/#parse-a-json-string-to-an-infra-value</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-parse-a-json-string-to-an-infra-value">9.7. Parsing source-registration JSON</a>
    <li><a href="#ref-for-parse-a-json-string-to-an-infra-value①">10.1. Creating an attribution trigger</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-list-remove">
   <a href="https://infra.spec.whatwg.org/#list-remove">https://infra.spec.whatwg.org/#list-remove</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-list-remove">9.9. Processing an attribution source</a> <a href="#ref-for-list-remove①">(2)</a>
    <li><a href="#ref-for-list-remove②">10.6. Triggering attribution</a> <a href="#ref-for-list-remove③">(2)</a> <a href="#ref-for-list-remove④">(3)</a> <a href="#ref-for-list-remove⑤">(4)</a> <a href="#ref-for-list-remove⑥">(5)</a>
    <li><a href="#ref-for-list-remove⑦">11.5. Issuing a report request</a>
    <li><a href="#ref-for-list-remove⑧">13.1. Clearing attribution storage</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-serialize-an-infra-value-to-json-bytes">
   <a href="https://infra.spec.whatwg.org/#serialize-an-infra-value-to-json-bytes">https://infra.spec.whatwg.org/#serialize-an-infra-value-to-json-bytes</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-serialize-an-infra-value-to-json-bytes">11.2. Serialize attribution report body</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-map-set">
   <a href="https://infra.spec.whatwg.org/#map-set">https://infra.spec.whatwg.org/#map-set</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-map-set">8.1. Parsing filter data</a>
    <li><a href="#ref-for-map-set①">9.7. Parsing source-registration JSON</a> <a href="#ref-for-map-set②">(2)</a>
    <li><a href="#ref-for-map-set③">11.2. Serialize attribution report body</a> <a href="#ref-for-map-set④">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-map-size">
   <a href="https://infra.spec.whatwg.org/#map-size">https://infra.spec.whatwg.org/#map-size</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-map-size">7. Vendor-Specific Values</a> <a href="#ref-for-map-size①">(2)</a> <a href="#ref-for-map-size②">(3)</a>
    <li><a href="#ref-for-map-size③">8.1. Parsing filter data</a>
    <li><a href="#ref-for-map-size④">9.7. Parsing source-registration JSON</a>
    <li><a href="#ref-for-map-size⑤">10.1. Creating an attribution trigger</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-list-sort-in-ascending-order">
   <a href="https://infra.spec.whatwg.org/#list-sort-in-ascending-order">https://infra.spec.whatwg.org/#list-sort-in-ascending-order</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-list-sort-in-ascending-order">10.6. Triggering attribution</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-list-sort-in-descending-order">
   <a href="https://infra.spec.whatwg.org/#list-sort-in-descending-order">https://infra.spec.whatwg.org/#list-sort-in-descending-order</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-list-sort-in-descending-order">10.6. Triggering attribution</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-string">
   <a href="https://infra.spec.whatwg.org/#string">https://infra.spec.whatwg.org/#string</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-string">2.1. API for elements</a> <a href="#ref-for-string①">(2)</a> <a href="#ref-for-string②">(3)</a>
    <li><a href="#ref-for-string③">5.3. Attribution filtering</a> <a href="#ref-for-string④">(2)</a>
    <li><a href="#ref-for-string⑤">5.5. Attribution source</a> <a href="#ref-for-string⑥">(2)</a>
    <li><a href="#ref-for-string⑦">5.6. Aggregatable trigger data</a>
    <li><a href="#ref-for-string⑧">5.8. Attribution trigger</a>
    <li><a href="#ref-for-string⑨">5.9. Event-level report</a>
    <li><a href="#ref-for-string①⓪">8.1. Parsing filter data</a> <a href="#ref-for-string①①">(2)</a>
    <li><a href="#ref-for-string①②">8.4. Parsing aggregation key piece</a>
    <li><a href="#ref-for-string①③">9.7. Parsing source-registration JSON</a> <a href="#ref-for-string①④">(2)</a> <a href="#ref-for-string①⑤">(3)</a> <a href="#ref-for-string①⑥">(4)</a> <a href="#ref-for-string①⑦">(5)</a> <a href="#ref-for-string①⑧">(6)</a> <a href="#ref-for-string①⑨">(7)</a> <a href="#ref-for-string②⓪">(8)</a>
    <li><a href="#ref-for-string②①">10.1. Creating an attribution trigger</a> <a href="#ref-for-string②②">(2)</a> <a href="#ref-for-string②③">(3)</a> <a href="#ref-for-string②④">(4)</a> <a href="#ref-for-string②⑤">(5)</a> <a href="#ref-for-string②⑥">(6)</a> <a href="#ref-for-string②⑦">(7)</a> <a href="#ref-for-string②⑧">(8)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-struct">
   <a href="https://infra.spec.whatwg.org/#struct">https://infra.spec.whatwg.org/#struct</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-struct">5.1. Trigger state</a>
    <li><a href="#ref-for-struct①">5.5. Attribution source</a>
    <li><a href="#ref-for-struct②">5.6. Aggregatable trigger data</a>
    <li><a href="#ref-for-struct③">5.7. Event-level trigger configuration</a>
    <li><a href="#ref-for-struct④">5.8. Attribution trigger</a>
    <li><a href="#ref-for-struct⑤">5.9. Event-level report</a>
    <li><a href="#ref-for-struct⑥">5.10. Aggregatable contribution</a>
    <li><a href="#ref-for-struct⑦">5.11. Attribution rate-limit record</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-map-value">
   <a href="https://infra.spec.whatwg.org/#map-value">https://infra.spec.whatwg.org/#map-value</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-map-value">5.3. Attribution filtering</a>
    <li><a href="#ref-for-map-value①">5.5. Attribution source</a>
    <li><a href="#ref-for-map-value②">5.8. Attribution trigger</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-default-allowlist">
   <a href="https://w3c.github.io/webappsec-permissions-policy/#default-allowlist">https://w3c.github.io/webappsec-permissions-policy/#default-allowlist</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-default-allowlist">4. Permissions Policy integration</a> <a href="#ref-for-default-allowlist①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-policy-controlled-feature">
   <a href="https://w3c.github.io/webappsec-permissions-policy/#policy-controlled-feature">https://w3c.github.io/webappsec-permissions-policy/#policy-controlled-feature</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-policy-controlled-feature">4. Permissions Policy integration</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-potentially-trustworthy-origin">
   <a href="https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-origin">https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-origin</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-potentially-trustworthy-origin">8.2. Debug keys</a>
    <li><a href="#ref-for-potentially-trustworthy-origin①">9.3. Parsing an attribution destination</a>
    <li><a href="#ref-for-potentially-trustworthy-origin②">9.7. Parsing source-registration JSON</a> <a href="#ref-for-potentially-trustworthy-origin③">(2)</a>
    <li><a href="#ref-for-potentially-trustworthy-origin④">10.1. Creating an attribution trigger</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-storage-bottle">
   <a href="https://storage.spec.whatwg.org/#storage-bottle">https://storage.spec.whatwg.org/#storage-bottle</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-storage-bottle">6. Storage</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-url-host">
   <a href="https://url.spec.whatwg.org/#concept-url-host">https://url.spec.whatwg.org/#concept-url-host</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-url-host">11.3. Get report request URL</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-url-origin">
   <a href="https://url.spec.whatwg.org/#concept-url-origin">https://url.spec.whatwg.org/#concept-url-origin</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-url-origin">5.5. Attribution source</a> <a href="#ref-for-concept-url-origin①">(2)</a>
    <li><a href="#ref-for-concept-url-origin②">5.8. Attribution trigger</a>
    <li><a href="#ref-for-concept-url-origin③">5.9. Event-level report</a>
    <li><a href="#ref-for-concept-url-origin④">5.11. Attribution rate-limit record</a>
    <li><a href="#ref-for-concept-url-origin⑤">9.3. Parsing an attribution destination</a> <a href="#ref-for-concept-url-origin⑥">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-url-path">
   <a href="https://url.spec.whatwg.org/#concept-url-path">https://url.spec.whatwg.org/#concept-url-path</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-url-path">11.3. Get report request URL</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-string-percent-decode">
   <a href="https://url.spec.whatwg.org/#string-percent-decode">https://url.spec.whatwg.org/#string-percent-decode</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-string-percent-decode">9.6. Obtaining an attribution source from window features</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-url-port">
   <a href="https://url.spec.whatwg.org/#concept-url-port">https://url.spec.whatwg.org/#concept-url-port</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-url-port">11.3. Get report request URL</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-url-scheme">
   <a href="https://url.spec.whatwg.org/#concept-url-scheme">https://url.spec.whatwg.org/#concept-url-scheme</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-url-scheme">11.3. Get report request URL</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-url">
   <a href="https://url.spec.whatwg.org/#concept-url">https://url.spec.whatwg.org/#concept-url</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-url">2.1. API for elements</a> <a href="#ref-for-concept-url①">(2)</a> <a href="#ref-for-concept-url②">(3)</a> <a href="#ref-for-concept-url③">(4)</a> <a href="#ref-for-concept-url④">(5)</a> <a href="#ref-for-concept-url⑤">(6)</a>
    <li><a href="#ref-for-concept-url⑥">11.3. Get report request URL</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-url-parser">
   <a href="https://url.spec.whatwg.org/#concept-url-parser">https://url.spec.whatwg.org/#concept-url-parser</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-url-parser">9.3. Parsing an attribution destination</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-url">
   <a href="https://url.spec.whatwg.org/#concept-url">https://url.spec.whatwg.org/#concept-url</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-url">2.1. API for elements</a> <a href="#ref-for-concept-url①">(2)</a> <a href="#ref-for-concept-url②">(3)</a> <a href="#ref-for-concept-url③">(4)</a> <a href="#ref-for-concept-url④">(5)</a> <a href="#ref-for-concept-url⑤">(6)</a>
    <li><a href="#ref-for-concept-url⑥">11.3. Get report request URL</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dfn-generate-a-random-uuid">
   <a href="https://wicg.github.io/uuid/#dfn-generate-a-random-uuid">https://wicg.github.io/uuid/#dfn-generate-a-random-uuid</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dfn-generate-a-random-uuid">10.8. Obtaining an event-level report</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-USVString">
   <a href="https://webidl.spec.whatwg.org/#idl-USVString">https://webidl.spec.whatwg.org/#idl-USVString</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-USVString">2.1. API for elements</a>
   </ul>
  </aside>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[ENCODING]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-utf-8-decode-without-bom">utf-8 decode without bom</span>
    </ul>
   <li>
    <a data-link-type="biblio">[FETCH]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-concept-request-body">body <small>(for request)</small></span>
     <li><span class="dfn-paneled" id="term-for-concept-request-cache-mode">cache mode</span>
     <li><span class="dfn-paneled" id="term-for-concept-request-client">client</span>
     <li><span class="dfn-paneled" id="term-for-concept-request-credentials-mode">credentials mode</span>
     <li><span class="dfn-paneled" id="term-for-concept-fetch">fetch</span>
     <li><span class="dfn-paneled" id="term-for-concept-header">header</span>
     <li><span class="dfn-paneled" id="term-for-concept-request-header-list">header list <small>(for request)</small></span>
     <li><span class="dfn-paneled" id="term-for-concept-request-initiator">initiator</span>
     <li><span class="dfn-paneled" id="term-for-concept-request-method">method</span>
     <li><span class="dfn-paneled" id="term-for-concept-request-mode">mode</span>
     <li><span class="dfn-paneled" id="term-for-process-response">processresponse</span>
     <li><span class="dfn-paneled" id="term-for-concept-request-referrer">referrer</span>
     <li><span class="dfn-paneled" id="term-for-concept-request">request</span>
     <li><span class="dfn-paneled" id="term-for-request-service-workers-mode">service-workers mode</span>
     <li><span class="dfn-paneled" id="term-for-concept-body-source">source</span>
     <li><span class="dfn-paneled" id="term-for-unsafe-request-flag">unsafe-request flag</span>
     <li><span class="dfn-paneled" id="term-for-concept-request-url">url</span>
     <li><span class="dfn-paneled" id="term-for-concept-request-window">window</span>
    </ul>
   <li>
    <a data-link-type="biblio">[HTML]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-cereactions">CEReactions</span>
     <li><span class="dfn-paneled" id="term-for-htmlanchorelement">HTMLAnchorElement</span>
     <li><span class="dfn-paneled" id="term-for-htmlimageelement">HTMLImageElement</span>
     <li><span class="dfn-paneled" id="term-for-htmlscriptelement">HTMLScriptElement</span>
     <li><span class="dfn-paneled" id="term-for-the-a-element">a</span>
     <li><span class="dfn-paneled" id="term-for-active-window">active window</span>
     <li><span class="dfn-paneled" id="term-for-browsing-context">browsing context</span>
     <li><span class="dfn-paneled" id="term-for-concept-element-attributes">content attributes</span>
     <li><span class="dfn-paneled" id="term-for-initialise-the-document-object">create and initialize a document object</span>
     <li><span class="dfn-paneled" id="term-for-environment-settings-object">environment settings object</span>
     <li><span class="dfn-paneled" id="term-for-exceptions-enabled">exceptionsenabled</span>
     <li><span class="dfn-paneled" id="term-for-following-hyperlinks-2">follow the hyperlink</span>
     <li><span class="dfn-paneled" id="term-for-concept-origin-host">host</span>
     <li><span class="dfn-paneled" id="term-for-the-img-element">img</span>
     <li><span class="dfn-paneled" id="term-for-in-parallel">in parallel</span>
     <li><span class="dfn-paneled" id="term-for-navigate">navigate</span>
     <li><span class="dfn-paneled" id="term-for-navigation-params">navigation params</span>
     <li><span class="dfn-paneled" id="term-for-obtain-a-site">obtain a site</span>
     <li><span class="dfn-paneled" id="term-for-concept-origin-opaque">opaque origin</span>
     <li><span class="dfn-paneled" id="term-for-concept-origin">origin</span>
     <li><span class="dfn-paneled" id="term-for-concept-origin-port">port</span>
     <li><span class="dfn-paneled" id="term-for-process-a-navigate-fetch">process a navigate fetch</span>
     <li><span class="dfn-paneled" id="term-for-queue-a-task">queue a task</span>
     <li><span class="dfn-paneled" id="term-for-reflect">reflect</span>
     <li><span class="dfn-paneled" id="term-for-rules-for-parsing-integers">rules for parsing integers</span>
     <li><span class="dfn-paneled" id="term-for-rules-for-parsing-non-negative-integers">rules for parsing non-negative integers</span>
     <li><span class="dfn-paneled" id="term-for-same-origin">same origin</span>
     <li><span class="dfn-paneled" id="term-for-same-site">same site</span>
     <li><span class="dfn-paneled" id="term-for-concept-origin-scheme">scheme</span>
     <li><span class="dfn-paneled" id="term-for-script">script</span>
     <li><span class="dfn-paneled" id="term-for-site">site</span>
     <li><span class="dfn-paneled" id="term-for-source-browsing-context">source browsing context</span>
     <li><span class="dfn-paneled" id="term-for-top-level-browsing-context">top-level browsing context</span>
     <li><span class="dfn-paneled" id="term-for-transient-activation">transient activation</span>
     <li><span class="dfn-paneled" id="term-for-window-open-steps">window open steps</span>
    </ul>
   <li>
    <a data-link-type="biblio">[INFRA]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-set-append">append <small>(for set)</small></span>
     <li><span class="dfn-paneled" id="term-for-ascii-hex-digit">ascii hex digit</span>
     <li><span class="dfn-paneled" id="term-for-assert">assert</span>
     <li><span class="dfn-paneled" id="term-for-boolean">boolean</span>
     <li><span class="dfn-paneled" id="term-for-iteration-break">break</span>
     <li><span class="dfn-paneled" id="term-for-byte-sequence">byte sequence</span>
     <li><span class="dfn-paneled" id="term-for-string-code-point-length">code point length</span>
     <li><span class="dfn-paneled" id="term-for-code-point-substring">code point substring</span>
     <li><span class="dfn-paneled" id="term-for-list-contain">contain</span>
     <li><span class="dfn-paneled" id="term-for-iteration-continue">continue</span>
     <li><span class="dfn-paneled" id="term-for-map-exists">exist <small>(for map)</small></span>
     <li><span class="dfn-paneled" id="term-for-implementation-defined">implementation-defined</span>
     <li><span class="dfn-paneled" id="term-for-set-intersection">intersection</span>
     <li><span class="dfn-paneled" id="term-for-string-is">is</span>
     <li><span class="dfn-paneled" id="term-for-list-is-empty">is empty</span>
     <li><span class="dfn-paneled" id="term-for-map-iterate">iterate <small>(for map)</small></span>
     <li><span class="dfn-paneled" id="term-for-map-key">key</span>
     <li><span class="dfn-paneled" id="term-for-string-length">length</span>
     <li><span class="dfn-paneled" id="term-for-list">list</span>
     <li><span class="dfn-paneled" id="term-for-ordered-map">map</span>
     <li><span class="dfn-paneled" id="term-for-ordered-map①">ordered map</span>
     <li><span class="dfn-paneled" id="term-for-ordered-set">ordered set</span>
     <li><span class="dfn-paneled" id="term-for-parse-a-json-string-to-an-infra-value">parse a json string to an infra value</span>
     <li><span class="dfn-paneled" id="term-for-list-remove">remove</span>
     <li><span class="dfn-paneled" id="term-for-serialize-an-infra-value-to-json-bytes">serialize an infra value to json bytes</span>
     <li><span class="dfn-paneled" id="term-for-map-set">set <small>(for map)</small></span>
     <li><span class="dfn-paneled" id="term-for-map-size">size <small>(for map)</small></span>
     <li><span class="dfn-paneled" id="term-for-list-sort-in-ascending-order">sort in ascending order</span>
     <li><span class="dfn-paneled" id="term-for-list-sort-in-descending-order">sort in descending order</span>
     <li><span class="dfn-paneled" id="term-for-string">string</span>
     <li><span class="dfn-paneled" id="term-for-struct">struct</span>
     <li><span class="dfn-paneled" id="term-for-map-value">value</span>
    </ul>
   <li>
    <a data-link-type="biblio">[PERMISSIONS-POLICY-1]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-default-allowlist">default allowlist</span>
     <li><span class="dfn-paneled" id="term-for-policy-controlled-feature">policy-controlled feature</span>
    </ul>
   <li>
    <a data-link-type="biblio">[SECURE-CONTEXTS]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-potentially-trustworthy-origin">potentially trustworthy origin</span>
    </ul>
   <li>
    <a data-link-type="biblio">[STORAGE]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-storage-bottle">storage bottle</span>
    </ul>
   <li>
    <a data-link-type="biblio">[URL]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-concept-url-host">host</span>
     <li><span class="dfn-paneled" id="term-for-concept-url-origin">origin</span>
     <li><span class="dfn-paneled" id="term-for-concept-url-path">path</span>
     <li><span class="dfn-paneled" id="term-for-string-percent-decode">percent-decode</span>
     <li><span class="dfn-paneled" id="term-for-concept-url-port">port</span>
     <li><span class="dfn-paneled" id="term-for-concept-url-scheme">scheme</span>
     <li><span class="dfn-paneled" id="term-for-concept-url">url</span>
     <li><span class="dfn-paneled" id="term-for-concept-url-parser">url parser</span>
     <li><span class="dfn-paneled" id="term-for-concept-url①">url record</span>
    </ul>
   <li>
    <a data-link-type="biblio">[UUID]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-dfn-generate-a-random-uuid">generate a random uuid</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WEBIDL]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-idl-USVString">USVString</span>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-encoding">[ENCODING]
   <dd>Anne van Kesteren. <a href="https://encoding.spec.whatwg.org/"><cite>Encoding Standard</cite></a>. Living Standard. URL: <a href="https://encoding.spec.whatwg.org/">https://encoding.spec.whatwg.org/</a>
   <dt id="biblio-fetch">[FETCH]
   <dd>Anne van Kesteren. <a href="https://fetch.spec.whatwg.org/"><cite>Fetch Standard</cite></a>. Living Standard. URL: <a href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a>
   <dt id="biblio-html">[HTML]
   <dd>Anne van Kesteren; et al. <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML Standard</cite></a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-infra">[INFRA]
   <dd>Anne van Kesteren; Domenic Denicola. <a href="https://infra.spec.whatwg.org/"><cite>Infra Standard</cite></a>. Living Standard. URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
   <dt id="biblio-permissions-policy-1">[PERMISSIONS-POLICY-1]
   <dd>Ian Clelland. <a href="https://w3c.github.io/webappsec-permissions-policy/"><cite>Permissions Policy</cite></a>. URL: <a href="https://w3c.github.io/webappsec-permissions-policy/">https://w3c.github.io/webappsec-permissions-policy/</a>
   <dt id="biblio-rfc2119">[RFC2119]
   <dd>S. Bradner. <a href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. March 1997. Best Current Practice. URL: <a href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
   <dt id="biblio-secure-contexts">[SECURE-CONTEXTS]
   <dd>Mike West. <a href="https://w3c.github.io/webappsec-secure-contexts/"><cite>Secure Contexts</cite></a>. URL: <a href="https://w3c.github.io/webappsec-secure-contexts/">https://w3c.github.io/webappsec-secure-contexts/</a>
   <dt id="biblio-url">[URL]
   <dd>Anne van Kesteren. <a href="https://url.spec.whatwg.org/"><cite>URL Standard</cite></a>. Living Standard. URL: <a href="https://url.spec.whatwg.org/">https://url.spec.whatwg.org/</a>
   <dt id="biblio-webidl">[WEBIDL]
   <dd>Edgar Chen; Timothy Gu. <a href="https://webidl.spec.whatwg.org/"><cite>Web IDL Standard</cite></a>. Living Standard. URL: <a href="https://webidl.spec.whatwg.org/">https://webidl.spec.whatwg.org/</a>
  </dl>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-storage">[STORAGE]
   <dd>Anne van Kesteren. <a href="https://storage.spec.whatwg.org/"><cite>Storage Standard</cite></a>. Living Standard. URL: <a href="https://storage.spec.whatwg.org/">https://storage.spec.whatwg.org/</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
<pre class="idl highlight def"><c- b>interface</c-> <c- b>mixin</c-> <a href="#htmlattributionsrcelementutils"><code><c- g>HTMLAttributionSrcElementUtils</c-></code></a> {
    [<a class="idl-code" data-link-type="extended-attribute" href="https://html.spec.whatwg.org/multipage/custom-elements.html#cereactions"><c- g>CEReactions</c-></a>] <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a> <a data-type="USVString" href="#dom-htmlattributionsrcelementutils-attributionsrc"><code><c- g>attributionSrc</c-></code></a>;
};

<a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/text-level-semantics.html#htmlanchorelement"><c- n>HTMLAnchorElement</c-></a> <c- b>includes</c-> <a data-link-type="idl-name" href="#htmlattributionsrcelementutils"><c- n>HTMLAttributionSrcElementUtils</c-></a>;
<a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/embedded-content.html#htmlimageelement"><c- n>HTMLImageElement</c-></a> <c- b>includes</c-> <a data-link-type="idl-name" href="#htmlattributionsrcelementutils"><c- n>HTMLAttributionSrcElementUtils</c-></a>;
<a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/scripting.html#htmlscriptelement"><c- n>HTMLScriptElement</c-></a> <c- b>includes</c-> <a data-link-type="idl-name" href="#htmlattributionsrcelementutils"><c- n>HTMLAttributionSrcElementUtils</c-></a>;

</pre>
  <h2 class="no-num no-ref heading settled" id="issues-index"><span class="content">Issues Index</span><a class="self-link" href="#issues-index"></a></h2>
  <div style="counter-reset:issue">
   <div class="issue"> Specify monkeypatches for source/trigger registration. <a class="issue-return" href="#issue-963bda2b" title="Jump to section">↵</a></div>
   <div class="issue"> Determine whether to limit <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string-length">length</a> or <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string-code-point-length">code point length</a> for <var>filter</var> and <var>d</var> above. <a class="issue-return" href="#issue-5c232164" title="Jump to section">↵</a></div>
   <div class="issue"> Check for "<code>ar_debug</code>" cookie on <var>reportingOrigin</var> and return <strong>allowed</strong> if it exists, is <code>Secure</code>, is <code>HttpOnly</code>, and is <code>SameSite=None</code>. <a class="issue-return" href="#issue-001a5052" title="Jump to section">↵</a></div>
   <div class="issue"> Specify the steps for making attributionsrc request. <a class="issue-return" href="#issue-45c98580" title="Jump to section">↵</a></div>
   <div class="issue"> Specify the steps for making an attributionsrc request with <var>decodedSrc</var>. <a class="issue-return" href="#issue-1f7755b7" title="Jump to section">↵</a></div>
   <div class="issue"> Ensure that <var>attributionDestination</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin-scheme">scheme</a> is HTTP/HTTPS. <a class="issue-return" href="#issue-e0364022" title="Jump to section">↵</a></div>
   <div class="issue"> Determine whether to change this limit to be time boudned, see <a href="https://github.com/WICG/attribution-reporting-api/issues/482">Source event limits should be time bounded</a>. <a class="issue-return" href="#issue-1ffadd57" title="Jump to section">↵</a></div>
   <div class="issue"> Should fake reports respect the user agent’s <a data-link-type="dfn" href="#max-reports-per-attribution-destination">max reports per attribution destination</a>? <a class="issue-return" href="#issue-82e83119" title="Jump to section">↵</a></div>
   <div class="issue"> Allow the user agent to return null if <var>values</var>’s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-size">size</a> is
greater than some constant. <a class="issue-return" href="#issue-4950c7c2" title="Jump to section">↵</a></div>
   <div class="issue"> Use <a data-link-type="dfn" href="#create-aggregatable-contributions">create aggregatable contributions</a> in <a data-link-type="dfn" href="#trigger-attribution">trigger attribution</a>. <a class="issue-return" href="#issue-67aec5eb" title="Jump to section">↵</a></div>
   <div class="issue"> This would ideally be replaced by a more descriptive algorithm in Infra. See <a href="https://github.com/whatwg/infra/issues/201">infra/201</a> <a class="issue-return" href="#issue-ccb90c6c" title="Jump to section">↵</a></div>
   <div class="issue"> This fetch should use a network partition key for an opaque origin. <a href="https://github.com/WICG/attribution-reporting-api/issues/220">[Issue #220]</a> <a class="issue-return" href="#issue-c8706ee1" title="Jump to section">↵</a></div>
   <div class="issue"> This fetch should use a network partition key for an opaque origin. <a href="https://github.com/WICG/attribution-reporting-api/issues/220">[Issue #220]</a> <a class="issue-return" href="#issue-c8706ee1①" title="Jump to section">↵</a></div>
  </div>
  <aside class="dfn-panel" data-for="htmlattributionsrcelementutils">
   <b><a href="#htmlattributionsrcelementutils">#htmlattributionsrcelementutils</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-htmlattributionsrcelementutils">2.1. API for elements</a> <a href="#ref-for-htmlattributionsrcelementutils①">(2)</a> <a href="#ref-for-htmlattributionsrcelementutils②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-htmlattributionsrcelementutils-attributionsrc">
   <b><a href="#dom-htmlattributionsrcelementutils-attributionsrc">#dom-htmlattributionsrcelementutils-attributionsrc</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-htmlattributionsrcelementutils-attributionsrc">2.1. API for elements</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="element-attrdef-a-attributionsrc">
   <b><a href="#element-attrdef-a-attributionsrc">#element-attrdef-a-attributionsrc</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-element-attrdef-a-attributionsrc">9.5. Obtaining an attribution source from an a element</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="navigation-params-attribution-source">
   <b><a href="#navigation-params-attribution-source">#navigation-params-attribution-source</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-navigation-params-attribution-source">2.2.2. Navigate algorithm</a> <a href="#ref-for-navigation-params-attribution-source①">(2)</a>
    <li><a href="#ref-for-navigation-params-attribution-source②">2.2.3. Process a navigate fetch</a>
    <li><a href="#ref-for-navigation-params-attribution-source③">9.9. Processing an attribution source</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="trigger-state">
   <b><a href="#trigger-state">#trigger-state</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-trigger-state">5.1. Trigger state</a>
    <li><a href="#ref-for-trigger-state">5.2. Randomized source response</a>
    <li><a href="#ref-for-trigger-state①">9.4. Obtaining a randomized source response</a>
    <li><a href="#ref-for-trigger-state②">9.9. Processing an attribution source</a> <a href="#ref-for-trigger-state③">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="trigger-state-trigger-data">
   <b><a href="#trigger-state-trigger-data">#trigger-state-trigger-data</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-trigger-state-trigger-data">9.4. Obtaining a randomized source response</a>
    <li><a href="#ref-for-trigger-state-trigger-data①">9.9. Processing an attribution source</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="trigger-state-report-window">
   <b><a href="#trigger-state-report-window">#trigger-state-report-window</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-trigger-state-report-window">9.4. Obtaining a randomized source response</a>
    <li><a href="#ref-for-trigger-state-report-window①">9.9. Processing an attribution source</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="randomized-source-response">
   <b><a href="#randomized-source-response">#randomized-source-response</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-randomized-source-response">5.2. Randomized source response</a>
    <li><a href="#ref-for-randomized-source-response">5.5. Attribution source</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="filter-value">
   <b><a href="#filter-value">#filter-value</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-filter-value">5.3. Attribution filtering</a>
    <li><a href="#ref-for-filter-value①">10.2. Does filter data match</a> <a href="#ref-for-filter-value②">(2)</a> <a href="#ref-for-filter-value③">(3)</a> <a href="#ref-for-filter-value④">(4)</a> <a href="#ref-for-filter-value⑤">(5)</a> <a href="#ref-for-filter-value⑥">(6)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="filter-map">
   <b><a href="#filter-map">#filter-map</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-filter-map">5.5. Attribution source</a>
    <li><a href="#ref-for-filter-map①">5.6. Aggregatable trigger data</a> <a href="#ref-for-filter-map②">(2)</a>
    <li><a href="#ref-for-filter-map③">5.7. Event-level trigger configuration</a> <a href="#ref-for-filter-map④">(2)</a>
    <li><a href="#ref-for-filter-map⑤">5.8. Attribution trigger</a> <a href="#ref-for-filter-map⑥">(2)</a>
    <li><a href="#ref-for-filter-map⑦">7. Vendor-Specific Values</a> <a href="#ref-for-filter-map⑧">(2)</a>
    <li><a href="#ref-for-filter-map⑨">8.1. Parsing filter data</a>
    <li><a href="#ref-for-filter-map①⓪">9.7. Parsing source-registration JSON</a>
    <li><a href="#ref-for-filter-map①①">10.1. Creating an attribution trigger</a> <a href="#ref-for-filter-map①②">(2)</a> <a href="#ref-for-filter-map①③">(3)</a> <a href="#ref-for-filter-map①④">(4)</a> <a href="#ref-for-filter-map①⑤">(5)</a> <a href="#ref-for-filter-map①⑥">(6)</a>
    <li><a href="#ref-for-filter-map①⑦">10.2. Does filter data match</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="source-type">
   <b><a href="#source-type">#source-type</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-source-type">5.4. Source type</a>
    <li><a href="#ref-for-source-type">5.5. Attribution source</a>
    <li><a href="#ref-for-source-type①">5.9. Event-level report</a>
    <li><a href="#ref-for-source-type②">9.7. Parsing source-registration JSON</a>
    <li><a href="#ref-for-source-type③">10.7. Establishing report delivery time</a> <a href="#ref-for-source-type④">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-source">
   <b><a href="#attribution-source">#attribution-source</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-source">1.1. Overview</a> <a href="#ref-for-attribution-source①">(2)</a>
    <li><a href="#ref-for-attribution-source②">2.1. API for elements</a> <a href="#ref-for-attribution-source③">(2)</a> <a href="#ref-for-attribution-source④">(3)</a>
    <li><a href="#ref-for-attribution-source⑤">2.2. Navigation</a>
    <li><a href="#ref-for-attribution-source⑥">2.2.1. Navigation Params</a>
    <li><a href="#ref-for-attribution-source⑦">2.2.2. Navigate algorithm</a>
    <li><a href="#ref-for-attribution-source⑧">2.2.3. Process a navigate fetch</a>
    <li><a href="#ref-for-attribution-source">5.5. Attribution source</a> <a href="#ref-for-attribution-source⑨">(2)</a> <a href="#ref-for-attribution-source①⓪">(3)</a>
    <li><a href="#ref-for-attribution-source①①">6. Storage</a>
    <li><a href="#ref-for-attribution-source①②">7. Vendor-Specific Values</a> <a href="#ref-for-attribution-source①③">(2)</a> <a href="#ref-for-attribution-source①④">(3)</a> <a href="#ref-for-attribution-source①⑤">(4)</a> <a href="#ref-for-attribution-source①⑥">(5)</a> <a href="#ref-for-attribution-source①⑦">(6)</a> <a href="#ref-for-attribution-source①⑧">(7)</a> <a href="#ref-for-attribution-source①⑨">(8)</a> <a href="#ref-for-attribution-source②⓪">(9)</a> <a href="#ref-for-attribution-source②①">(10)</a> <a href="#ref-for-attribution-source②②">(11)</a>
    <li><a href="#ref-for-attribution-source②③">9.1. Obtaining an attribution source’s expiry time</a>
    <li><a href="#ref-for-attribution-source②④">9.2. Obtaining an attribution source’s source site</a>
    <li><a href="#ref-for-attribution-source②⑤">9.7. Parsing source-registration JSON</a>
    <li><a href="#ref-for-attribution-source②⑥">9.8. Checking pending destination limit</a> <a href="#ref-for-attribution-source②⑦">(2)</a> <a href="#ref-for-attribution-source②⑧">(3)</a>
    <li><a href="#ref-for-attribution-source②⑨">9.9. Processing an attribution source</a> <a href="#ref-for-attribution-source③⓪">(2)</a> <a href="#ref-for-attribution-source③①">(3)</a>
    <li><a href="#ref-for-attribution-source③②">10.2. Does filter data match</a>
    <li><a href="#ref-for-attribution-source③③">10.3. Should attribution be blocked by rate limit</a>
    <li><a href="#ref-for-attribution-source③④">10.5. Creating aggregatable contributions</a>
    <li><a href="#ref-for-attribution-source③⑤">10.7. Establishing report delivery time</a> <a href="#ref-for-attribution-source③⑥">(2)</a> <a href="#ref-for-attribution-source③⑦">(3)</a>
    <li><a href="#ref-for-attribution-source③⑧">10.8. Obtaining an event-level report</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-source-source-identifier">
   <b><a href="#attribution-source-source-identifier">#attribution-source-source-identifier</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-source-source-identifier">9.7. Parsing source-registration JSON</a>
    <li><a href="#ref-for-attribution-source-source-identifier①">10.8. Obtaining an event-level report</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-source-source-origin">
   <b><a href="#attribution-source-source-origin">#attribution-source-source-origin</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-source-source-origin">7. Vendor-Specific Values</a>
    <li><a href="#ref-for-attribution-source-source-origin①">9.2. Obtaining an attribution source’s source site</a>
    <li><a href="#ref-for-attribution-source-source-origin②">9.7. Parsing source-registration JSON</a>
    <li><a href="#ref-for-attribution-source-source-origin③">9.9. Processing an attribution source</a> <a href="#ref-for-attribution-source-source-origin④">(2)</a>
    <li><a href="#ref-for-attribution-source-source-origin⑤">11. Report delivery</a>
    <li><a href="#ref-for-attribution-source-source-origin⑥">13.1. Clearing attribution storage</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-source-event-id">
   <b><a href="#attribution-source-event-id">#attribution-source-event-id</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-source-event-id">7. Vendor-Specific Values</a>
    <li><a href="#ref-for-attribution-source-event-id①">9.7. Parsing source-registration JSON</a>
    <li><a href="#ref-for-attribution-source-event-id②">10.8. Obtaining an event-level report</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-source-attribution-destination">
   <b><a href="#attribution-source-attribution-destination">#attribution-source-attribution-destination</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-source-attribution-destination">1.1. Overview</a>
    <li><a href="#ref-for-attribution-source-attribution-destination①">2.2. Navigation</a>
    <li><a href="#ref-for-attribution-source-attribution-destination②">2.2.4. Document creation</a>
    <li><a href="#ref-for-attribution-source-attribution-destination③">7. Vendor-Specific Values</a>
    <li><a href="#ref-for-attribution-source-attribution-destination④">9.7. Parsing source-registration JSON</a>
    <li><a href="#ref-for-attribution-source-attribution-destination⑤">9.8. Checking pending destination limit</a> <a href="#ref-for-attribution-source-attribution-destination⑥">(2)</a> <a href="#ref-for-attribution-source-attribution-destination⑦">(3)</a> <a href="#ref-for-attribution-source-attribution-destination⑧">(4)</a>
    <li><a href="#ref-for-attribution-source-attribution-destination⑨">9.9. Processing an attribution source</a> <a href="#ref-for-attribution-source-attribution-destination①⓪">(2)</a> <a href="#ref-for-attribution-source-attribution-destination①①">(3)</a>
    <li><a href="#ref-for-attribution-source-attribution-destination①②">10.6. Triggering attribution</a>
    <li><a href="#ref-for-attribution-source-attribution-destination①③">10.8. Obtaining an event-level report</a>
    <li><a href="#ref-for-attribution-source-attribution-destination①④">13.1. Clearing attribution storage</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-source-reporting-endpoint">
   <b><a href="#attribution-source-reporting-endpoint">#attribution-source-reporting-endpoint</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-source-reporting-endpoint">7. Vendor-Specific Values</a> <a href="#ref-for-attribution-source-reporting-endpoint①">(2)</a>
    <li><a href="#ref-for-attribution-source-reporting-endpoint②">9.7. Parsing source-registration JSON</a>
    <li><a href="#ref-for-attribution-source-reporting-endpoint③">9.8. Checking pending destination limit</a> <a href="#ref-for-attribution-source-reporting-endpoint④">(2)</a>
    <li><a href="#ref-for-attribution-source-reporting-endpoint⑤">9.9. Processing an attribution source</a> <a href="#ref-for-attribution-source-reporting-endpoint⑥">(2)</a>
    <li><a href="#ref-for-attribution-source-reporting-endpoint⑦">10.6. Triggering attribution</a> <a href="#ref-for-attribution-source-reporting-endpoint⑧">(2)</a>
    <li><a href="#ref-for-attribution-source-reporting-endpoint⑨">10.8. Obtaining an event-level report</a>
    <li><a href="#ref-for-attribution-source-reporting-endpoint①⓪">13.1. Clearing attribution storage</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-source-source-type">
   <b><a href="#attribution-source-source-type">#attribution-source-source-type</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-source-source-type">7. Vendor-Specific Values</a> <a href="#ref-for-attribution-source-source-type①">(2)</a> <a href="#ref-for-attribution-source-source-type②">(3)</a> <a href="#ref-for-attribution-source-source-type③">(4)</a> <a href="#ref-for-attribution-source-source-type④">(5)</a> <a href="#ref-for-attribution-source-source-type⑤">(6)</a>
    <li><a href="#ref-for-attribution-source-source-type⑥">9.7. Parsing source-registration JSON</a>
    <li><a href="#ref-for-attribution-source-source-type⑦">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-attribution-source-source-type⑧">10.6. Triggering attribution</a>
    <li><a href="#ref-for-attribution-source-source-type⑨">10.7. Establishing report delivery time</a> <a href="#ref-for-attribution-source-source-type①⓪">(2)</a>
    <li><a href="#ref-for-attribution-source-source-type①①">10.8. Obtaining an event-level report</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-source-expiry">
   <b><a href="#attribution-source-expiry">#attribution-source-expiry</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-source-expiry">7. Vendor-Specific Values</a>
    <li><a href="#ref-for-attribution-source-expiry①">9.1. Obtaining an attribution source’s expiry time</a>
    <li><a href="#ref-for-attribution-source-expiry②">9.7. Parsing source-registration JSON</a>
    <li><a href="#ref-for-attribution-source-expiry③">10.7. Establishing report delivery time</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-source-priority">
   <b><a href="#attribution-source-priority">#attribution-source-priority</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-source-priority">9.7. Parsing source-registration JSON</a>
    <li><a href="#ref-for-attribution-source-priority①">10.6. Triggering attribution</a> <a href="#ref-for-attribution-source-priority②">(2)</a> <a href="#ref-for-attribution-source-priority③">(3)</a> <a href="#ref-for-attribution-source-priority④">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-source-source-time">
   <b><a href="#attribution-source-source-time">#attribution-source-source-time</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-source-source-time">9.1. Obtaining an attribution source’s expiry time</a>
    <li><a href="#ref-for-attribution-source-source-time①">9.7. Parsing source-registration JSON</a>
    <li><a href="#ref-for-attribution-source-source-time②">9.9. Processing an attribution source</a> <a href="#ref-for-attribution-source-source-time③">(2)</a>
    <li><a href="#ref-for-attribution-source-source-time④">10.6. Triggering attribution</a> <a href="#ref-for-attribution-source-source-time⑤">(2)</a>
    <li><a href="#ref-for-attribution-source-source-time⑥">10.7. Establishing report delivery time</a> <a href="#ref-for-attribution-source-source-time⑦">(2)</a> <a href="#ref-for-attribution-source-source-time⑧">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-source-number-of-event-level-reports">
   <b><a href="#attribution-source-number-of-event-level-reports">#attribution-source-number-of-event-level-reports</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-source-number-of-event-level-reports">9.8. Checking pending destination limit</a>
    <li><a href="#ref-for-attribution-source-number-of-event-level-reports①">10.6. Triggering attribution</a> <a href="#ref-for-attribution-source-number-of-event-level-reports②">(2)</a> <a href="#ref-for-attribution-source-number-of-event-level-reports③">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-source-dedup-keys">
   <b><a href="#attribution-source-dedup-keys">#attribution-source-dedup-keys</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-source-dedup-keys">10.6. Triggering attribution</a> <a href="#ref-for-attribution-source-dedup-keys①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-source-randomized-response">
   <b><a href="#attribution-source-randomized-response">#attribution-source-randomized-response</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-source-randomized-response">9.7. Parsing source-registration JSON</a>
    <li><a href="#ref-for-attribution-source-randomized-response①">9.9. Processing an attribution source</a> <a href="#ref-for-attribution-source-randomized-response②">(2)</a> <a href="#ref-for-attribution-source-randomized-response③">(3)</a>
    <li><a href="#ref-for-attribution-source-randomized-response④">10.6. Triggering attribution</a> <a href="#ref-for-attribution-source-randomized-response⑤">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-source-randomized-trigger-rate">
   <b><a href="#attribution-source-randomized-trigger-rate">#attribution-source-randomized-trigger-rate</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-source-randomized-trigger-rate">9.7. Parsing source-registration JSON</a>
    <li><a href="#ref-for-attribution-source-randomized-trigger-rate①">10.8. Obtaining an event-level report</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-source-filter-data">
   <b><a href="#attribution-source-filter-data">#attribution-source-filter-data</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-source-filter-data">9.7. Parsing source-registration JSON</a>
    <li><a href="#ref-for-attribution-source-filter-data①">10.2. Does filter data match</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-source-debug-key">
   <b><a href="#attribution-source-debug-key">#attribution-source-debug-key</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-source-debug-key">9.7. Parsing source-registration JSON</a>
    <li><a href="#ref-for-attribution-source-debug-key①">10.8. Obtaining an event-level report</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-source-aggregation-keys">
   <b><a href="#attribution-source-aggregation-keys">#attribution-source-aggregation-keys</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-source-aggregation-keys">7. Vendor-Specific Values</a>
    <li><a href="#ref-for-attribution-source-aggregation-keys①">9.7. Parsing source-registration JSON</a>
    <li><a href="#ref-for-attribution-source-aggregation-keys②">10.5. Creating aggregatable contributions</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-source-aggregatable-expiry">
   <b><a href="#attribution-source-aggregatable-expiry">#attribution-source-aggregatable-expiry</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-source-aggregatable-expiry">9.7. Parsing source-registration JSON</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="aggregatable-trigger-data">
   <b><a href="#aggregatable-trigger-data">#aggregatable-trigger-data</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-aggregatable-trigger-data">5.6. Aggregatable trigger data</a>
    <li><a href="#ref-for-aggregatable-trigger-data">5.8. Attribution trigger</a>
    <li><a href="#ref-for-aggregatable-trigger-data①">7. Vendor-Specific Values</a>
    <li><a href="#ref-for-aggregatable-trigger-data②">10.1. Creating an attribution trigger</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="aggregatable-trigger-data-key-piece">
   <b><a href="#aggregatable-trigger-data-key-piece">#aggregatable-trigger-data-key-piece</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-aggregatable-trigger-data-key-piece">10.1. Creating an attribution trigger</a>
    <li><a href="#ref-for-aggregatable-trigger-data-key-piece①">10.5. Creating aggregatable contributions</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="aggregatable-trigger-data-source-keys">
   <b><a href="#aggregatable-trigger-data-source-keys">#aggregatable-trigger-data-source-keys</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-aggregatable-trigger-data-source-keys">7. Vendor-Specific Values</a>
    <li><a href="#ref-for-aggregatable-trigger-data-source-keys①">10.1. Creating an attribution trigger</a>
    <li><a href="#ref-for-aggregatable-trigger-data-source-keys②">10.5. Creating aggregatable contributions</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="aggregatable-trigger-data-filters">
   <b><a href="#aggregatable-trigger-data-filters">#aggregatable-trigger-data-filters</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-aggregatable-trigger-data-filters">10.1. Creating an attribution trigger</a>
    <li><a href="#ref-for-aggregatable-trigger-data-filters①">10.5. Creating aggregatable contributions</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="aggregatable-trigger-data-negated-filters">
   <b><a href="#aggregatable-trigger-data-negated-filters">#aggregatable-trigger-data-negated-filters</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-aggregatable-trigger-data-negated-filters">10.1. Creating an attribution trigger</a>
    <li><a href="#ref-for-aggregatable-trigger-data-negated-filters①">10.5. Creating aggregatable contributions</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="event-level-trigger-configuration">
   <b><a href="#event-level-trigger-configuration">#event-level-trigger-configuration</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-event-level-trigger-configuration">5.7. Event-level trigger configuration</a>
    <li><a href="#ref-for-event-level-trigger-configuration">5.8. Attribution trigger</a>
    <li><a href="#ref-for-event-level-trigger-configuration①">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-event-level-trigger-configuration②">10.1. Creating an attribution trigger</a>
    <li><a href="#ref-for-event-level-trigger-configuration③">10.6. Triggering attribution</a>
    <li><a href="#ref-for-event-level-trigger-configuration④">10.8. Obtaining an event-level report</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="event-level-trigger-configuration-trigger-data">
   <b><a href="#event-level-trigger-configuration-trigger-data">#event-level-trigger-configuration-trigger-data</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-event-level-trigger-configuration-trigger-data">7. Vendor-Specific Values</a> <a href="#ref-for-event-level-trigger-configuration-trigger-data①">(2)</a> <a href="#ref-for-event-level-trigger-configuration-trigger-data②">(3)</a> <a href="#ref-for-event-level-trigger-configuration-trigger-data③">(4)</a>
    <li><a href="#ref-for-event-level-trigger-configuration-trigger-data④">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-event-level-trigger-configuration-trigger-data⑤">10.1. Creating an attribution trigger</a>
    <li><a href="#ref-for-event-level-trigger-configuration-trigger-data⑥">10.8. Obtaining an event-level report</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="event-level-trigger-configuration-dedup-key">
   <b><a href="#event-level-trigger-configuration-dedup-key">#event-level-trigger-configuration-dedup-key</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-event-level-trigger-configuration-dedup-key">5.5. Attribution source</a>
    <li><a href="#ref-for-event-level-trigger-configuration-dedup-key①">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-event-level-trigger-configuration-dedup-key②">10.1. Creating an attribution trigger</a>
    <li><a href="#ref-for-event-level-trigger-configuration-dedup-key③">10.6. Triggering attribution</a> <a href="#ref-for-event-level-trigger-configuration-dedup-key④">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="event-level-trigger-configuration-priority">
   <b><a href="#event-level-trigger-configuration-priority">#event-level-trigger-configuration-priority</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-event-level-trigger-configuration-priority">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-event-level-trigger-configuration-priority①">10.1. Creating an attribution trigger</a>
    <li><a href="#ref-for-event-level-trigger-configuration-priority②">10.8. Obtaining an event-level report</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="event-level-trigger-configuration-filters">
   <b><a href="#event-level-trigger-configuration-filters">#event-level-trigger-configuration-filters</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-event-level-trigger-configuration-filters">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-event-level-trigger-configuration-filters①">10.1. Creating an attribution trigger</a>
    <li><a href="#ref-for-event-level-trigger-configuration-filters②">10.6. Triggering attribution</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="event-level-trigger-configuration-negated-filters">
   <b><a href="#event-level-trigger-configuration-negated-filters">#event-level-trigger-configuration-negated-filters</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-event-level-trigger-configuration-negated-filters">10.1. Creating an attribution trigger</a>
    <li><a href="#ref-for-event-level-trigger-configuration-negated-filters①">10.6. Triggering attribution</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-trigger">
   <b><a href="#attribution-trigger">#attribution-trigger</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-trigger">1.1. Overview</a> <a href="#ref-for-attribution-trigger①">(2)</a>
    <li><a href="#ref-for-attribution-trigger②">2.1. API for elements</a> <a href="#ref-for-attribution-trigger③">(2)</a>
    <li><a href="#ref-for-attribution-trigger">5.8. Attribution trigger</a>
    <li><a href="#ref-for-attribution-trigger④">7. Vendor-Specific Values</a> <a href="#ref-for-attribution-trigger⑤">(2)</a>
    <li><a href="#ref-for-attribution-trigger⑥">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-attribution-trigger⑦">10.1. Creating an attribution trigger</a>
    <li><a href="#ref-for-attribution-trigger⑧">10.3. Should attribution be blocked by rate limit</a>
    <li><a href="#ref-for-attribution-trigger⑨">10.5. Creating aggregatable contributions</a>
    <li><a href="#ref-for-attribution-trigger①⓪">10.6. Triggering attribution</a>
    <li><a href="#ref-for-attribution-trigger①①">10.8. Obtaining an event-level report</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-trigger-attribution-destination">
   <b><a href="#attribution-trigger-attribution-destination">#attribution-trigger-attribution-destination</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-trigger-attribution-destination">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-attribution-trigger-attribution-destination①">10.1. Creating an attribution trigger</a>
    <li><a href="#ref-for-attribution-trigger-attribution-destination②">10.3. Should attribution be blocked by rate limit</a>
    <li><a href="#ref-for-attribution-trigger-attribution-destination③">10.6. Triggering attribution</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-trigger-trigger-time">
   <b><a href="#attribution-trigger-trigger-time">#attribution-trigger-trigger-time</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-trigger-trigger-time">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-attribution-trigger-trigger-time①">10.1. Creating an attribution trigger</a>
    <li><a href="#ref-for-attribution-trigger-trigger-time②">10.3. Should attribution be blocked by rate limit</a>
    <li><a href="#ref-for-attribution-trigger-trigger-time③">10.6. Triggering attribution</a>
    <li><a href="#ref-for-attribution-trigger-trigger-time④">10.8. Obtaining an event-level report</a> <a href="#ref-for-attribution-trigger-trigger-time⑤">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-trigger-reporting-endpoint">
   <b><a href="#attribution-trigger-reporting-endpoint">#attribution-trigger-reporting-endpoint</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-trigger-reporting-endpoint">7. Vendor-Specific Values</a>
    <li><a href="#ref-for-attribution-trigger-reporting-endpoint①">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-attribution-trigger-reporting-endpoint②">10.1. Creating an attribution trigger</a>
    <li><a href="#ref-for-attribution-trigger-reporting-endpoint③">10.3. Should attribution be blocked by rate limit</a>
    <li><a href="#ref-for-attribution-trigger-reporting-endpoint④">10.6. Triggering attribution</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-trigger-filters">
   <b><a href="#attribution-trigger-filters">#attribution-trigger-filters</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-trigger-filters">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-attribution-trigger-filters①">10.1. Creating an attribution trigger</a>
    <li><a href="#ref-for-attribution-trigger-filters②">10.6. Triggering attribution</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-trigger-negated-filters">
   <b><a href="#attribution-trigger-negated-filters">#attribution-trigger-negated-filters</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-trigger-negated-filters">10.1. Creating an attribution trigger</a>
    <li><a href="#ref-for-attribution-trigger-negated-filters①">10.6. Triggering attribution</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-trigger-debug-key">
   <b><a href="#attribution-trigger-debug-key">#attribution-trigger-debug-key</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-trigger-debug-key">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-attribution-trigger-debug-key①">10.1. Creating an attribution trigger</a>
    <li><a href="#ref-for-attribution-trigger-debug-key②">10.8. Obtaining an event-level report</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-trigger-event-level-trigger-configurations">
   <b><a href="#attribution-trigger-event-level-trigger-configurations">#attribution-trigger-event-level-trigger-configurations</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-trigger-event-level-trigger-configurations">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-attribution-trigger-event-level-trigger-configurations①">10.1. Creating an attribution trigger</a>
    <li><a href="#ref-for-attribution-trigger-event-level-trigger-configurations②">10.6. Triggering attribution</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-trigger-aggregatable-trigger-data">
   <b><a href="#attribution-trigger-aggregatable-trigger-data">#attribution-trigger-aggregatable-trigger-data</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-trigger-aggregatable-trigger-data">7. Vendor-Specific Values</a>
    <li><a href="#ref-for-attribution-trigger-aggregatable-trigger-data①">10.1. Creating an attribution trigger</a>
    <li><a href="#ref-for-attribution-trigger-aggregatable-trigger-data②">10.5. Creating aggregatable contributions</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-trigger-aggregatable-values">
   <b><a href="#attribution-trigger-aggregatable-values">#attribution-trigger-aggregatable-values</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-trigger-aggregatable-values">7. Vendor-Specific Values</a>
    <li><a href="#ref-for-attribution-trigger-aggregatable-values①">10.1. Creating an attribution trigger</a>
    <li><a href="#ref-for-attribution-trigger-aggregatable-values②">10.5. Creating aggregatable contributions</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-trigger-aggregatable-dedup-key">
   <b><a href="#attribution-trigger-aggregatable-dedup-key">#attribution-trigger-aggregatable-dedup-key</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-trigger-aggregatable-dedup-key">10.1. Creating an attribution trigger</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="event-level-report">
   <b><a href="#event-level-report">#event-level-report</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-event-level-report">1.1. Overview</a> <a href="#ref-for-event-level-report①">(2)</a>
    <li><a href="#ref-for-event-level-report②">5.5. Attribution source</a>
    <li><a href="#ref-for-event-level-report">5.9. Event-level report</a>
    <li><a href="#ref-for-event-level-report③">6. Storage</a>
    <li><a href="#ref-for-event-level-report④">7. Vendor-Specific Values</a> <a href="#ref-for-event-level-report⑤">(2)</a> <a href="#ref-for-event-level-report⑥">(3)</a> <a href="#ref-for-event-level-report⑦">(4)</a> <a href="#ref-for-event-level-report⑧">(5)</a>
    <li><a href="#ref-for-event-level-report⑨">10.8. Obtaining an event-level report</a>
    <li><a href="#ref-for-event-level-report①⓪">11. Report delivery</a>
    <li><a href="#ref-for-event-level-report①①">11.2. Serialize attribution report body</a>
    <li><a href="#ref-for-event-level-report①②">11.3. Get report request URL</a>
    <li><a href="#ref-for-event-level-report①③">11.4. Creating a report request</a>
    <li><a href="#ref-for-event-level-report①④">11.5. Issuing a report request</a>
    <li><a href="#ref-for-event-level-report①⑤">11.6. Issuing a debug report request</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="event-level-report-event-id">
   <b><a href="#event-level-report-event-id">#event-level-report-event-id</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-event-level-report-event-id">10.8. Obtaining an event-level report</a>
    <li><a href="#ref-for-event-level-report-event-id①">11.2. Serialize attribution report body</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="event-level-report-source-type">
   <b><a href="#event-level-report-source-type">#event-level-report-source-type</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-event-level-report-source-type">11.2. Serialize attribution report body</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="event-level-report-trigger-data">
   <b><a href="#event-level-report-trigger-data">#event-level-report-trigger-data</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-event-level-report-trigger-data">10.8. Obtaining an event-level report</a>
    <li><a href="#ref-for-event-level-report-trigger-data①">11.2. Serialize attribution report body</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="event-level-report-randomized-trigger-rate">
   <b><a href="#event-level-report-randomized-trigger-rate">#event-level-report-randomized-trigger-rate</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-event-level-report-randomized-trigger-rate">10.8. Obtaining an event-level report</a>
    <li><a href="#ref-for-event-level-report-randomized-trigger-rate①">11.2. Serialize attribution report body</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="event-level-report-reporting-endpoint">
   <b><a href="#event-level-report-reporting-endpoint">#event-level-report-reporting-endpoint</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-event-level-report-reporting-endpoint">10.8. Obtaining an event-level report</a>
    <li><a href="#ref-for-event-level-report-reporting-endpoint①">11.3. Get report request URL</a>
    <li><a href="#ref-for-event-level-report-reporting-endpoint②">11.5. Issuing a report request</a>
    <li><a href="#ref-for-event-level-report-reporting-endpoint③">13.1. Clearing attribution storage</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="event-level-report-attribution-destination">
   <b><a href="#event-level-report-attribution-destination">#event-level-report-attribution-destination</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-event-level-report-attribution-destination">7. Vendor-Specific Values</a>
    <li><a href="#ref-for-event-level-report-attribution-destination①">10.6. Triggering attribution</a>
    <li><a href="#ref-for-event-level-report-attribution-destination②">10.8. Obtaining an event-level report</a>
    <li><a href="#ref-for-event-level-report-attribution-destination③">11.2. Serialize attribution report body</a>
    <li><a href="#ref-for-event-level-report-attribution-destination④">13.1. Clearing attribution storage</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="event-level-report-report-time">
   <b><a href="#event-level-report-report-time">#event-level-report-report-time</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-event-level-report-report-time">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-event-level-report-report-time①">10.6. Triggering attribution</a> <a href="#ref-for-event-level-report-report-time②">(2)</a>
    <li><a href="#ref-for-event-level-report-report-time③">10.8. Obtaining an event-level report</a>
    <li><a href="#ref-for-event-level-report-report-time④">11. Report delivery</a> <a href="#ref-for-event-level-report-report-time⑤">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="event-level-report-trigger-priority">
   <b><a href="#event-level-report-trigger-priority">#event-level-report-trigger-priority</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-event-level-report-trigger-priority">10.6. Triggering attribution</a> <a href="#ref-for-event-level-report-trigger-priority①">(2)</a> <a href="#ref-for-event-level-report-trigger-priority②">(3)</a> <a href="#ref-for-event-level-report-trigger-priority③">(4)</a> <a href="#ref-for-event-level-report-trigger-priority④">(5)</a> <a href="#ref-for-event-level-report-trigger-priority⑤">(6)</a>
    <li><a href="#ref-for-event-level-report-trigger-priority⑥">10.8. Obtaining an event-level report</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="event-level-report-trigger-time">
   <b><a href="#event-level-report-trigger-time">#event-level-report-trigger-time</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-event-level-report-trigger-time">10.6. Triggering attribution</a> <a href="#ref-for-event-level-report-trigger-time①">(2)</a>
    <li><a href="#ref-for-event-level-report-trigger-time②">10.8. Obtaining an event-level report</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="event-level-report-source-identifier">
   <b><a href="#event-level-report-source-identifier">#event-level-report-source-identifier</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-event-level-report-source-identifier">10.6. Triggering attribution</a> <a href="#ref-for-event-level-report-source-identifier①">(2)</a>
    <li><a href="#ref-for-event-level-report-source-identifier②">10.8. Obtaining an event-level report</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="event-level-report-delivered">
   <b><a href="#event-level-report-delivered">#event-level-report-delivered</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-event-level-report-delivered">11. Report delivery</a> <a href="#ref-for-event-level-report-delivered①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="event-level-report-report-id">
   <b><a href="#event-level-report-report-id">#event-level-report-report-id</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-event-level-report-report-id">10.8. Obtaining an event-level report</a>
    <li><a href="#ref-for-event-level-report-report-id①">11.2. Serialize attribution report body</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="event-level-report-source-debug-key">
   <b><a href="#event-level-report-source-debug-key">#event-level-report-source-debug-key</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-event-level-report-source-debug-key">10.6. Triggering attribution</a>
    <li><a href="#ref-for-event-level-report-source-debug-key①">10.8. Obtaining an event-level report</a>
    <li><a href="#ref-for-event-level-report-source-debug-key②">11.2. Serialize attribution report body</a> <a href="#ref-for-event-level-report-source-debug-key③">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="event-level-report-trigger-debug-key">
   <b><a href="#event-level-report-trigger-debug-key">#event-level-report-trigger-debug-key</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-event-level-report-trigger-debug-key">10.6. Triggering attribution</a>
    <li><a href="#ref-for-event-level-report-trigger-debug-key①">10.8. Obtaining an event-level report</a>
    <li><a href="#ref-for-event-level-report-trigger-debug-key②">11.2. Serialize attribution report body</a> <a href="#ref-for-event-level-report-trigger-debug-key③">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="aggregatable-contribution">
   <b><a href="#aggregatable-contribution">#aggregatable-contribution</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-aggregatable-contribution">5.10. Aggregatable contribution</a>
    <li><a href="#ref-for-aggregatable-contribution">10.5. Creating aggregatable contributions</a> <a href="#ref-for-aggregatable-contribution①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="aggregatable-contribution-key">
   <b><a href="#aggregatable-contribution-key">#aggregatable-contribution-key</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-aggregatable-contribution-key">10.5. Creating aggregatable contributions</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="aggregatable-contribution-value">
   <b><a href="#aggregatable-contribution-value">#aggregatable-contribution-value</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-aggregatable-contribution-value">10.5. Creating aggregatable contributions</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-rate-limit-record">
   <b><a href="#attribution-rate-limit-record">#attribution-rate-limit-record</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-rate-limit-record">5.11. Attribution rate-limit record</a>
    <li><a href="#ref-for-attribution-rate-limit-record">6. Storage</a>
    <li><a href="#ref-for-attribution-rate-limit-record①">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-attribution-rate-limit-record②">10.3. Should attribution be blocked by rate limit</a>
    <li><a href="#ref-for-attribution-rate-limit-record③">10.4. Should processing be blocked by reporting-endpoint limit</a> <a href="#ref-for-attribution-rate-limit-record④">(2)</a>
    <li><a href="#ref-for-attribution-rate-limit-record⑤">10.6. Triggering attribution</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-rate-limit-record-scope">
   <b><a href="#attribution-rate-limit-record-scope">#attribution-rate-limit-record-scope</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-rate-limit-record-scope">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-attribution-rate-limit-record-scope①">10.3. Should attribution be blocked by rate limit</a>
    <li><a href="#ref-for-attribution-rate-limit-record-scope②">10.4. Should processing be blocked by reporting-endpoint limit</a> <a href="#ref-for-attribution-rate-limit-record-scope③">(2)</a> <a href="#ref-for-attribution-rate-limit-record-scope④">(3)</a>
    <li><a href="#ref-for-attribution-rate-limit-record-scope⑤">10.6. Triggering attribution</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-rate-limit-record-source-site">
   <b><a href="#attribution-rate-limit-record-source-site">#attribution-rate-limit-record-source-site</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-rate-limit-record-source-site">7. Vendor-Specific Values</a> <a href="#ref-for-attribution-rate-limit-record-source-site①">(2)</a> <a href="#ref-for-attribution-rate-limit-record-source-site②">(3)</a>
    <li><a href="#ref-for-attribution-rate-limit-record-source-site③">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-attribution-rate-limit-record-source-site④">10.3. Should attribution be blocked by rate limit</a>
    <li><a href="#ref-for-attribution-rate-limit-record-source-site⑤">10.4. Should processing be blocked by reporting-endpoint limit</a> <a href="#ref-for-attribution-rate-limit-record-source-site⑥">(2)</a>
    <li><a href="#ref-for-attribution-rate-limit-record-source-site⑦">10.6. Triggering attribution</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-rate-limit-record-attribution-destination">
   <b><a href="#attribution-rate-limit-record-attribution-destination">#attribution-rate-limit-record-attribution-destination</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-rate-limit-record-attribution-destination">7. Vendor-Specific Values</a> <a href="#ref-for-attribution-rate-limit-record-attribution-destination①">(2)</a> <a href="#ref-for-attribution-rate-limit-record-attribution-destination②">(3)</a>
    <li><a href="#ref-for-attribution-rate-limit-record-attribution-destination③">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-attribution-rate-limit-record-attribution-destination④">10.3. Should attribution be blocked by rate limit</a>
    <li><a href="#ref-for-attribution-rate-limit-record-attribution-destination⑤">10.4. Should processing be blocked by reporting-endpoint limit</a> <a href="#ref-for-attribution-rate-limit-record-attribution-destination⑥">(2)</a>
    <li><a href="#ref-for-attribution-rate-limit-record-attribution-destination⑦">10.6. Triggering attribution</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-rate-limit-record-reporting-endpoint">
   <b><a href="#attribution-rate-limit-record-reporting-endpoint">#attribution-rate-limit-record-reporting-endpoint</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-rate-limit-record-reporting-endpoint">7. Vendor-Specific Values</a>
    <li><a href="#ref-for-attribution-rate-limit-record-reporting-endpoint①">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-attribution-rate-limit-record-reporting-endpoint②">10.3. Should attribution be blocked by rate limit</a>
    <li><a href="#ref-for-attribution-rate-limit-record-reporting-endpoint③">10.4. Should processing be blocked by reporting-endpoint limit</a> <a href="#ref-for-attribution-rate-limit-record-reporting-endpoint④">(2)</a>
    <li><a href="#ref-for-attribution-rate-limit-record-reporting-endpoint⑤">10.6. Triggering attribution</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-rate-limit-record-time">
   <b><a href="#attribution-rate-limit-record-time">#attribution-rate-limit-record-time</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-rate-limit-record-time">9.9. Processing an attribution source</a> <a href="#ref-for-attribution-rate-limit-record-time①">(2)</a>
    <li><a href="#ref-for-attribution-rate-limit-record-time②">10.3. Should attribution be blocked by rate limit</a>
    <li><a href="#ref-for-attribution-rate-limit-record-time③">10.4. Should processing be blocked by reporting-endpoint limit</a> <a href="#ref-for-attribution-rate-limit-record-time④">(2)</a>
    <li><a href="#ref-for-attribution-rate-limit-record-time⑤">10.6. Triggering attribution</a> <a href="#ref-for-attribution-rate-limit-record-time⑥">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-source-cache">
   <b><a href="#attribution-source-cache">#attribution-source-cache</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-source-cache">7. Vendor-Specific Values</a> <a href="#ref-for-attribution-source-cache①">(2)</a>
    <li><a href="#ref-for-attribution-source-cache②">9.8. Checking pending destination limit</a>
    <li><a href="#ref-for-attribution-source-cache③">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-attribution-source-cache④">10.6. Triggering attribution</a> <a href="#ref-for-attribution-source-cache⑤">(2)</a> <a href="#ref-for-attribution-source-cache⑥">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="event-level-report-cache">
   <b><a href="#event-level-report-cache">#event-level-report-cache</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-event-level-report-cache">7. Vendor-Specific Values</a> <a href="#ref-for-event-level-report-cache①">(2)</a>
    <li><a href="#ref-for-event-level-report-cache②">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-event-level-report-cache③">10.6. Triggering attribution</a> <a href="#ref-for-event-level-report-cache④">(2)</a> <a href="#ref-for-event-level-report-cache⑤">(3)</a> <a href="#ref-for-event-level-report-cache⑥">(4)</a> <a href="#ref-for-event-level-report-cache⑦">(5)</a>
    <li><a href="#ref-for-event-level-report-cache⑧">11. Report delivery</a>
    <li><a href="#ref-for-event-level-report-cache⑨">11.5. Issuing a report request</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-rate-limit-cache">
   <b><a href="#attribution-rate-limit-cache">#attribution-rate-limit-cache</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-rate-limit-cache">9.9. Processing an attribution source</a> <a href="#ref-for-attribution-rate-limit-cache①">(2)</a>
    <li><a href="#ref-for-attribution-rate-limit-cache②">10.3. Should attribution be blocked by rate limit</a>
    <li><a href="#ref-for-attribution-rate-limit-cache③">10.4. Should processing be blocked by reporting-endpoint limit</a>
    <li><a href="#ref-for-attribution-rate-limit-cache④">10.6. Triggering attribution</a> <a href="#ref-for-attribution-rate-limit-cache⑤">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-caches">
   <b><a href="#attribution-caches">#attribution-caches</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-caches">6. Storage</a>
    <li><a href="#ref-for-attribution-caches①">13.1. Clearing attribution storage</a> <a href="#ref-for-attribution-caches②">(2)</a> <a href="#ref-for-attribution-caches③">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="source-event-id-cardinality">
   <b><a href="#source-event-id-cardinality">#source-event-id-cardinality</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-source-event-id-cardinality">9.7. Parsing source-registration JSON</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="max-source-expiry">
   <b><a href="#max-source-expiry">#max-source-expiry</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-max-source-expiry">9.7. Parsing source-registration JSON</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="max-entries-per-filter-map">
   <b><a href="#max-entries-per-filter-map">#max-entries-per-filter-map</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-max-entries-per-filter-map">8.1. Parsing filter data</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="max-values-per-filter-entry">
   <b><a href="#max-values-per-filter-entry">#max-values-per-filter-entry</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-max-values-per-filter-entry">8.1. Parsing filter data</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="max-aggregation-keys-per-attribution">
   <b><a href="#max-aggregation-keys-per-attribution">#max-aggregation-keys-per-attribution</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-max-aggregation-keys-per-attribution">9.7. Parsing source-registration JSON</a>
    <li><a href="#ref-for-max-aggregation-keys-per-attribution①">10.1. Creating an attribution trigger</a> <a href="#ref-for-max-aggregation-keys-per-attribution②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="max-aggregatable-trigger-data-per-trigger">
   <b><a href="#max-aggregatable-trigger-data-per-trigger">#max-aggregatable-trigger-data-per-trigger</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-max-aggregatable-trigger-data-per-trigger">10.1. Creating an attribution trigger</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="max-pending-sources-per-source-origin">
   <b><a href="#max-pending-sources-per-source-origin">#max-pending-sources-per-source-origin</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-max-pending-sources-per-source-origin">9.9. Processing an attribution source</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="navigation-source-trigger-data-cardinality">
   <b><a href="#navigation-source-trigger-data-cardinality">#navigation-source-trigger-data-cardinality</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-navigation-source-trigger-data-cardinality">7. Vendor-Specific Values</a>
    <li><a href="#ref-for-navigation-source-trigger-data-cardinality①">9.7. Parsing source-registration JSON</a>
    <li><a href="#ref-for-navigation-source-trigger-data-cardinality②">10.8. Obtaining an event-level report</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="event-source-trigger-data-cardinality">
   <b><a href="#event-source-trigger-data-cardinality">#event-source-trigger-data-cardinality</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-event-source-trigger-data-cardinality">7. Vendor-Specific Values</a>
    <li><a href="#ref-for-event-source-trigger-data-cardinality①">9.7. Parsing source-registration JSON</a>
    <li><a href="#ref-for-event-source-trigger-data-cardinality②">10.8. Obtaining an event-level report</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="randomized-navigation-source-trigger-rate">
   <b><a href="#randomized-navigation-source-trigger-rate">#randomized-navigation-source-trigger-rate</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-randomized-navigation-source-trigger-rate">9.7. Parsing source-registration JSON</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="randomized-event-source-trigger-rate">
   <b><a href="#randomized-event-source-trigger-rate">#randomized-event-source-trigger-rate</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-randomized-event-source-trigger-rate">9.7. Parsing source-registration JSON</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="max-reports-per-attribution-destination">
   <b><a href="#max-reports-per-attribution-destination">#max-reports-per-attribution-destination</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-max-reports-per-attribution-destination">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-max-reports-per-attribution-destination①">10.6. Triggering attribution</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="max-attributions-per-navigation-source">
   <b><a href="#max-attributions-per-navigation-source">#max-attributions-per-navigation-source</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-max-attributions-per-navigation-source">9.7. Parsing source-registration JSON</a>
    <li><a href="#ref-for-max-attributions-per-navigation-source①">10.6. Triggering attribution</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="max-attributions-per-event-source">
   <b><a href="#max-attributions-per-event-source">#max-attributions-per-event-source</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-max-attributions-per-event-source">9.7. Parsing source-registration JSON</a>
    <li><a href="#ref-for-max-attributions-per-event-source①">10.6. Triggering attribution</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="max-destinations-covered-by-pending-sources">
   <b><a href="#max-destinations-covered-by-pending-sources">#max-destinations-covered-by-pending-sources</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-max-destinations-covered-by-pending-sources">9.8. Checking pending destination limit</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-rate-limit-window">
   <b><a href="#attribution-rate-limit-window">#attribution-rate-limit-window</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-rate-limit-window">7. Vendor-Specific Values</a> <a href="#ref-for-attribution-rate-limit-window①">(2)</a> <a href="#ref-for-attribution-rate-limit-window②">(3)</a>
    <li><a href="#ref-for-attribution-rate-limit-window③">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-attribution-rate-limit-window④">10.3. Should attribution be blocked by rate limit</a>
    <li><a href="#ref-for-attribution-rate-limit-window⑤">10.4. Should processing be blocked by reporting-endpoint limit</a>
    <li><a href="#ref-for-attribution-rate-limit-window⑥">10.6. Triggering attribution</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="max-source-reporting-endpoints-per-rate-limit-window">
   <b><a href="#max-source-reporting-endpoints-per-rate-limit-window">#max-source-reporting-endpoints-per-rate-limit-window</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-max-source-reporting-endpoints-per-rate-limit-window">10.4. Should processing be blocked by reporting-endpoint limit</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="max-attribution-reporting-endpoints-per-rate-limit-window">
   <b><a href="#max-attribution-reporting-endpoints-per-rate-limit-window">#max-attribution-reporting-endpoints-per-rate-limit-window</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-max-attribution-reporting-endpoints-per-rate-limit-window">10.4. Should processing be blocked by reporting-endpoint limit</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="max-attributions-per-rate-limit-window">
   <b><a href="#max-attributions-per-rate-limit-window">#max-attributions-per-rate-limit-window</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-max-attributions-per-rate-limit-window">10.3. Should attribution be blocked by rate limit</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="max-source-cache-size">
   <b><a href="#max-source-cache-size">#max-source-cache-size</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-max-source-cache-size">9.9. Processing an attribution source</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="max-report-cache-size">
   <b><a href="#max-report-cache-size">#max-report-cache-size</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-max-report-cache-size">10.6. Triggering attribution</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="parse-filter-data">
   <b><a href="#parse-filter-data">#parse-filter-data</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-parse-filter-data">9.7. Parsing source-registration JSON</a>
    <li><a href="#ref-for-parse-filter-data①">10.1. Creating an attribution trigger</a> <a href="#ref-for-parse-filter-data②">(2)</a> <a href="#ref-for-parse-filter-data③">(3)</a> <a href="#ref-for-parse-filter-data④">(4)</a> <a href="#ref-for-parse-filter-data⑤">(5)</a> <a href="#ref-for-parse-filter-data⑥">(6)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="parse-filter-data-registrationtype">
   <b><a href="#parse-filter-data-registrationtype">#parse-filter-data-registrationtype</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-parse-filter-data-registrationtype">9.7. Parsing source-registration JSON</a>
    <li><a href="#ref-for-parse-filter-data-registrationtype①">10.1. Creating an attribution trigger</a> <a href="#ref-for-parse-filter-data-registrationtype②">(2)</a> <a href="#ref-for-parse-filter-data-registrationtype③">(3)</a> <a href="#ref-for-parse-filter-data-registrationtype④">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="check-if-a-debug-key-is-allowed">
   <b><a href="#check-if-a-debug-key-is-allowed">#check-if-a-debug-key-is-allowed</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-check-if-a-debug-key-is-allowed">9.7. Parsing source-registration JSON</a>
    <li><a href="#ref-for-check-if-a-debug-key-is-allowed①">10.1. Creating an attribution trigger</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="obtain-a-randomized-response">
   <b><a href="#obtain-a-randomized-response">#obtain-a-randomized-response</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-obtain-a-randomized-response">9.4. Obtaining a randomized source response</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="parse-an-aggregation-key-piece">
   <b><a href="#parse-an-aggregation-key-piece">#parse-an-aggregation-key-piece</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-parse-an-aggregation-key-piece">9.7. Parsing source-registration JSON</a>
    <li><a href="#ref-for-parse-an-aggregation-key-piece①">10.1. Creating an attribution trigger</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-source-expiry-time">
   <b><a href="#attribution-source-expiry-time">#attribution-source-expiry-time</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-source-expiry-time">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-attribution-source-expiry-time①">10.6. Triggering attribution</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-source-source-site">
   <b><a href="#attribution-source-source-site">#attribution-source-source-site</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-source-source-site">7. Vendor-Specific Values</a>
    <li><a href="#ref-for-attribution-source-source-site①">9.8. Checking pending destination limit</a> <a href="#ref-for-attribution-source-source-site②">(2)</a>
    <li><a href="#ref-for-attribution-source-source-site③">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-attribution-source-source-site④">10.3. Should attribution be blocked by rate limit</a>
    <li><a href="#ref-for-attribution-source-source-site⑤">10.6. Triggering attribution</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="parse-an-attribution-destination">
   <b><a href="#parse-an-attribution-destination">#parse-an-attribution-destination</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-parse-an-attribution-destination">9.7. Parsing source-registration JSON</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="obtain-a-randomized-source-response">
   <b><a href="#obtain-a-randomized-source-response">#obtain-a-randomized-source-response</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-obtain-a-randomized-source-response">9.7. Parsing source-registration JSON</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="obtain-an-attribution-source-from-an-anchor">
   <b><a href="#obtain-an-attribution-source-from-an-anchor">#obtain-an-attribution-source-from-an-anchor</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-obtain-an-attribution-source-from-an-anchor">2.3. Follow the hyperlink</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="obtain-an-attribution-source-from-window-features">
   <b><a href="#obtain-an-attribution-source-from-window-features">#obtain-an-attribution-source-from-window-features</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-obtain-an-attribution-source-from-window-features">2.4. Window open steps</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="obtain-a-source-expiry">
   <b><a href="#obtain-a-source-expiry">#obtain-a-source-expiry</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-obtain-a-source-expiry">9.7. Parsing source-registration JSON</a> <a href="#ref-for-obtain-a-source-expiry①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="parse-aggregation-keys">
   <b><a href="#parse-aggregation-keys">#parse-aggregation-keys</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-parse-aggregation-keys">9.7. Parsing source-registration JSON</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="check-if-an-attribution-source-exceeds-the-pending-destination-limit">
   <b><a href="#check-if-an-attribution-source-exceeds-the-pending-destination-limit">#check-if-an-attribution-source-exceeds-the-pending-destination-limit</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-check-if-an-attribution-source-exceeds-the-pending-destination-limit">9.9. Processing an attribution source</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="maybe-process-a-navigation-attribution-source">
   <b><a href="#maybe-process-a-navigation-attribution-source">#maybe-process-a-navigation-attribution-source</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-maybe-process-a-navigation-attribution-source">2.2.4. Document creation</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="obtain-a-fake-report">
   <b><a href="#obtain-a-fake-report">#obtain-a-fake-report</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-obtain-a-fake-report">9.9. Processing an attribution source</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="process-an-attribution-source">
   <b><a href="#process-an-attribution-source">#process-an-attribution-source</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-process-an-attribution-source">9.9. Processing an attribution source</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="parse-event-triggers">
   <b><a href="#parse-event-triggers">#parse-event-triggers</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-parse-event-triggers">10.1. Creating an attribution trigger</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="parse-aggregatable-trigger-data">
   <b><a href="#parse-aggregatable-trigger-data">#parse-aggregatable-trigger-data</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-parse-aggregatable-trigger-data">10.1. Creating an attribution trigger</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="parse-aggregatable-values">
   <b><a href="#parse-aggregatable-values">#parse-aggregatable-values</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-parse-aggregatable-values">10.1. Creating an attribution trigger</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="does-filter-data-match">
   <b><a href="#does-filter-data-match">#does-filter-data-match</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-does-filter-data-match">10.2. Does filter data match</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="match-filter-values">
   <b><a href="#match-filter-values">#match-filter-values</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-match-filter-values">10.2. Does filter data match</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="match-filter-values-with-negation">
   <b><a href="#match-filter-values-with-negation">#match-filter-values-with-negation</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-match-filter-values-with-negation">10.2. Does filter data match</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="match-an-attribution-sources-filter-data-against-filters">
   <b><a href="#match-an-attribution-sources-filter-data-against-filters">#match-an-attribution-sources-filter-data-against-filters</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-match-an-attribution-sources-filter-data-against-filters">10.5. Creating aggregatable contributions</a> <a href="#ref-for-match-an-attribution-sources-filter-data-against-filters①">(2)</a>
    <li><a href="#ref-for-match-an-attribution-sources-filter-data-against-filters②">10.6. Triggering attribution</a> <a href="#ref-for-match-an-attribution-sources-filter-data-against-filters③">(2)</a> <a href="#ref-for-match-an-attribution-sources-filter-data-against-filters④">(3)</a> <a href="#ref-for-match-an-attribution-sources-filter-data-against-filters⑤">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="match-an-attribution-sources-filter-data-against-filters-isnegated">
   <b><a href="#match-an-attribution-sources-filter-data-against-filters-isnegated">#match-an-attribution-sources-filter-data-against-filters-isnegated</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-match-an-attribution-sources-filter-data-against-filters-isnegated">10.5. Creating aggregatable contributions</a> <a href="#ref-for-match-an-attribution-sources-filter-data-against-filters-isnegated①">(2)</a>
    <li><a href="#ref-for-match-an-attribution-sources-filter-data-against-filters-isnegated②">10.6. Triggering attribution</a> <a href="#ref-for-match-an-attribution-sources-filter-data-against-filters-isnegated③">(2)</a> <a href="#ref-for-match-an-attribution-sources-filter-data-against-filters-isnegated④">(3)</a> <a href="#ref-for-match-an-attribution-sources-filter-data-against-filters-isnegated⑤">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="should-rate-limit-attribution">
   <b><a href="#should-rate-limit-attribution">#should-rate-limit-attribution</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-should-rate-limit-attribution">10.3. Should attribution be blocked by rate limit</a>
    <li><a href="#ref-for-should-rate-limit-attribution">10.6. Triggering attribution</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="should-block-processing-for-reporting-endpoint-limit">
   <b><a href="#should-block-processing-for-reporting-endpoint-limit">#should-block-processing-for-reporting-endpoint-limit</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-should-block-processing-for-reporting-endpoint-limit">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-should-block-processing-for-reporting-endpoint-limit">10.4. Should processing be blocked by reporting-endpoint limit</a>
    <li><a href="#ref-for-should-block-processing-for-reporting-endpoint-limit①">10.6. Triggering attribution</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="create-aggregatable-contributions">
   <b><a href="#create-aggregatable-contributions">#create-aggregatable-contributions</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-create-aggregatable-contributions">10.5. Creating aggregatable contributions</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="trigger-attribution">
   <b><a href="#trigger-attribution">#trigger-attribution</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-trigger-attribution">10.5. Creating aggregatable contributions</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="obtain-an-expiry-deadline">
   <b><a href="#obtain-an-expiry-deadline">#obtain-an-expiry-deadline</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-obtain-an-expiry-deadline">10.7. Establishing report delivery time</a> <a href="#ref-for-obtain-an-expiry-deadline①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="obtain-early-deadlines">
   <b><a href="#obtain-early-deadlines">#obtain-early-deadlines</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-obtain-early-deadlines">10.7. Establishing report delivery time</a> <a href="#ref-for-obtain-early-deadlines①">(2)</a> <a href="#ref-for-obtain-early-deadlines②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="obtain-the-number-of-report-windows">
   <b><a href="#obtain-the-number-of-report-windows">#obtain-the-number-of-report-windows</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-obtain-the-number-of-report-windows">9.7. Parsing source-registration JSON</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="obtain-a-report-time-from-deadline">
   <b><a href="#obtain-a-report-time-from-deadline">#obtain-a-report-time-from-deadline</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-obtain-a-report-time-from-deadline">10.7. Establishing report delivery time</a> <a href="#ref-for-obtain-a-report-time-from-deadline①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="obtain-the-report-time-at-a-window">
   <b><a href="#obtain-the-report-time-at-a-window">#obtain-the-report-time-at-a-window</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-obtain-the-report-time-at-a-window">9.9. Processing an attribution source</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="obtain-an-event-level-report-delivery-time">
   <b><a href="#obtain-an-event-level-report-delivery-time">#obtain-an-event-level-report-delivery-time</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-obtain-an-event-level-report-delivery-time">10.8. Obtaining an event-level report</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="obtain-an-event-level-report">
   <b><a href="#obtain-an-event-level-report">#obtain-an-event-level-report</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-obtain-an-event-level-report">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-obtain-an-event-level-report①">10.6. Triggering attribution</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="queue-a-report-for-delivery">
   <b><a href="#queue-a-report-for-delivery">#queue-a-report-for-delivery</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-queue-a-report-for-delivery">11. Report delivery</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="serialize-an-integer">
   <b><a href="#serialize-an-integer">#serialize-an-integer</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-serialize-an-integer">11.2. Serialize attribution report body</a> <a href="#ref-for-serialize-an-integer①">(2)</a> <a href="#ref-for-serialize-an-integer②">(3)</a> <a href="#ref-for-serialize-an-integer③">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="serialize-an-event-level-report">
   <b><a href="#serialize-an-event-level-report">#serialize-an-event-level-report</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-serialize-an-event-level-report">11.4. Creating a report request</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="generate-a-report-url">
   <b><a href="#generate-a-report-url">#generate-a-report-url</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-generate-a-report-url">11.5. Issuing a report request</a>
    <li><a href="#ref-for-generate-a-report-url①">11.6. Issuing a debug report request</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="generate-a-report-url-isdebugreport">
   <b><a href="#generate-a-report-url-isdebugreport">#generate-a-report-url-isdebugreport</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-generate-a-report-url-isdebugreport">11.6. Issuing a debug report request</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="create-a-report-request">
   <b><a href="#create-a-report-request">#create-a-report-request</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-create-a-report-request">11.5. Issuing a report request</a>
    <li><a href="#ref-for-create-a-report-request①">11.6. Issuing a debug report request</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attempt-to-deliver-a-report">
   <b><a href="#attempt-to-deliver-a-report">#attempt-to-deliver-a-report</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attempt-to-deliver-a-report">11. Report delivery</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attempt-to-deliver-a-debug-report">
   <b><a href="#attempt-to-deliver-a-debug-report">#attempt-to-deliver-a-debug-report</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attempt-to-deliver-a-debug-report">10.6. Triggering attribution</a>
   </ul>
  </aside>
<script>/* script-dfn-panel */

document.body.addEventListener("click", function(e) {
    var queryAll = function(sel) { return [].slice.call(document.querySelectorAll(sel)); }
    // Find the dfn element or panel, if any, that was clicked on.
    var el = e.target;
    var target;
    var hitALink = false;
    while(el.parentElement) {
        if(el.tagName == "A") {
            // Clicking on a link in a <dfn> shouldn't summon the panel
            hitALink = true;
        }
        if(el.classList.contains("dfn-paneled")) {
            target = "dfn";
            break;
        }
        if(el.classList.contains("dfn-panel")) {
            target = "dfn-panel";
            break;
        }
        el = el.parentElement;
    }
    if(target != "dfn-panel") {
        // Turn off any currently "on" or "activated" panels.
        queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(function(el){
            el.classList.remove("on");
            el.classList.remove("activated");
        });
    }
    if(target == "dfn" && !hitALink) {
        // open the panel
        var dfnPanel = document.querySelector(".dfn-panel[data-for='" + el.id + "']");
        if(dfnPanel) {
            dfnPanel.classList.add("on");
            var rect = el.getBoundingClientRect();
            dfnPanel.style.left = window.scrollX + rect.right + 5 + "px";
            dfnPanel.style.top = window.scrollY + rect.top + "px";
            var panelRect = dfnPanel.getBoundingClientRect();
            var panelWidth = panelRect.right - panelRect.left;
            if(panelRect.right > document.body.scrollWidth && (rect.left - (panelWidth + 5)) > 0) {
                // Reposition, because the panel is overflowing
                dfnPanel.style.left = window.scrollX + rect.left - (panelWidth + 5) + "px";
            }
        } else {
            console.log("Couldn't find .dfn-panel[data-for='" + el.id + "']");
        }
    } else if(target == "dfn-panel") {
        // Switch it to "activated" state, which pins it.
        el.classList.add("activated");
        el.style.left = null;
        el.style.top = null;
    }

});
</script>
<script>/* script-var-click-highlighting */

    document.addEventListener("click", e=>{
        if(e.target.nodeName == "VAR") {
            highlightSameAlgoVars(e.target);
        }
    });
    {
        const indexCounts = new Map();
        const indexNames = new Map();
        function highlightSameAlgoVars(v) {
            // Find the algorithm container.
            let algoContainer = null;
            let searchEl = v;
            while(algoContainer == null && searchEl != document.body) {
                searchEl = searchEl.parentNode;
                if(searchEl.hasAttribute("data-algorithm")) {
                    algoContainer = searchEl;
                }
            }

            // Not highlighting document-global vars,
            // too likely to be unrelated.
            if(algoContainer == null) return;

            const algoName = algoContainer.getAttribute("data-algorithm");
            const varName = getVarName(v);
            const addClass = !v.classList.contains("selected");
            let highlightClass = null;
            if(addClass) {
                const index = chooseHighlightIndex(algoName, varName);
                indexCounts.get(algoName)[index] += 1;
                indexNames.set(algoName+"///"+varName, index);
                highlightClass = nameFromIndex(index);
            } else {
                const index = previousHighlightIndex(algoName, varName);
                indexCounts.get(algoName)[index] -= 1;
                highlightClass = nameFromIndex(index);
            }

            // Find all same-name vars, and toggle their class appropriately.
            for(const el of algoContainer.querySelectorAll("var")) {
                if(getVarName(el) == varName) {
                    el.classList.toggle("selected", addClass);
                    el.classList.toggle(highlightClass, addClass);
                }
            }
        }
        function getVarName(el) {
            return el.textContent.replace(/(\s|\xa0)+/, " ").trim();
        }
        function chooseHighlightIndex(algoName, varName) {
            let indexes = null;
            if(indexCounts.has(algoName)) {
                indexes = indexCounts.get(algoName);
            } else {
                // 7 classes right now
                indexes = [0,0,0,0,0,0,0];
                indexCounts.set(algoName, indexes);
            }

            // If the element was recently unclicked,
            // *and* that color is still unclaimed,
            // give it back the same color.
            const lastIndex = previousHighlightIndex(algoName, varName);
            if(indexes[lastIndex] === 0) return lastIndex;

            // Find the earliest index with the lowest count.
            const minCount = Math.min.apply(null, indexes);
            let index = null;
            for(var i = 0; i < indexes.length; i++) {
                if(indexes[i] == minCount) {
                    return i;
                }
            }
        }
        function previousHighlightIndex(algoName, varName) {
            return indexNames.get(algoName+"///"+varName);
        }
        function nameFromIndex(index) {
            return "selected" + index;
        }
    }
    </script>